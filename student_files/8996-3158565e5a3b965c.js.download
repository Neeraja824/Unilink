try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="58d46fa2-702b-45ac-b64c-243e30276f4e",e._sentryDebugIdIdentifier="sentry-dbid-58d46fa2-702b-45ac-b64c-243e30276f4e")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8996],{34319:function(e,t,s){s.d(t,{v:function(){return l}});var a=s(57437),n=s(94508),r=s(46170);let l=e=>{let{plan:t,className:s}=e,l=(0,r.ZN)(t);return(0,a.jsx)("span",{className:(0,n.cn)("rounded-full px-2 py-px text-[10px] font-medium uppercase transition-colors duration-150 ease-in-out","free"===t?"bg-muted text-muted-foreground":"bg-brand-twilight-primary text-brand-twilight-primary-foreground",s),children:l})}},15492:function(e,t,s){s.d(t,{B:function(){return n}});var a=s(89651);let n=function(e){let{defaultValue:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{defaultValue:!1},[s,n]=(0,a.Z)(e,{defaultValue:t});return[s,n]}},96027:function(e,t,s){s.d(t,{E:function(){return g}});var a=s(57437),n=s(5978),r=s(2265),l=s(27648),i=s(99376),o=s(46214),c=s(94508),d=s(15492),u=s(62869),m=s(57346),p=s(25566),x=e=>{let{type:t,message:s,persistDismiss:n=!1,storageKey:x,bgColor:h,href:g,onClick:f,className:j,darkCloseIcon:v=!1}=e,b=(0,i.usePathname)(),y=(0,r.useRef)(null),[w,N]=(0,d.B)(x||"default-banner-key",{defaultValue:!0}),[_,k]=(0,r.useState)(!1),[S,C]=(0,r.useState)(!1);(0,r.useEffect)(()=>{C(!0),k(!0)},[]);let E=(null==b?void 0:b.startsWith("/projects/"))&&["ph-launch-banner","rebrand-banner"].includes(x||""),A=!E&&(n?w:_);if(E)return null;if(n&&!x)return console.error("storageKey is required when persistDismiss is true"),null;if(!A||p.env.TEST_E2E)return null;let D=(0,a.jsxs)("div",{ref:y,className:(0,c.cn)("z-[1050] hidden w-full items-center justify-between px-2 py-2 text-sm text-white transition-opacity duration-300 md:px-4 md:text-base",h||("error"===t?"bg-destructive-primary":"bg-background"),j,S&&"flex"),children:[(0,a.jsx)("div",{className:"flex flex-grow items-center justify-center space-x-4 pr-6 md:text-center",children:s}),(0,a.jsx)(u.z,{variant:"ghost",size:"icon",className:(0,c.cn)("hover:bg-transparent md:absolute md:right-2",v?"text-primary-foreground hover:text-primary-foreground":"text-primary"),onClick:e=>{e.stopPropagation(),n?N(!1):k(!1),o.ZP.capture("banner_dismissed",{banner_type:t,message:s,persisted:n})},children:(0,a.jsx)(m.Z,{name:"close_small"})})]});return g?(0,a.jsx)(l.default,{href:g,target:"_blank",rel:"noopener noreferrer",onClick:f,className:"w-full",children:D}):D},h=s(78099);let g=e=>{let{className:t}=e,[s,l]=(0,r.useState)({showStatusBanner:!1,statusBannerContent:"",statusBannerLink:""});return((0,r.useEffect)(()=>{(async()=>{try{let e=(0,n.JU)(h.db,"system","info"),t=await (0,n.QT)(e);t.exists()&&l(t.data())}catch(e){console.error("Failed to fetch system info:",e)}})()},[]),s.showStatusBanner&&s.statusBannerContent)?(0,a.jsx)(x,{message:s.statusBannerContent,type:"error",className:t,href:s.statusBannerLink}):null}},32429:function(e,t,s){s.d(t,{G:function(){return c},h:function(){return o}});var a=s(57437),n=s(92850),r=s(2265),l=s(51408);let i=(0,r.createContext)(null);function o(e){let{children:t,user:s}=e,{data:o,isLoading:c}=(0,n.a)(l.V.experimentalFeatures({user:s})),d=(0,r.useMemo)(()=>({features:o||null,isLoading:c}),[o,c]);return(0,a.jsx)(i.Provider,{value:d,children:t})}function c(){let e=(0,r.useContext)(i);if(!e)throw Error("LabsFeaturesContext not found");return e}},90962:function(e,t,s){s.d(t,{A4:function(){return d},C0:function(){return c},Lm:function(){return o}});var a=s(73521),n=s(85755),r=s(93252),l=s(67457),i=s(74494);let o=(0,l.P0)({settings:{background:"hsl(var(--background))",gutterBackground:"hsl(var(--muted))",fontFamily:"var(--font-roboto-mono)",selection:"#2d333b",caret:"#c9d1d9",foreground:"#c9d1d9",gutterActiveForeground:"#c9d1d9",gutterForeground:"#6e7681",gutterBorder:"#21262d",lineHighlight:"#c9d1d910",selectionMatch:"#3392FF44"},styles:[{tag:r.pJ.comment,color:"#8b949e"},{tag:r.pJ.variableName,color:"#c9d1d9"},{tag:[r.pJ.string,r.pJ.special(r.pJ.brace)],color:"#a5d6ff"},{tag:r.pJ.number,color:"#79c0ff"},{tag:r.pJ.bool,color:"#ff7b72"},{tag:r.pJ.null,color:"#ff7b72"},{tag:r.pJ.keyword,color:"oklch(0.833 0.145 321.434)"},{tag:r.pJ.operator,color:"#ff7b72"},{tag:r.pJ.className,color:"#ffa657"},{tag:r.pJ.definition(r.pJ.typeName),color:"#ffa657"},{tag:r.pJ.typeName,color:"#ffa657"},{tag:r.pJ.angleBracket,color:"#7ee787"},{tag:r.pJ.tagName,color:"#7ee787"},{tag:r.pJ.attributeName,color:"#79c0ff"},{tag:r.pJ.function(r.pJ.variableName),color:"#d2a8ff"},{tag:r.pJ.function(r.pJ.propertyName),color:"#d2a8ff"},{tag:r.pJ.squareBracket,color:"#c9d1d9"},{tag:r.pJ.brace,color:"#c9d1d9"}]}),c=(0,l.P0)({settings:{background:"hsl(var(--background))",gutterBackground:"hsl(var(--muted))",fontFamily:"var(--font-roboto-mono)",selection:"#C7E4FF",caret:"#24292e",foreground:"#24292e",gutterActiveForeground:"#24292e",gutterForeground:"#57606a",gutterBorder:"#e8eaed",lineHighlight:"#2437921a",selectionMatch:"#3392FF33"},styles:[{tag:r.pJ.comment,color:"#6e7781"},{tag:r.pJ.variableName,color:"#24292e"},{tag:[r.pJ.string,r.pJ.special(r.pJ.brace)],color:"#0a3069"},{tag:r.pJ.number,color:"#0550ae"},{tag:r.pJ.bool,color:"#cf222e"},{tag:r.pJ.null,color:"#cf222e"},{tag:r.pJ.keyword,color:"#3479E5"},{tag:r.pJ.operator,color:"#cf222e"},{tag:r.pJ.className,color:"#953800"},{tag:r.pJ.definition(r.pJ.typeName),color:"#953800"},{tag:r.pJ.typeName,color:"#953800"},{tag:r.pJ.angleBracket,color:"#116329"},{tag:r.pJ.tagName,color:"#116329"},{tag:r.pJ.attributeName,color:"#0550ae"},{tag:r.pJ.function(r.pJ.variableName),color:"#8250df"},{tag:r.pJ.function(r.pJ.propertyName),color:"#8250df"},{tag:r.pJ.squareBracket,color:"#24292e"},{tag:r.pJ.brace,color:"#24292e"},{tag:[r.pJ.name,r.pJ.deleted,r.pJ.character,r.pJ.propertyName,r.pJ.macroName],color:"#0E7490"},{tag:[r.pJ.meta],color:"#0E7490"},{tag:[r.pJ.definition(r.pJ.name),r.pJ.separator],color:"#a3be8c"},{tag:[r.pJ.operator,r.pJ.operatorKeyword],color:"#15803D"},{tag:[r.pJ.string],color:"#15803D"},{tag:r.pJ.link,color:"#15803D",textDecoration:"underline",textUnderlinePosition:"under"}]}),d=[(0,n.eJ)({jsx:!0,typescript:!0}),(0,a.dy)({autoCloseTags:!0}),i.T]},74494:function(e,t,s){s.d(t,{P:function(){return d},T:function(){return c}});var a=s(62997),n=s(90277);let r=a.Py.define(),l=a.QQ.define({create:()=>null,update(e,t){for(let e of t.effects)if(e.is(r))return e.value;return e}}),i=n.p.line({attributes:{style:"background-color: rgba(255, 255, 0, 0.2); border-left: 3px solid #ffcc00;"}}),o=n.lg.fromClass(class{update(e){e.state.field(l)!==e.startState.field(l)&&(this.decorations=this.buildDecorations(e.view))}buildDecorations(e){let t=e.state.field(l);if(null===t)return n.p.none;let{startLine:s,endLine:a}=t,r=[];if(s===a){let t=e.state.doc.line(Math.min(s,e.state.doc.lines));r.push({from:t.from,to:t.from,value:i})}else for(let t=s;t<=a&&!(t>e.state.doc.lines);t++){let s=e.state.doc.line(t);r.push({from:s.from,to:s.from,value:i})}return n.p.set(r)}constructor(e){this.decorations=this.buildDecorations(e)}},{decorations:e=>e.decorations}),c=[l,o],d=(e,t,s)=>{let a=s||t,l=Math.floor((t+a)/2),i=e.state.doc.line(Math.min(l,e.state.doc.lines)),o=e.state.doc.line(Math.min(t,e.state.doc.lines));e.dispatch({effects:[r.of({startLine:t,endLine:a}),n.tk.scrollIntoView(i.from,{y:"center"})],selection:{anchor:o.from}})}},24613:function(e,t,s){function a(e){let t=Math.floor(e/3600),s=Math.floor(e%3600/60),a="";return t>0&&(a+="".concat(t,"h ")),(s>0||t>0)&&(a+="".concat(s,"m ")),(a+="".concat(Math.floor(e%60),"s")).trim()}s.d(t,{Bw:function(){return r},ZI:function(){return n},mr:function(){return a}});let n=e=>e<1e3?e.toString():e<1e6?"".concat((e/1e3).toFixed(1).replace(/\.0$/,""),"k"):"".concat((e/1e6).toFixed(1).replace(/\.0$/,""),"m"),r=e=>{let{value:t,valueType:s,roundNumber:r=!0}=e;switch(s){case"number":return r?n(t):t.toString();case"percentage":return"".concat(t,"%");case"time":return a(t)}}},10123:function(e,t,s){s.d(t,{HX:function(){return m},Sv:function(){return o},fV:function(){return p}});var a=s(56942),n=s(7641),r=s(64975),l=s(63070),i=s(14376);let o=e=>{if(e)try{return Intl.DateTimeFormat(void 0,{timeZone:e}),e}catch(t){console.error("Invalid timezone: ".concat(e,", falling back to local timezone"))}return Intl.DateTimeFormat().resolvedOptions().timeZone},c=(e,t)=>(0,i.Nm)(e,t).toISOString(),d=(e,t)=>{let s=(0,i.zW)(e,t),n=(0,a.b)(s);return(0,i.Nm)(n,t)},u=(e,t)=>{let s=(0,i.zW)(e,t),a=(0,n.i)(s);return(0,i.Nm)(a,t)},m=e=>{let t=o(e),s=new Date;return{startDate:c(new Date(s.getTime()-6048e5),t),endDate:c(s,t),granularity:"daily",preset:"7d"}},p={today:{label:"Today",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c(d(s,t),t),endDate:c(u(s,t),t),granularity:"hourly",preset:"today"}}},yesterday:{label:"Yesterday",getTimePeriod:e=>{let t=o(e),s=(0,r.k)(new Date,1);return{startDate:c(d(s,t),t),endDate:c(u(s,t),t),granularity:"hourly",preset:"yesterday"}}},"24h":{label:"Last 24 hours",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c((0,r.k)(s,1),t),endDate:c(s,t),granularity:"hourly",preset:"24h"}}},"7d":{label:"Last 7 days",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c((0,r.k)(s,7),t),endDate:c(s,t),granularity:"daily",preset:"7d"}}},"14d":{label:"Last 14 days",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c((0,r.k)(s,14),t),endDate:c(s,t),granularity:"daily",preset:"14d"}}},"30d":{label:"Last 30 days",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c((0,r.k)(s,30),t),endDate:c(s,t),granularity:"daily",preset:"30d"}}},"90d":{label:"Last 90 days",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c((0,r.k)(s,90),t),endDate:c(s,t),granularity:"daily",preset:"90d"}}},month:{label:"This month",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c((0,l.N)(s),t),endDate:c(s,t),granularity:"daily",preset:"month"}}}}},93261:function(e,t,s){var a=s(57437),n=s(59040),r=s(2265),l=s(14438),i=s(62869),o=s(26110),c=s(57346),d=s(64040),u=s(49131),m=s(21288),p=s(77113);let x=e=>{try{return(0,n.xX)(e)}catch(t){return m.logging.error("Failed to get UTF-8 domain",{domain:e,error:t}),e}};t.Z=e=>{let{domain:t,showRemove:s,showIcon:n,refetchDomains:m}=e,[h,g]=(0,r.useState)(!1),[f,j]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),y=(0,p.iZ)(e=>e.project),w=async e=>{b(!0);try{let t=(0,u.SJ)();await t.delete("/projects/".concat(null==y?void 0:y.id,"/domains/").concat(e)),null==m||m(),b(!1),g(!1),l.Am.success("Domain removed",{description:'Your custom domain "'.concat(e,'" was successfully removed from the project.')})}catch(e){b(!1),(0,d.Eo)(e)}},N=()=>{j(!0),null==m||m(),setTimeout(()=>j(!1),1e3)},_=x(t.domain);return(0,a.jsxs)("li",{className:"flex h-auto min-h-8 w-full items-center gap-2 text-sm",children:["active"!==t.status?(0,a.jsxs)("span",{className:"flex min-w-0 flex-grow items-center truncate text-muted-foreground",title:"The domain ".concat(_," is still being configured..."),onClick:()=>N(),children:[n&&(0,a.jsx)(c.Z,{name:"language",className:"mr-2 inline w-4",size:"small"}),(0,a.jsx)("span",{className:"min-w-0 truncate",children:_}),(0,a.jsxs)("span",{className:"relative ml-2 mr-1 inline-flex size-2",children:[(0,a.jsx)("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-primary opacity-75"}),(0,a.jsx)("span",{className:"relative inline-flex size-2 rounded-full bg-primary"})]})]}):(0,a.jsxs)("a",{href:"https://".concat(t.domain),target:"_blank",rel:"noopener noreferrer",className:"flex-grow truncate underline-offset-4 hover:underline",title:t.domain,children:[n&&(0,a.jsx)(c.Z,{name:"language",className:"mr-2 inline w-4",size:"small"}),_]}),s&&(0,a.jsxs)(o.Vq,{open:h,onOpenChange:g,children:[(0,a.jsx)(o.hg,{asChild:!0,children:(0,a.jsx)(i.z,{variant:"ghost",size:"icon-sm",type:"button",className:"ml-auto",children:(0,a.jsx)(c.Z,{name:"delete",size:"small"})})}),(0,a.jsxs)(o.cZ,{children:[(0,a.jsxs)(o.fK,{children:[(0,a.jsxs)(o.$N,{children:["Remove ",_,"?"]}),(0,a.jsx)(o.Be,{children:"This will disconnect the domain from this project. You will need to reconfigure it if you will want to use it with this project in the future."})]}),(0,a.jsxs)(o.cN,{children:[(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>{g(!1)},children:"Cancel"}),(0,a.jsx)(i.z,{variant:"destructive",size:"sm",onClick:()=>w(t.domain),loading:v,children:"Remove"})]})]})]}),"active"!==t.status?(0,a.jsx)("span",{title:"Refresh status",className:"ml-auto cursor-pointer",onClick:()=>N(),children:(0,a.jsx)(c.Z,{name:"refresh",size:"small",className:f?"animate-spin":""})}):(0,a.jsx)("a",{href:"https://".concat(t.domain),target:"_blank",title:"Open in a new tab",rel:"noopener noreferrer",className:"ml-auto text-muted-foreground",children:(0,a.jsx)(c.Z,{name:"arrow_outward",size:"small"})})]})}},95565:function(e,t,s){s.d(t,{W:function(){return r}});var a=s(92850),n=s(49131);let r=e=>{let{projectId:t,enabled:s=!0}=e;return(0,a.a)({queryKey:["projects",t,"integrations","ai_gateway"],queryFn:async()=>(0,n.SJ)().get("/projects/".concat(t,"/integrations/ai_gateway")),enabled:s&&!!t})}},26237:function(e,t,s){s.d(t,{C:function(){return l}});var a=s(2265),n=s(77113);let r=e=>{try{if(null==e)return!1;let t=e.toDate();if(new Date().getTime()-t.getTime()>6e4)return!1;return!0}catch(e){return!1}},l=()=>{let e=(0,n.iZ)(e=>e.project),t=null==e?void 0:e.locked_at,[s,l]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(!t||!r(t)){l(!1);return}let e=setInterval(()=>{let s=r(t);l(s),s||clearInterval(e)},250);return()=>clearInterval(e)},[t]),s}},69084:function(e,t,s){s.d(t,{z:function(){return l}});var a=s(57437),n=s(92825),r=s(79858);let l=e=>{var t;let{isInteractive:s=!1,className:l,workspace:i,...o}=e,c=(0,r.Q)(null==i?void 0:i.id),d=null==i?void 0:i.name,u=null!==(t=null==i?void 0:i.image_url)&&void 0!==t?t:void 0;return(0,a.jsx)(n.N,{name:d,isInteractive:s,photoSrc:u,userColor:c,className:l,isWorkspace:!0,...o})}},76642:function(e,t,s){s.d(t,{H:function(){return g}});var a=s(57437),n=s(57346),r=s(27132),l=s(94508),i=s(79358);let o=e=>{let{bonusCredits:t}=e,s=(0,r.Z)("md");return(0,a.jsxs)("div",{className:(0,l.cn)("flex items-center justify-between gap-2 rounded-md bg-muted p-3 text-base md:text-sm"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.Z,{name:"rewarded_ads",size:s?"default":"small"}),(0,a.jsx)("p",{children:"Bonus Credits"})]}),(0,a.jsx)("p",{className:"text-sm md:text-xs",children:(0,i.H)(t)})]})};var c=s(55157),d=s(3714),u=s(79392),m=s(55596);let p=e=>{let{workspace:t,isOwnerOfWorkspace:s}=e,r=(0,d.t)(t),{openSettings:i}=(0,c.r)();return(0,a.jsxs)("div",{className:"flex flex-col gap-4 rounded-xl bg-muted p-4 md:rounded-md md:p-3",children:[(0,a.jsxs)("div",{className:(0,l.cn)("flex items-center justify-between",{"cursor-pointer transition-all duration-150 ease-in-out hover:opacity-80":s}),onClick:s?()=>{i("billing")}:void 0,children:[(0,a.jsx)("p",{className:"text-base font-medium text-foreground md:text-sm",children:"Credits"}),(0,a.jsxs)("div",{className:"flex items-center gap-px",children:[(0,a.jsx)("p",{className:"text-base font-normal md:text-sm ".concat(0===r.totalRemaining&&s?"text-foreground":"text-muted-foreground"),children:0===r.totalRemaining&&s?"Upgrade":0===r.totalRemaining?"0 left":"".concat((0,u.H)(r.totalRemaining)," left")}),s&&(0,a.jsx)(n.Z,{name:"chevron_right",size:"small",className:"".concat(0===r.totalRemaining?"text-foreground":"text-muted-foreground")})]})]}),(0,a.jsx)(m.j,{progressData:r}),(r.currentlyConsuming||0===r.totalRemaining)&&(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("div",{className:"h-2 w-2 rounded-full ".concat(r.currentlyConsuming?r.currentlyConsumingColorClass:"bg-muted-foreground")}),(0,a.jsx)("p",{className:"text-base text-muted-foreground md:text-sm",children:(e=>{switch(e){case"daily":return"Daily credits used first";case"rollover":return"Using rollover credits";case"billing":return"Using monthly credits";case"granted":return"Using bonus credits";case null:return"You are out of credits"}})(r.currentlyConsuming)})]})]})};var x=s(59053),h=s(46170);let g=e=>{let{workspace:t,isOwnerOfWorkspace:s,className:n}=e;t.rollover_credits_limit;let{billingPeriodCreditLimit:r,billingPeriodCreditsUsed:i,dailyCreditLimit:c,dailyCreditsUsed:d,bonusCredits:u,rolloverCredits:m,totalCreditsUsedInBillingPeriod:g,billingPeriodEndDate:f}=(0,x.O)({projectWorkspace:t}),j=void 0!==r&&void 0!==i&&r>0,v=void 0!==c&&void 0!==d&&c>0,b=t.plan,y="free"===b,w="ktlo"===b,N=(0,h.XB)(b);return"inactive"===b?null:(0,a.jsxs)("div",{className:(0,l.cn)("flex flex-col gap-1",n),children:[(y||w)&&v&&(0,a.jsx)(p,{workspace:t,isOwnerOfWorkspace:s}),N&&!w&&j&&v&&(0,a.jsx)(p,{workspace:t,isOwnerOfWorkspace:s}),N&&!w&&!j&&v&&(0,a.jsx)(p,{workspace:t,isOwnerOfWorkspace:s}),void 0!==u&&u>0&&(0,a.jsx)(o,{bonusCredits:u})]})}},55596:function(e,t,s){s.d(t,{j:function(){return c}});var a=s(57437),n=s(2265),r=s(81103),l=s(79392);let i={granted:"Bonus",billing:"Monthly",rollover:"Rollover",daily:"Daily"},o=e=>i[e],c=e=>{let{progressData:t}=e,s=(0,n.useRef)(null),[i,c]=(0,n.useState)(0);if((0,n.useLayoutEffect)(()=>{let e=()=>{s.current&&c(s.current.offsetWidth)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),!t.hasCredits)return(0,a.jsx)("div",{className:"flex w-full items-center gap-2",children:(0,a.jsx)("div",{className:"relative h-2.5 flex-1 overflow-hidden rounded-lg bg-muted-active"})});let d=t.sources.map((e,s)=>{let a=t.totalAllocation>0?e.remaining/t.totalAllocation*100:0,n=s===t.sources.length-1;return{...e,widthPercentage:Math.max(a,i>0?7/i*100:2),isFirst:0===s,isLast:n}}),u=i>0?Math.max(1.5,.002*i)/i*100:.4,m=Math.max(0,d.length-1)*u,p=d.reduce((e,t)=>e+t.widthPercentage,0)+m,x=p>100?100/p:1,h=u*x,g=0,f=d.map(e=>{let t=e.widthPercentage*x,s=g;return g+=t+(e.isLast?0:h),{...e,widthPercentage:t,leftOffset:s}});return(0,a.jsx)("div",{className:"flex w-full items-center gap-2",children:(0,a.jsxs)("div",{ref:s,className:"relative h-2.5 flex-1 overflow-hidden rounded-lg bg-muted-active",children:[t.totalUsed>0&&(()=>{let e=f.reduce((e,t)=>e+t.widthPercentage,0),s=100-e;return s>0?(0,a.jsxs)(r.u,{delayDuration:0,children:[(0,a.jsx)(r.aJ,{asChild:!0,children:(0,a.jsx)("div",{className:"absolute h-full cursor-pointer",style:{left:"".concat(e,"%"),width:"".concat(s,"%")}})}),(0,a.jsx)(r._v,{className:"border border-gray-200 bg-white shadow-lg",children:(0,a.jsxs)("div",{className:"justify-center text-xs font-normal leading-none text-black",children:[(0,l.H)(t.totalUsed)," credits used"]})})]}):null})(),f.map(e=>(0,a.jsxs)(r.u,{delayDuration:0,children:[(0,a.jsx)(r.aJ,{asChild:!0,children:(0,a.jsx)("div",{className:"absolute h-full cursor-pointer ".concat(e.colorClass," transition-all ").concat(e.isFirst?"rounded-bl-lg rounded-tl-lg":""," ").concat(e.isLast?"rounded-br-lg rounded-tr-lg":""),style:{left:"".concat(e.leftOffset,"%"),width:"".concat(e.widthPercentage,"%")}})}),(0,a.jsx)(r._v,{className:"border border-gray-200 bg-white shadow-lg",children:(0,a.jsx)("div",{className:"justify-center text-xs font-normal leading-none text-black",children:"granted"===e.name?"".concat((0,l.H)(e.remaining)," ").concat(o(e.name)," credits"):"".concat((0,l.H)(e.remaining),"/").concat((0,l.H)(e.limit)," ").concat(o(e.name)," credits")})})]},e.name))]})})}},47483:function(e,t,s){s.d(t,{r:function(){return m}});var a=s(57437),n=s(38706),r=s(88391),l=s(57346),i=s(60616),o=s(55721),c=s(46214),d=s(49284),u=s(3813);let m=()=>{let e=(0,n.T_)("EarnFreeCredits"),t=(0,u.SK)(),s=(0,r.z)(i.A);return t?(0,a.jsxs)(o.Xi,{onClick:()=>{c.ZP.capture(d.PU.OPENED_DIALOG,{button_used:"menu_item"}),s({childProps:{onSuccess:()=>s(!1)}})},children:[(0,a.jsx)(l.Z,{name:"featured_seasonal_and_gifts",size:"small"}),(0,a.jsx)("span",{children:e("getFreeCredits")})]}):null}},32800:function(e,t,s){s.d(t,{s:function(){return p}});var a=s(57437),n=s(2265),r=s(44481),l=s(14438),i=s(62869),o=s(55721),c=s(57346),d=s(54616),u=s(30811);let m=e=>{var t,s;let{selectedRole:r,onRoleChange:l,roleOptions:d,disabled:u=!1}=e,[m,p]=(0,n.useState)(!1);return u?(0,a.jsx)(i.z,{variant:"ghost",size:"sm",className:"flex-shrink-0 gap-1.5 font-normal",disabled:!0,children:null===(s=d.find(e=>e.value===r))||void 0===s?void 0:s.label}):(0,a.jsxs)(o.h_,{open:m,onOpenChange:p,children:[(0,a.jsx)(o.$F,{asChild:!0,children:(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",className:"flex-shrink-0 gap-1.5 font-normal",children:[null===(t=d.find(e=>e.value===r))||void 0===t?void 0:t.label,(0,a.jsx)(c.Z,{name:"keyboard_arrow_down",size:"small"})]})}),(0,a.jsx)(o.AW,{children:(0,a.jsx)(o._x,{value:r,onValueChange:e=>{l(e),p(!1)},children:d.map(e=>(0,a.jsx)(o.qB,{value:e.value,className:"hover:bg-accent",children:e.label},e.value))})})]})},p=e=>{let{onInvite:t,isInviting:s,roleOptions:o,defaultRole:c,canSelectRoles:p=!0,placeholder:x="Add emails",completelyDisabled:h=!1,onInputChange:g}=e,[f,j]=(0,n.useState)([]),[v,b]=(0,n.useState)(""),[y,w]=(0,n.useState)(c),N=f.length>0||""!==v.trim(),_=async()=>{let e=[...f],s=v.trim();if(""===s||f.includes(s)||(e.push(s),j(e),b("")),0===e.length)return;if(e.length>0&&!e.every(e=>(0,d.Jh)(e))){1===e.length?l.Am.error("Invalid email address",{description:"Please check the email address and try again."}):l.Am.error("Invalid email address",{description:"One or more email addresses are invalid. Please check and try again."});return}let{success:a}=await t({emails:e,role:y});a&&(j([]),b(""),null==g||g(""))};(0,r.y1)("mod+enter",e=>{e.preventDefault(),s||_()},{enableOnFormTags:!0});let k=""===v.trim()&&0===f.length;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.B,{tags:f,setTags:j,inputValue:v,setInputValue:e=>{b(e),null==g||g(e)},placeholder:x,disabled:h,className:"min-w-0 flex-1"}),N&&(0,a.jsx)(m,{selectedRole:y,onRoleChange:w,roleOptions:o,disabled:!p||h}),(0,a.jsx)(i.z,{onClick:_,variant:"affirmative",className:"flex-shrink-0",disabled:s||k||h,loading:s,children:"Invite"})]})}},39484:function(e,t,s){s.d(t,{T:function(){return l}});var a=s(57437),n=s(94508),r=s(22287);let l=e=>{let{text:t,className:s}=e;return(0,a.jsxs)("div",{className:(0,n.cn)("mt-1 flex items-center gap-2 text-sm opacity-70",s),children:[(0,a.jsx)("div",{className:"my-1",children:(0,a.jsx)(r.$,{size:"small"})}),(0,a.jsx)("div",{children:t})]})}},45659:function(e,t,s){s.d(t,{Q:function(){return i}});var a=s(57437),n=s(70335),r=s(35974),l=s(94508);let i=e=>{let{id:t,username:s,displayName:i,photoURL:o,avatarClassName:c,actionComponent:d,email:u,isCurrentUser:m=!1,isInvited:p=!1,showBadge:x=!0}=e;return(0,a.jsxs)("div",{className:"flex items-center justify-start gap-3 py-1 md:flex-nowrap",children:[(0,a.jsx)(n.Y,{className:(0,l.cn)(c,p&&"opacity-60"),user:{id:t,username:null!=i?i:u},photoURL:o,isInteractive:!1}),(0,a.jsx)("div",{className:"flex min-w-0 flex-shrink items-center gap-4 ".concat(p&&"opacity-60"),children:(0,a.jsxs)("div",{className:"flex min-w-0 flex-col gap-0",children:[(0,a.jsxs)("div",{className:"flex-shrink truncate text-sm font-medium leading-tight",children:[i," ",m&&(0,a.jsx)("span",{className:"font-normal",children:"(you)"})]}),(0,a.jsx)("span",{className:"max-w-[150px] flex-shrink truncate text-xs text-muted-foreground",children:u})]})}),p&&x&&(0,a.jsx)(r.C,{variant:"outline",className:"hidden gap-1 bg-muted text-xs font-medium text-muted-foreground md:flex",children:"Invite sent"}),d&&(0,a.jsx)("div",{className:"ml-auto flex-shrink-0",children:d})]})}},12285:function(e,t,s){s.d(t,{O:function(){return S}});var a=s(57437),n=s(2265),r=s(34319),l=s(6812),i=s(77113),o=s(71759),c=s(62869),d=s(26110),u=s(53647),m=s(29827),p=s(21770),x=s(14438),h=s(52558),g=s(64040),f=s(49131),j=s(21288),v=s(97318);let b=e=>{let{onSettled:t}=e,{authUser:s}=(0,h.Eu)(),a=(0,m.NL)(),{mutate:n,isPending:r}=(0,p.D)({mutationFn:async e=>{let{projectId:t,workspaceId:a}=e;if(!s)throw Error("User must be logged in to move projects");let n=(0,f.SJ)();await n.put("/projects/".concat(t,"/move-to-workspace"),{workspace_id:a})},onSuccess:async(e,t)=>{a.invalidateQueries({queryKey:v.iZ.detail(t.projectId)}).catch(e=>{j.logging.error("Failed to invalidate project query after transfer",{error:e})}),x.Am.success("Project moved successfully",{description:"Moved project to ".concat(t.workspaceName||"new workspace")})},onError:e=>{(0,g.Eo)(e)},onSettled:()=>{null==t||t()}});return{moveProjectToWorkspace:n,isMovingProject:r}};var y=s(94508),w=s(46170),N=s(69084),_=s(65613),k=s(57346);function S(e){let{trigger:t,projectId:s,projectName:m,open:p,setOpen:x,isRootDialog:h=!1}=e,g=(0,l.Q)(e=>e.workspaces),{moveProjectToWorkspace:f,isMovingProject:j}=b({onSettled:()=>{E(!1),z("")}}),v=(0,o.hO)(e=>e.projectWorkspace),[S,C]=(0,n.useState)(!1),E=x||C,A=async e=>{s&&f({projectId:s,workspaceId:e.id,workspaceName:e.name})},[D,z]=(0,n.useState)(""),I=(0,l.Q)(e=>e.setShowCreateWorkspaceDialog),O=g.find(e=>e.id===D),P=(0,i.iZ)(e=>e.project);if(!v)return null;let T=(0,w.XB)(null==O?void 0:O.plan)?"private":(null==O?void 0:O.plan)==="free"?"public":null;return(0,a.jsxs)(d.Vq,{open:x?p:S,onOpenChange:E,children:[!h&&(0,a.jsx)(d.hg,{asChild:!0,children:t||(0,a.jsx)(c.z,{variant:"default",children:"Transfer"})}),(0,a.jsxs)(d.cZ,{size:"sm",children:[(0,a.jsxs)(d.fK,{children:[(0,a.jsxs)(d.$N,{className:"text-left",children:["Transfer ",m||"Project"]}),(0,a.jsxs)(d.Be,{className:"text-left",children:[(0,a.jsx)("p",{children:O?(0,a.jsxs)("span",{children:["Moving this project to"," ",(0,a.jsx)("span",{className:"font-medium",children:O.name})," ","will:"]}):(0,a.jsx)("span",{children:"Moving this project to a new workspace will:"})}),(0,a.jsxs)("ul",{className:"list-disc pl-4 text-sm",children:[(0,a.jsxs)("li",{children:["Remove access for members of"," ",(0,a.jsx)("span",{className:"font-medium",children:v.name})]}),(0,a.jsxs)("li",{children:["Grant access to members of"," ",O?(0,a.jsx)("span",{className:"font-medium",children:null==O?void 0:O.name}):(0,a.jsx)("span",{children:"the new workspace"})]}),(0,a.jsx)("li",{children:"Preserve access for anyone directly invited to the project"}),(0,a.jsx)("li",{children:"May require you to re-link GitHub and Supabase organizations/projects"})]}),(0,a.jsxs)(_.bZ,{className:(0,y.cn)((!T||T===(null==P?void 0:P.visibility))&&"hidden","text-sm","mt-4"),children:[(0,a.jsx)(k.Z,{name:"info",className:"h-4 w-4"}),(0,a.jsx)(_.Cd,{children:"Warning"}),(0,a.jsxs)(_.X,{className:"text-sm",children:["This action will turn the project"," ",(0,a.jsx)("span",{className:"font-medium",children:"private"===T?"private":"public"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"min-w-[60px] text-sm font-medium",children:"From"}),(0,a.jsxs)("div",{className:"flex w-full items-center gap-2 rounded-md border px-2 py-1.5 opacity-70",children:[(0,a.jsx)(N.z,{workspace:v,className:"h-5 w-5 rounded-[6px]"}),(0,a.jsx)("p",{className:"text-sm",children:null==v?void 0:v.name}),(0,a.jsx)(r.v,{plan:null==v?void 0:v.plan})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"min-w-[60px] text-sm font-medium",children:"To"}),(0,a.jsxs)(u.Ph,{value:D,onValueChange:z,children:[(0,a.jsx)(u.i4,{className:"px-2 py-1.5",children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(u.ki,{placeholder:"Select a workspace",className:"mr-auto"})})}),(0,a.jsxs)(u.Bw,{children:[g.map(e=>{var t,s,n,l;return(0,a.jsx)(u.Ql,{value:e.id,disabled:e.id===v.id||(null===(t=e.membership)||void 0===t?void 0:t.role)!=="owner"&&(null===(s=e.membership)||void 0===s?void 0:s.role)!=="admin",className:"focus:bg-accent/50",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(N.z,{workspace:e,className:"h-5 w-5 rounded-[6px]"}),(0,a.jsx)("p",{children:e.name}),e.plan&&(0,a.jsx)(r.v,{plan:e.plan}),(null===(n=e.membership)||void 0===n?void 0:n.role)!=="owner"&&(null===(l=e.membership)||void 0===l?void 0:l.role)!=="admin"&&(0,a.jsx)("span",{className:"text-sm text-destructive-foreground",children:"(Not admin)"})]})},e.id)}),(0,a.jsxs)("button",{className:"flex w-full items-center gap-2 rounded-sm px-2 py-1.5 text-sm hover:bg-accent",onClick:()=>{I(!0)},children:[(0,a.jsx)("div",{className:"flex h-5 w-5 items-center justify-center",children:(0,a.jsx)(k.Z,{name:"add",size:"small"})}),"Create new"]})]})]})]})]}),(0,a.jsxs)(d.cN,{className:"gap-2",children:[(0,a.jsx)(c.z,{size:"sm",variant:"outline",onClick:()=>E(!1),children:"Cancel"}),(0,a.jsx)(c.z,{disabled:!O,variant:"affirmative",size:"sm",onClick:()=>{O&&A(O)},loading:j,children:j?"Transferring...":"Confirm transfer"})]})]})]})}},27058:function(e,t,s){s.d(t,{H:function(){return l}});var a=s(57437),n=s(35974),r=s(94508);let l=e=>{let{status:t}=e;return(0,a.jsxs)(n.C,{className:"flex w-auto items-center gap-1.5 bg-secondary text-xs text-foreground shadow-none hover:bg-secondary",children:[(0,a.jsx)("span",{className:(0,r.cn)("h-1.5 w-1.5 rounded-full","connected"===t?"bg-success-primary":"bg-warning-primary")}),"connected"===t?"Connected":"Not connected"]})}},93459:function(e,t,s){s.d(t,{_:function(){return c}});var a=s(2265),n=s(14438),r=s(78079),l=s(10867),i=s(64040),o=s(72384);let c=(e,t)=>{let{mutateAsync:s,isPending:c}=(0,r.mo)({projectId:e,onSuccess:()=>{n.Am.success("Supabase connected",{description:"Follow the instructions in the chat to complete the integration."}),null==t||t()}});return{handleProjectSelect:(0,a.useCallback)(async t=>{if(t)try{await s({body:{id:(0,l.Fd)(),message:"Please connect my supabase project `".concat(t.name,"`"),mode:o.S.INSTANT,contains_error:!1,integrate_supabase_project_id:t.id,integrate_supabase_org_id:t.organization_id},projectId:e},{})}catch(e){(0,i.Eo)(e)}},[s,e]),isConnecting:c}}},38343:function(e,t,s){s.d(t,{c:function(){return S},n:function(){return z}});var a=s(57437),n=s(82176),r=s(74751),l=s(32165),i=s(2265),o=s(55721),c=s(78276),d=s(57346),u=s(56922),m=s(22876);let p=e=>{let{onProjectSelect:t,triggerComponent:s,supabaseOrganizations:n,handleConnect:r,isConnectLoading:l,isWorkspaceAdmin:p,align:x="start"}=e,[h,g]=(0,i.useState)(!1);return(0,a.jsx)(u.D,{setSelectedProject:t,setOpen:g,children:(0,a.jsxs)(o.h_,{open:h,onOpenChange:g,children:[s,(0,a.jsxs)(o.AW,{className:"w-48",align:x,children:[(0,a.jsx)(o.Ju,{className:"text-xs font-medium text-muted-foreground",children:"Supabase organizations"}),n.map(e=>(0,a.jsx)(m.K,{organization:e},e.id)),(0,a.jsx)(o.VD,{}),(0,a.jsx)(c.b,{showTooltip:!p,tooltipContent:"You are not an admin of this workspace",children:(0,a.jsxs)(o.Xi,{onClick:r,className:"text-sm",disabled:l||!p,children:[(0,a.jsx)(d.Z,{name:"add",size:"small"}),"Add organization"]})})]})]})})};var x=s(27559),h=s(35974),g=s(62869),f=s(53647),j=s(27132),v=s(65666),b=s(21288),y=s(10531),w=s(22853),N=s(94508),_=s(37675),k=s(93459);let S=e=>{let{supabaseOrganizations:t,connectedSupabaseProject:s,setShowConnectDialog:r,isWorkspaceAdmin:i}=e,o=(0,v.D)(),c=(0,_.bk)(e=>e.isSendChatMessageMutationPending),{handleProjectSelect:d,isConnecting:u}=(0,k._)(o),m=null==s?void 0:s.status,p=null!==s&&!t.some(e=>e.id===(null==s?void 0:s.organization_id)),x=(0,n.dl)(y.P.SupabaseOnCreation);return(0,a.jsx)(l.P,{label:"Project",description:"Choose the Supabase project to sync with.",justify:"end",customBadge:(0,a.jsx)(z,{status:m||"not-connected"}),children:x?(0,a.jsx)(C,{connectedProjectIsInUnconnectedOrganization:p,supabaseOrganizations:t,isConnecting:u,isSendChatMessageMutationPending:c,isWorkspaceAdmin:i,setShowConnectDialog:r,handleProjectSelect:d,connectedSupabaseProject:s}):(0,a.jsx)(E,{connectedProjectIsInUnconnectedOrganization:p,supabaseOrganizations:t,isConnecting:u,isSendChatMessageMutationPending:c,isWorkspaceAdmin:i,setShowConnectDialog:r,handleProjectSelect:d,connectedSupabaseProject:s})})},C=e=>{let{connectedProjectIsInUnconnectedOrganization:t,supabaseOrganizations:s,isConnecting:n,isSendChatMessageMutationPending:r,isWorkspaceAdmin:l,setShowConnectDialog:i,handleProjectSelect:d,connectedSupabaseProject:u}=e;return(0,a.jsx)(p,{align:"end",onProjectSelect:e=>{e&&d(e)},triggerComponent:(0,a.jsx)(c.b,{showTooltip:!u&&r,tooltipContent:"Edits ongoing...",children:(0,a.jsx)(o.$F,{asChild:!0,children:(0,a.jsx)(g.z,{disabled:!!u||n||r,size:"sm",variant:"outline",loading:n,children:u?u.name:t?"Project not found":"Connect a project"})})}),supabaseOrganizations:s,handleConnect:()=>i(!0),isConnectLoading:n,isWorkspaceAdmin:l})},E=e=>{let{connectedSupabaseProject:t,connectedProjectIsInUnconnectedOrganization:s,supabaseOrganizations:n,isConnecting:l,isSendChatMessageMutationPending:i,isWorkspaceAdmin:o,setShowConnectDialog:u,handleProjectSelect:m}=e,p=(0,j.Z)("md");return(0,a.jsxs)(f.Ph,{value:s?void 0:(null==t?void 0:t.id)||void 0,onValueChange:e=>{let t=n.flatMap(e=>e.projects).find(t=>t.id===e);t&&m(t)},disabled:l||i||s,children:[(0,a.jsx)(c.b,{showTooltip:l||i,tooltipContent:l?"Connecting to Supabase...":"Edits ongoing...",children:(0,a.jsx)(f.i4,{className:"group relative h-7 w-auto gap-2 bg-muted px-3 py-2 font-medium text-foreground data-[placeholder]:text-foreground","data-state":t&&!(0,x.u)(t)?"checked":"",children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{name:"progress_activity",className:"animate-spin",size:"small"}),(0,a.jsx)("span",{children:"Connecting..."})]}):(0,a.jsx)(f.ki,{placeholder:s?"Project not found":"Connect a project"})})}),(0,a.jsxs)(f.Bw,{align:p?"start":"end",children:[n.map(e=>{let t=[...e.projects].sort((e,t)=>(0,x.u)(e)&&!(0,x.u)(t)?-1:(0,x.u)(t)&&!(0,x.u)(e)?1:0);return(0,a.jsxs)(f.DI,{className:"w-full",children:[(0,a.jsx)(f.n5,{className:"text-xs text-muted-foreground",children:e.name}),t.map(e=>{let t=(0,x.u)(e);return(0,a.jsx)(c.b,{showTooltip:!t,tooltipContent:"Check project status in Supabase.",side:"left",instant:!0,children:(0,a.jsxs)(f.Ql,{value:e.id,disabled:!t,className:"group flex w-full items-center",children:[(0,a.jsx)("span",{className:"group-data-[state=checked]:mr-3",children:e.name}),!t&&(0,a.jsx)(d.Z,{name:"warning_fill",className:"pointer-events-auto absolute right-2 top-1/2 h-4 w-4 -translate-y-1/2 text-destructive-primary group-data-[state=checked]:right-7"})]})},e.id)}),(0,a.jsx)(g.z,{variant:"ghost",className:"flex w-full items-center justify-between gap-2 rounded-sm px-2 py-1.5 text-left font-normal hover:bg-accent",asChild:!0,children:(0,a.jsxs)("a",{href:"https://supabase.com/dashboard/new/".concat(e.id),target:"_blank",rel:"noreferrer",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.Z,{name:"add",size:"small"}),(0,a.jsx)("span",{className:"text-sm",children:"Create project"})]}),(0,a.jsx)(d.Z,{name:"arrow_outward",size:"small"})]})}),(0,a.jsx)(f.U$,{})]},e.id)}),(0,a.jsx)(c.b,{showTooltip:!o,tooltipContent:"You need to be an admin to add an organization.",side:"left",instant:!0,children:(0,a.jsxs)(g.z,{variant:"ghost",className:"flex w-full items-center justify-start gap-2 rounded-sm px-2 py-1.5 text-left font-normal hover:bg-accent",onClick:()=>u(!0),disabled:!o,children:[(0,a.jsx)(d.Z,{name:"add",size:"small"}),(0,a.jsx)("span",{className:"text-sm",children:"Add organization"}),!o&&(0,a.jsx)(r.p,{badge:"admin",className:"flex md:hidden"})]})})]})]},(null==t?void 0:t.id)||"disconnected")},A={[w.k.ACTIVE_HEALTHY]:{label:"Connected",className:"bg-success-primary"},[w.k.ACTIVE_UNHEALTHY]:{label:"Issues detected",className:"bg-warning-primary"},[w.k.COMING_UP]:{label:"Starting up",className:"bg-affirmative-primary"},[w.k.GOING_DOWN]:{label:"Shutting down",className:"bg-destructive-primary"},[w.k.INACTIVE]:{label:"Inactive",className:"bg-destructive-primary"},[w.k.INIT_FAILED]:{label:"Setup failed",className:"bg-destructive-primary"},[w.k.REMOVED]:{label:"Removed",className:"bg-destructive-primary"},[w.k.RESTARTING]:{label:"Restarting",className:"bg-warning-primary"},[w.k.UNKNOWN]:{label:"Unknown",className:"bg-destructive-primary"},[w.k.UPGRADING]:{label:"Upgrading",className:"bg-warning-primary"},[w.k.PAUSING]:{label:"Pausing",className:"bg-warning-primary"},[w.k.RESTORING]:{label:"Restoring",className:"bg-warning-primary"},[w.k.RESTORE_FAILED]:{label:"Restore failed",className:"bg-destructive-primary"},[w.k.PAUSE_FAILED]:{label:"Pause failed",className:"bg-destructive-primary"},"not-connected":{label:"Not connected",className:"bg-warning-primary"}},D=e=>e in A?A[e]:(b.logging.warn("Unknown supabase project status",{status:e}),{label:e,className:""}),z=e=>{let{status:t}=e,s=D(t);return s?(0,a.jsxs)(h.C,{className:"flex w-auto items-center gap-1.5 bg-secondary text-xs text-foreground shadow-none hover:bg-secondary",children:[(0,a.jsx)("span",{className:(0,N.cn)("h-1.5 w-1.5 rounded-full",s.className)}),s.label]}):null}},75403:function(e,t,s){s.d(t,{Z:function(){return a}});function a(e,t){if(e.isLoading||!t||!e.supabaseOrganizations)return!1;if(e.noOrganizations)return!0;let s=e.supabaseOrganizations.find(e=>e.id===t.supabase_organization_id);return!s||"failed"===s.status}},32112:function(e,t,s){s.d(t,{default:function(){return r6}});var a,n,r,l,i=s(57437),o=s(2265),c=s(44481),d=s(52558),u=s(61922),m=s(82176),p=s(66870),x=s(95565),h=s(92850),g=s(49131);let f=e=>{let{projectId:t,start:s,end:a,enabled:n=!0}=e;return(0,h.a)({queryKey:["projects",t,"integrations","ai_gateway","usage",{start:s,end:a}],queryFn:async()=>{let e=(0,g.SJ)(),n=new URLSearchParams;s&&n.append("start",s),a&&n.append("end",a);let r=n.toString(),l="/projects/".concat(t,"/integrations/ai_gateway/usage").concat(r?"?".concat(r):"");return e.get(l)},enabled:n&&!!t})};var j=s(62869),v=s(55721),b=s(57346),y=s(27132);let w=()=>{let e=new Date,t=[];return t.push({label:"Last 24 hours",value:"24h",start:new Date(e.getTime()-864e5).toISOString(),end:e.toISOString()}),t.push({label:"Last 7 days",value:"7d",start:new Date(e.getTime()-6048e5).toISOString(),end:e.toISOString()}),t.push({label:"Last 30 days",value:"30d",start:new Date(e.getTime()-2592e6).toISOString(),end:e.toISOString()}),t},N=e=>{let{selectedPeriod:t,onPeriodChange:s}=e,a=(0,y.Z)("md"),n=w();return(0,i.jsxs)(v.h_,{children:[(0,i.jsx)(v.$F,{asChild:!0,children:(0,i.jsxs)(j.z,{variant:"outline",className:"justify-between text-foreground md:min-w-32 md:px-3",size:a?"sm":"default",children:[t.label,(0,i.jsx)(b.Z,{name:"chevron_right",size:"small",className:"rotate-90"})]})}),(0,i.jsx)(v.AW,{align:"end",className:"min-w-32",children:n.map(e=>(0,i.jsx)(v.Xi,{onClick:()=>s(e),children:e.label},e.value))})]})};var _=s(60936),k=s(72470),S=s(84927),C=s(56942),E=s(53306),A=s(94773),D=s(54886),z=s(66491),I=s(47625),O=s(77031),P=s(56940),T=s(97059),L=s(62994),R=s(22190),F=s(83046),Z=s(22287),M=s(8147),q=s(94508);let U={light:"",dark:".dark"},K=o.createContext(null);function G(e){let{id:t,className:s,children:a,config:n,...r}=e,l=o.useId(),c="chart-".concat(t||l.replace(/:/g,""));return(0,i.jsx)(K.Provider,{value:{config:n},children:(0,i.jsxs)("div",{"data-slot":"chart","data-chart":c,className:(0,q.cn)("[&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-surface]:outline-hidden flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent",s),...r,children:[(0,i.jsx)(W,{id:c,config:n}),(0,i.jsx)(I.h,{children:a})]})})}let W=e=>{let{id:t,config:s}=e,a=Object.entries(s).filter(e=>{let[,t]=e;return t.theme||t.color});return a.length?(0,i.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(U).map(e=>{let[s,n]=e;return"\n".concat(n," [data-chart=").concat(t,"] {\n").concat(a.map(e=>{var t;let[a,n]=e,r=(null===(t=n.theme)||void 0===t?void 0:t[s])||n.color;return r?"  --color-".concat(a,": ").concat(r,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},J=M.u;function V(e){let{active:t,payload:s,className:a,indicator:n="dot",hideLabel:r=!1,hideIndicator:l=!1,label:c,labelFormatter:d,labelClassName:u,formatter:m,color:p,nameKey:x,labelKey:h}=e,{config:g}=function(){let e=o.useContext(K);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}(),f=o.useMemo(()=>{var e;if(r||!(null==s?void 0:s.length))return null;let[t]=s,a="".concat(h||(null==t?void 0:t.dataKey)||(null==t?void 0:t.name)||"value"),n=B(g,t,a),l=h||"string"!=typeof c?null==n?void 0:n.label:(null===(e=g[c])||void 0===e?void 0:e.label)||c;return d?(0,i.jsx)("div",{className:(0,q.cn)("font-medium",u),children:d(l,s)}):l?(0,i.jsx)("div",{className:(0,q.cn)("font-medium",u),children:l}):null},[c,d,s,r,u,g,h]);if(!t||!(null==s?void 0:s.length))return null;let j=1===s.length&&"dot"!==n;return(0,i.jsxs)("div",{className:(0,q.cn)("grid min-w-32 items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",a),children:[j?null:f,(0,i.jsx)("div",{className:"grid gap-1.5",children:s.map((e,t)=>{let s="".concat(x||e.name||e.dataKey||"value"),a=B(g,e,s),r=p||e.payload.fill||e.color;return(0,i.jsx)("div",{className:(0,q.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===n&&"items-center"),children:m&&(null==e?void 0:e.value)!==void 0&&e.name?m(e.value,e.name,e,t,e.payload):(0,i.jsxs)(i.Fragment,{children:[(null==a?void 0:a.icon)?(0,i.jsx)(a.icon,{}):!l&&(0,i.jsx)("div",{className:(0,q.cn)("border-(--color-border) bg-(--color-bg) shrink-0 rounded-[2px]",{"h-2.5 w-2.5":"dot"===n,"w-1":"line"===n,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===n,"my-0.5":j&&"dashed"===n}),style:{"--color-bg":r,"--color-border":r}}),(0,i.jsxs)("div",{className:(0,q.cn)("flex flex-1 justify-between leading-none",j?"items-end":"items-center"),children:[(0,i.jsxs)("div",{className:"grid gap-1.5",children:[j?f:null,(0,i.jsx)("span",{className:"text-muted-foreground",children:(null==a?void 0:a.label)||e.name})]}),e.value&&(0,i.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})}function B(e,t,s){if("object"!=typeof t||null===t)return;let a="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,n=s;return t&&s in t&&"string"==typeof t[s]?n=t[s]:a&&s in a&&"string"==typeof a[s]&&(n=a[s]),n in e?e[n]:e[s]}R.D;let H=e=>{let t=e=>"hsl(".concat(120+137.508*e%360/360*200,", ").concat(70+e%3*10,"%, ").concat(50+e%4*5,"%)"),s={};return e.forEach((e,a)=>{s[e]={label:e,color:t(a)}}),s},Q=e=>{let{active:t,payload:s,label:a}=e;return t&&s&&s.length?(0,i.jsxs)("div",{className:"rounded-lg border bg-background p-3 shadow-md",children:[(0,i.jsx)("p",{className:"mb-2 font-medium text-foreground",children:a}),(0,i.jsx)("div",{className:"space-y-1",children:s.map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("div",{className:"h-3 w-3 rounded-sm",style:{backgroundColor:e.color}}),(0,i.jsx)("span",{className:"text-sm text-muted-foreground",children:e.dataKey})]}),(0,i.jsx)("span",{className:"text-sm font-medium text-foreground",children:e.value})]},t))})]}):null},Y=e=>{let{data:t,isLoading:s,granularity:a="day"}=e,{chartData:n,chartConfig:r}=(0,o.useMemo)(()=>{if(!t||0===t.length)return{chartData:[],chartConfig:{}};let e=new Set,s=null,n=null,r={};return(t.forEach(t=>{try{var l;let i=null===(l=t.timestamp)||void 0===l?void 0:l.trim();if(!i)return;let o=(0,_.D)(i);if(isNaN(o.getTime()))return;(!s||o<s)&&(s=o),(!n||o>n)&&(n=o);let c=("minute"===a?(0,k.F)(o):"hour"===a?(0,S.o)(o):(0,C.b)(o)).toISOString(),d=t.model||"Unknown";e.add(d),r[c]||(r[c]={}),r[c][d]=(r[c][d]||0)+(t.count||1)}catch(e){}}),s&&n)?{chartData:("minute"===a?(0,E.z)({start:(0,k.F)(s),end:(0,k.F)(n)}):"hour"===a?(0,A.e)({start:(0,S.o)(s),end:(0,S.o)(n)}):(0,D.D)({start:(0,C.b)(s),end:(0,C.b)(n)})).map(t=>{let s=t.toISOString(),n={timeKey:"minute"===a?(0,z.WU)(t,"HH:mm"):"hour"===a?(0,z.WU)(t,"MMM dd, HH:mm"):(0,z.WU)(t,"MMM dd")};return e.forEach(e=>{n[e]=0}),r[s]&&Object.entries(r[s]).forEach(e=>{let[t,s]=e;n[t]=s}),n}),chartConfig:H(Array.from(e))}:{chartData:[],chartConfig:{}}},[t,a]);if(s)return(0,i.jsx)("div",{className:"flex h-80 w-full items-center justify-center",children:(0,i.jsx)(Z.$,{})});if(0===n.length)return(0,i.jsx)("div",{className:"flex h-80 w-full items-center justify-center rounded-lg border border-dashed",children:(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"No AI Gateway usage data available for the selected period."})});let l=Object.keys(r);return(0,i.jsx)("div",{className:"w-full",children:(0,i.jsx)(G,{config:r,className:"h-80 w-full",children:(0,i.jsx)(I.h,{width:"100%",height:"100%",children:(0,i.jsxs)(O.v,{data:n,width:void 0,height:void 0,margin:{top:20,right:5,left:0,bottom:20},children:[(0,i.jsx)(P.q,{strokeDasharray:"3 3"}),(0,i.jsx)(T.K,{dataKey:"timeKey",tick:!1,axisLine:!1,tickLine:!1}),(0,i.jsx)(L.B,{axisLine:!1,tickLine:!1,tick:{fontSize:12},width:30}),(0,i.jsx)(J,{content:(0,i.jsx)(Q,{})}),(0,i.jsx)(R.D,{}),l.map(e=>(0,i.jsx)(F.$,{dataKey:e,stackId:"models",fill:r[e].color,radius:[0,0,0,0]},e))]})})})})};var X=s(93022);let $=e=>{let{data:t,isLoading:s}=e,a=t.reduce((e,t)=>e+t.count,0);return(0,i.jsx)("div",{className:"rounded-lg border p-4",children:(0,i.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,i.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Requests"}),s?(0,i.jsx)(X.O,{className:"h-8 w-20"}):(0,i.jsx)("p",{className:"font-bold text-3xl",children:a.toLocaleString()})]})})},ee=e=>{let{project:t}=e,[s,a]=(0,o.useState)(w()[1]),n="24h"===s.value?"minute":"day",{data:r}=(0,x.W)({projectId:t.id}),{data:l,isLoading:c}=f({projectId:t.id,start:s.start,end:s.end});return(0,i.jsx)(p.tM,{title:"AI Gateway",value:"ai_gateway",description:"Monitor your project's AI Gateway usage and performance.",docsLink:"https://docs.lovable.dev/features/ai-gateway",children:(0,i.jsxs)("div",{className:"flex w-full flex-col gap-6",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-5",children:[(0,i.jsx)("p",{className:"font-medium",children:"AI Gateway Status"}),(0,i.jsxs)("div",{className:"flex items-center gap-3 rounded-lg border border-border p-4",children:[(0,i.jsx)("div",{className:"h-3 w-3 rounded-full ".concat((null==r?void 0:r.is_used)?"bg-green-500":"bg-gray-400")}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"text-sm font-medium",children:["Status: ",(null==r?void 0:r.is_used)?"Active":"Not in use"]}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:(null==r?void 0:r.is_used)?"Your project is using Lovable's AI Gateway for secure API communication.":"Your project is not currently using the AI Gateway. Lovable will automatically activate it when you implement a feature that uses AI."})]})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-5",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("p",{className:"font-medium",children:"Usage Statistics"}),(0,i.jsx)(N,{selectedPeriod:s,onPeriodChange:a})]}),(0,i.jsx)($,{data:l||[],isLoading:c})]}),(0,i.jsx)("div",{className:"grid grid-cols-1 gap-5",children:(0,i.jsx)(Y,{data:l||[],isLoading:c,granularity:n})})]})})};var et=s(29827),es=s(33187),ea=s(97318),en=s(5460),er=s(77113),el=s(14376),ei=s(5481),eo=s(23263);let ec={totalVisits:{title:"Visitors",valueType:"number",timeSeriesKey:"visitors",description:"Total number of visitors to your app."},totalPageviews:{title:"Pageviews",valueType:"number",timeSeriesKey:"pageviews",description:"Total number of pages viewed by all visitors."},pageviewsPerVisit:{title:"Views Per Visit",valueType:"number",timeSeriesKey:"pageviewsPerVisit",description:"How many pages the average visitor viewed."},sessionDuration:{title:"Visit Duration",valueType:"time",timeSeriesKey:"sessionDuration",description:"How long the average visit to your app lasted."},bounceRate:{title:"Bounce Rate",valueType:"percentage",timeSeriesKey:"bounceRate",description:"Percentage of visitors who left after viewing only one page."}};var ed=s(24613),eu=s(10123),em=s(53974),ep=s(81103);let ex=()=>{let[e,t]=(0,em._)("temporary-analytics-banner",!0);return e?(0,i.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,i.jsx)("span",{className:"font-medium",children:"Note: "}),"We started tracking analytics between the 4th and 7th of July. Data before this period is not available."]}),(0,i.jsxs)(ep.u,{instant:!0,children:[(0,i.jsx)(ep.aJ,{children:(0,i.jsx)(j.z,{variant:"ghost",size:"icon-sm",onClick:()=>t(!1),children:(0,i.jsx)(b.Z,{name:"close",size:"small"})})}),(0,i.jsx)(ep._v,{children:(0,i.jsx)("p",{children:"Don't show this message again"})})]})]}):null},eh={value:{label:"Views"}},eg=e=>{let{data:t,valueType:s="number",granularity:a,selectedMetric:n,isLoading:r,userTimezone:l,onRefresh:c}=e,d=(0,o.useCallback)((e,t)=>{let s=(0,_.D)(e+(e.includes(" ")?"":"T00:00:00")+"Z"),a=(0,el.zW)(s,(0,eu.Sv)(l));return(0,z.WU)(a,t)},[l]);return(0,i.jsxs)("div",{className:"w-full rounded-xl border bg-muted p-4",children:[(0,i.jsx)(ex,{}),0!==t.length||r?r?(0,i.jsx)("div",{className:"flex h-[200px] w-full items-center justify-center md:h-[400px]",children:(0,i.jsx)(Z.$,{})}):(0,i.jsx)(G,{config:eh,className:"h-[200px] w-full max-w-full md:h-[400px]",children:(0,i.jsxs)(ei.T,{data:t,margin:{left:"time"===s?0:-15,right:10,top:20,bottom:5},children:[(0,i.jsx)("defs",{children:(0,i.jsxs)("linearGradient",{id:"fillGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,i.jsx)("stop",{offset:"5%",stopColor:"var(--chart-1)",stopOpacity:.2}),(0,i.jsx)("stop",{offset:"95%",stopColor:"var(--chart-1)",stopOpacity:.02})]})}),(0,i.jsx)(P.q,{horizontal:!0,vertical:!1,stroke:"hsl(var(--muted-border))"}),(0,i.jsx)(T.K,{dataKey:"date",tickLine:!1,tickMargin:10,interval:"equidistantPreserveStart",tickFormatter:e=>{switch(a){case"hourly":return d(e,"HH:mm");case"daily":return d(e,"d MMM")}}}),(0,i.jsx)(L.B,{dataKey:"value",tickLine:!1,axisLine:!1,tickMargin:10,tickCount:5,tickFormatter:e=>{switch(s){case"number":return(0,ed.ZI)(e);case"percentage":return"".concat(e,"%");case"time":return(0,ed.mr)(e)}}}),(0,i.jsx)(eo.u,{dataKey:"value",strokeWidth:2,stroke:"var(--chart-1)",dot:!1,fill:"url(#fillGradient)",animationDuration:500,animationEasing:"ease-in-out"}),(0,i.jsx)(J,{cursor:!1,content:(0,i.jsx)(V,{formatter:e=>(0,i.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,i.jsx)("span",{className:"mr-1 h-3 w-3 rounded-full bg-chart-1"})," ",(0,i.jsx)("span",{className:"font-medium",children:(0,ed.Bw)({value:e,valueType:s})})," ",(0,i.jsx)("span",{className:"",children:ec[n].title})]}),labelFormatter:e=>{let t="";return t="hourly"===a?d(e,"d MMM, HH:mm"):d(e,"d MMM"),(0,i.jsx)("p",{className:"text-sm",children:t})}})})]})}):(0,i.jsxs)("div",{className:"flex h-[200px] w-full flex-col items-center justify-center gap-2 md:h-[400px]",children:[(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"No data available"}),(0,i.jsxs)(j.z,{variant:"outline",size:"sm",onClick:c,children:[(0,i.jsx)(b.Z,{name:"refresh",size:"small"}),"Refresh"]})]})]})},ef=/./g,ej=e=>e.toUpperCase().replace(ef,e=>String.fromCodePoint(127397+e.charCodeAt(0))),ev=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";try{return new Intl.DisplayNames([t],{type:"region"}).of(e.toUpperCase())||e}catch(t){return e}},eb=e=>{let{type:t,label:s}=e;switch(t){case"country":return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"origin-left scale-[1.35] transform",children:ej(s)}),(0,i.jsx)("span",{children:ev(s)})]});case"device":if("mobile-ios"===s)return"Mobile - iOS";if("mobile-android"===s)return"Mobile - Android";return s.charAt(0).toUpperCase()+s.slice(1);default:return s}},ey=e=>{switch(e){case"country":return"The top countries your visitors are from.";case"device":return"The most used devices by your visitors.";case"source":return"The most common sources of traffic to your app.";case"page":return"The most viewed pages in your app."}},ew=e=>{let{type:t,value:s,total:a}=e;if("device"===t){let e=s/a*100;return"".concat(e.toFixed(1),"%")}return(0,ed.ZI)(s)},eN=e=>{let{data:t,type:s,metric:a,color:n,isLoading:r}=e,l=Math.max(...t.map(e=>e.value)),o=t.sort((e,t)=>t.value-e.value),c=t.reduce((e,t)=>e+t.value,0);return(0,i.jsxs)("div",{className:"flex flex-col gap-4 rounded-xl border border-border bg-muted p-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between text-sm font-medium",children:[(0,i.jsxs)(ep.u,{instant:!0,children:[(0,i.jsx)(ep.aJ,{children:(0,i.jsx)("p",{className:"capitalize",children:s})}),(0,i.jsx)(ep._v,{children:ey(s)})]}),(0,i.jsx)("p",{children:a})]}),!r&&o.length>0&&o.map(e=>{let t=e.value/l*100,r=eb({type:s,label:e.label}),o=ew({type:s,value:e.value,total:c});return"Unknown"===e.label?null:(0,i.jsxs)("div",{className:"flex items-center justify-between gap-4 text-sm",children:[(0,i.jsxs)("div",{className:"relative flex-1 px-2 py-1",children:[(0,i.jsx)("div",{className:"absolute inset-y-0 left-0 rounded-md bg-accent",style:{width:"".concat(t,"%"),minWidth:"10px",backgroundColor:n}}),(0,i.jsx)("p",{className:"relative z-10 flex items-center gap-3 break-all",children:r})]}),(0,i.jsxs)(ep.u,{delayDuration:0,children:[(0,i.jsx)(ep.aJ,{children:(0,i.jsx)("p",{children:o})}),(0,i.jsx)(ep._v,{children:(0,i.jsxs)("p",{children:[e.value," ",a]})})]})]},e.label)}),!r&&0===o.length&&(0,i.jsx)("p",{className:"text-base text-muted-foreground md:text-sm",children:"No data found for this time period."}),r&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,i.jsx)(X.O,{className:"h-6 flex-1"}),(0,i.jsx)(X.O,{className:"h-6 w-8"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,i.jsx)(X.O,{className:"h-6 w-1/2"}),(0,i.jsx)(X.O,{className:"h-6 w-8"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,i.jsx)(X.O,{className:"h-6 w-1/4"}),(0,i.jsx)(X.O,{className:"h-6 w-8"})]})]})]})},e_=e=>{let{title:t,value:s,valueType:a="number",changePercentage:n,onClick:r,isSelected:l,isLoading:o,description:c}=e,d=n&&n>0,u=n&&0===n;return(0,i.jsxs)(ep.u,{delayDuration:0,children:[(0,i.jsx)(ep.aJ,{asChild:!0,children:(0,i.jsxs)("div",{className:(0,q.cn)("group flex cursor-pointer flex-col gap-2 rounded-xl border bg-muted p-4",l&&"border-accent-primary/50"),onClick:r,children:[(0,i.jsx)("p",{className:(0,q.cn)("text-sm font-medium group-hover:text-accent-primary",l&&"text-accent-primary"),children:t}),(0,i.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,i.jsx)("p",{className:"h-5 font-medium",children:o?(0,i.jsx)(X.O,{className:"h-full w-8"}):(0,ed.Bw)({value:s,valueType:a})}),n&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:(0,q.cn)("flex items-center gap-1",d?"text-success-primary":u?"text-warning-primary":"text-destructive-primary"),children:[(0,i.jsx)(b.Z,{name:d?"trending_up":u?"trending_flat":"trending_down",size:"small"}),(0,i.jsxs)("p",{className:"text-sm",children:[n,"%"]})]})})]})]})}),(0,i.jsxs)(ep._v,{className:"max-w-[35ch]",children:[(0,i.jsxs)("p",{className:"text-sm",children:[(0,i.jsx)("span",{className:"font-medium",children:(0,ed.Bw)({value:s,valueType:a,roundNumber:!1})})," ",(0,i.jsx)("span",{className:"",children:t.toLowerCase()})]}),c&&(0,i.jsx)("p",{className:"text-xs opacity-80",children:c})]})]})};var ek=s(87488);let eS=e=>{let{project:t}=e,{data:s,dataUpdatedAt:a,isLoading:n}=(0,h.a)({...es.W.analyticsTrend({projectId:t.id}),enabled:!t.is_analytics_disabled&&t.is_published}),r=(null==s?void 0:s.currentVisitors)&&s.currentVisitors>0,l=r?s.currentVisitors:0;return s||n?n?(0,i.jsx)(X.O,{className:"h-full w-8"}):(0,i.jsxs)(ep.u,{instant:!0,children:[(0,i.jsx)(ep.aJ,{asChild:!0,children:(0,i.jsxs)("div",{className:"hidden cursor-pointer items-center gap-1 text-foreground md:flex",children:[(0,i.jsx)("div",{className:(0,q.cn)("mr-1 size-2 shrink-0 rounded-full",r?"animate-pulse bg-success-primary":"bg-muted-foreground")}),(0,i.jsx)("p",{className:"text-sm",children:l}),(0,i.jsxs)("p",{className:"whitespace-nowrap text-sm",children:["current ",1===l?"visitor":"visitors"]})]})}),(0,i.jsx)(ep._v,{children:(0,i.jsx)(eC,{timestamp:a})})]}):null},eC=e=>{let{timestamp:t}=e,[s,a]=(0,o.useState)(new Date);return(0,o.useEffect)(()=>{let e=setInterval(()=>{a(new Date)},1e3);return()=>clearInterval(e)},[]),(0,i.jsxs)("p",{children:["Last updated ",(0,ek.c)(s,new Date(t))," seconds ago"]})},eE=e=>{let{selectedTimePeriod:t,setSelectedTimePeriod:s,userTimezone:a}=e,n=(0,y.Z)("md"),r=(0,o.useMemo)(()=>Object.entries(eu.fV).map(e=>{let[t,s]=e,n=s.getTimePeriod(a);return{key:t,label:s.label,timePeriod:n}}),[a]),l=eu.fV[t.preset].label;return(0,i.jsxs)(v.h_,{children:[(0,i.jsx)(v.$F,{asChild:!0,children:(0,i.jsxs)(j.z,{variant:"outline",className:"justify-between text-foreground md:min-w-32 md:px-3",size:n?"sm":"default",children:[l,(0,i.jsx)(b.Z,{name:"chevron_right",size:"small",className:"rotate-90"})]})}),(0,i.jsx)(v.AW,{align:"end",className:"min-w-32",children:r.map(e=>(0,i.jsx)(v.Xi,{onClick:()=>s(e.timePeriod),children:e.label},e.key))})]})},eA=e=>{var t,s,a,n,r;let{project:l}=e,[c,d]=(0,o.useState)("totalVisits"),[u,m]=(0,o.useState)(eu.HX),{data:x,isLoading:g}=(0,h.a)({...es.W.analytics({projectId:l.id,timePeriod:u}),enabled:!l.is_analytics_disabled&&l.is_published}),f=!!l.url,{updateProject:v}=(0,er.d2)(),y=async()=>{v({is_analytics_disabled:!1});try{await (0,en.G)({projectId:l.id})}catch(e){console.error("Error updating deployment ID",e)}},w=(0,et.NL)(),N=async()=>{await w.invalidateQueries({queryKey:ea.iZ.analytics(l.id,u)})};return!f||l.is_analytics_disabled?(0,i.jsx)(p.tM,{title:"Analytics",value:"analytics",description:"Measure how your published project is performing.",children:(0,i.jsxs)("div",{className:"flex w-full flex-1 flex-col items-center justify-center gap-2 text-muted-foreground",children:[(0,i.jsx)(b.Z,{name:"bid_landscape",size:"large"}),f?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{className:"text-base md:text-sm",children:"Tracking analytics is disabled for this project."}),(0,i.jsx)(j.z,{variant:"outline",size:"sm",className:"mt-4",onClick:y,children:"Enable Analytics"})]}):(0,i.jsx)("p",{className:"text-base md:text-sm",children:"To view analytics, you first need to publish your project."})]})}):(0,i.jsxs)(p.tM,{title:"Analytics",value:"analytics",description:(0,i.jsxs)("p",{children:["Measure how your"," ",(0,i.jsx)("a",{href:null!==(t=l.url)&&void 0!==t?t:"".concat(l.name,".lovable.app"),target:"_blank",rel:"noopener noreferrer",className:"font-medium hover:underline",children:"published project"})," ","is performing."]}),descriptionAction:(0,i.jsxs)("div",{className:"flex items-center gap-5 md:-mt-1.5",children:[(0,i.jsx)(eS,{project:l}),(0,i.jsx)(eE,{selectedTimePeriod:u,setSelectedTimePeriod:m})]}),children:[(0,i.jsx)("div",{className:"grid grid-cols-2 gap-6 md:grid-cols-3 lg:grid-cols-5",children:Object.entries(ec).map(e=>{var t,s;let[a,n]=e,{title:r,valueType:l,timeSeriesKey:o,description:u}=n,m=null!==(s=null==x?void 0:null===(t=x.timeSeries[o])||void 0===t?void 0:t.total)&&void 0!==s?s:0;return(0,i.jsx)(e_,{title:r,value:m,onClick:()=>d(a),isSelected:c===a,isLoading:g,valueType:l,description:u},a)})}),(0,i.jsx)(eg,{data:(()=>{if(!x)return[];switch(c){case"totalVisits":default:return x.timeSeries.visitors.data;case"totalPageviews":return x.timeSeries.pageviews.data;case"pageviewsPerVisit":return x.timeSeries.pageviewsPerVisit.data;case"sessionDuration":return x.timeSeries.sessionDuration.data;case"bounceRate":return x.timeSeries.bounceRate.data}})(),valueType:ec[c].valueType,granularity:u.granularity,selectedMetric:c,isLoading:g,onRefresh:N}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,i.jsx)(eN,{data:null!==(s=null==x?void 0:x.lists.source.data)&&void 0!==s?s:[],type:"source",metric:"Visitors",isLoading:g}),(0,i.jsx)(eN,{data:null!==(a=null==x?void 0:x.lists.page.data)&&void 0!==a?a:[],type:"page",metric:"Visitors",color:"hsl(var(--brand-twilight))",isLoading:g}),(0,i.jsx)(eN,{data:null!==(n=null==x?void 0:x.lists.country.data)&&void 0!==n?n:[],type:"country",metric:"Visitors",color:"hsl(var(--brand-twilight))",isLoading:g}),(0,i.jsx)(eN,{data:null!==(r=null==x?void 0:x.lists.device.data)&&void 0!==r?r:[],type:"device",metric:"Visitors",isLoading:g})]})]})};var eD=s(22048),ez=s(58912),eI=s.n(ez),eO=s(27648),eP=s(46214),eT=s(14438),eL=s(76678),eR=s(60256),eF=s(93261),eZ=s(88391),eM=s(32165);let eq=e=>{let t="development"===e?"185.158.133.10":"185.158.133.1";return{domain:[{type:"A",host:"@",value:t,ttl:300},{type:"A",host:"www",value:t,ttl:300}],subDomain:[{type:"A",host:"{SUBDOMAIN}",value:t,ttl:300}]}};var eU=s(21288),eK=s(10531),eG=s(10441),eW=s(74225),eJ=s(71759),eV=e=>{let{project:t}=e,{userData:s}=(0,eR.SE)(),{data:a,refetch:n}=(0,h.a)(eG.c.domains({projectId:t.id})),r=(0,eJ.hO)(e=>e.projectWorkspace),[l,c]=(0,o.useState)(null);(0,o.useEffect)(()=>{(async()=>{let e=(0,g.SJ)();c(await e.get("/entri/token"))})(),eI().load()},[]);let d=(0,eZ.z)(eL.g),u=async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("free"===(null==r?void 0:r.plan)){d({childProps:{dialogDescription:"You need to be on a pro plan to connect a domain."}});return}if(!(null==t?void 0:t.url)){(0,g.SJ)().post("/projects/".concat(null==t?void 0:t.id,"/deployments"),{}).catch(e=>{eU.logging.error("Error publishing project",e),eT.Am.error("Error when publishing your project",{description:e.message}),eD.Tb(e)});try{await (0,en.G)({projectId:null==t?void 0:t.id})}catch(e){eU.logging.error("Error updating last deployment ID",e),eT.Am.error("Error when updating deployment cache. Please report this.",{description:e.message}),eD.Tb(e)}}if(null===l)return;let a={...l,dnsRecords:eq("production"),userId:null==t?void 0:t.id,monitor:!0,sellVersion:"v3",whiteLabel:{customCopy:{initialScreen:{title:{en:"Use your domain with Lovable"}}},theme:{primary:"#000000",secondary:"#000000",onSecondary:"#FFFFFF",headerBackground:"#000000"},logo:"https://lovable.dev/apple-icon.png",sell:{partnerName:"Lovable",partnerLogo:"https://lovable.dev/img/lovable-logo-text-nav.png",partnerUrl:"https://lovable.dev",overlayScreenHeight:"75%",flowTarget:"_blank"}}};try{"buy"===e?(a.prefilledDomain=(null==t?void 0:t.name)+".com",eI().purchaseDomain(a)):eI().showEntri(a)}catch(t){if(!s){let t=(0,g.SJ)();c(await t.get("/entri/token")),u(e,!0)}}eP.ZP.capture("domain_connecting_attempt",{mode:e})},p=async e=>{if(e.detail.success){let s=eT.Am.success("Connecting domain...",{description:"Hold on while we were mapping ".concat(e.detail.domain," to your project.")});try{let s=(0,g.SJ)();await s.post("/projects/".concat(null==t?void 0:t.id,"/domains"),{domain:e.detail.domain}),n(),eT.Am.success("Domain connected!",{description:"The domain ".concat(e.detail.domain," is now mapped to your project. It might take a few minutes to propagate.")}),eP.ZP.capture("domain_connected",{mode:"purchase"===e.detail.setupType?"buy":"connect"})}catch(e){eT.Am.info("Domain not connected",{description:"There was an error while connecting your domain. Please try again."}),eD.Tb(e)}eT.Am.dismiss(s)}};(0,o.useEffect)(()=>(window.addEventListener("onEntriClose",p,!1),()=>{window.removeEventListener("onEntriClose",p)}),[]);let x=(0,m.dl)(eK.P.CustomDomainsBuy)||!1;return(0,i.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,i.jsx)(eM.P,{label:"Connected Domains",description:"View or remove domains linked to your project.",justify:"end",children:(0,i.jsxs)("ul",{className:"flex flex-col gap-2",children:[(null==t?void 0:t.url)?(0,i.jsx)(eF.Z,{showRemove:!1,showIcon:!0,domain:{domain:(0,eW.P)(null==t?void 0:t.url),status:"active"}}):(0,i.jsx)("li",{className:"flex items-center",children:(0,i.jsxs)("span",{className:"flex-grow text-sm text-muted-foreground",title:"You have to publish your project for this domain to work",children:[null==t?void 0:t.name,".lovable.app"]})}),null==a?void 0:a.map((e,t)=>(0,i.jsx)(eF.Z,{domain:e,showRemove:!0,showIcon:!0,refetchDomains:n},t))]})}),(0,i.jsx)(eM.P,{label:"Add Existing Domain",description:"Connect a domain you already own.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(j.z,{variant:"outline",size:"sm",type:"button",onClick:()=>u("connect"),className:"whitespace-nowrap",children:a&&0===a.length?"Connect Domain":"Connect Another Domain"})}),x&&(0,i.jsx)(eM.P,{label:"Purchase New Domain",description:"Buy a new domain through Ionos.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(j.z,{variant:"outline",size:"sm",type:"button",onClick:()=>u("buy"),className:"whitespace-nowrap",children:"Buy Domain"})}),(0,i.jsx)("div",{className:"flex justify-end",children:(0,i.jsx)(j.z,{variant:"outline",size:"sm",type:"button",asChild:!0,children:(0,i.jsxs)(eO.default,{href:"https://docs.lovable.dev/tips-tricks/custom-domain",target:"_blank",children:["How Domains Work ",(0,i.jsx)(b.Z,{name:"arrow_outward",size:"small"})]})})})]})},eB=s(76818),eH=s(49284),eQ=()=>{let[e,t]=(0,o.useState)(""),s=(0,er.iZ)(e=>e.project);(0,o.useEffect)(()=>{(null==s?void 0:s.custom_instructions)&&t(s.custom_instructions)},[s]);let{updateProject:a}=(0,er.d2)(),n=async()=>{try{a({custom_instructions:e},{onSuccess:()=>{eP.ZP.capture(eH.SL.KNOWLEDGE.SAVED),eT.Am.success("Custom instructions updated",{description:"Your custom instructions have been saved successfully."})}}),l(!1)}catch(e){eT.Am.error("Error",{description:"Failed to update custom instructions. Please try again."})}},[r,l]=(0,o.useState)(!1),c=e.length,d=c>1e5;return(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"mb-2 flex flex-col gap-2",children:[(0,i.jsx)("p",{className:"text-base font-medium",children:"Instructions & Guidelines"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"Provide guidelines and context to improve your project’s edits. Use this space to:"}),(0,i.jsxs)("ul",{className:"list-disc pl-6 text-sm text-muted-foreground",children:[(0,i.jsx)("li",{children:"Set project-specific rules or best practices."}),(0,i.jsx)("li",{children:"Set coding style preferences (e.g. indentation, naming conventions)."}),(0,i.jsx)("li",{children:"Include external documentation or style guides."})]})]}),(0,i.jsx)(eB.g,{value:e,onChange:e=>{t(e.target.value),e.target.value!==(null==s?void 0:s.custom_instructions)?l(!0):l(!1)},placeholder:"Enter your instructions here...",className:(0,q.cn)("resize-none"),rows:14}),(0,i.jsx)("div",{className:(0,q.cn)("flex justify-end",r&&"mb-12"),children:(0,i.jsx)(j.z,{variant:"outline",size:"sm",type:"button",asChild:!0,children:(0,i.jsxs)(eO.default,{href:"https://docs.lovable.dev/features/knowledge",target:"_blank",children:["Get Inspiration ",(0,i.jsx)(b.Z,{name:"arrow_outward",size:"small"})]})})}),r&&(0,i.jsxs)(eM.j,{className:"justify-end gap-3",children:[d&&(0,i.jsxs)("div",{className:"mr-auto text-sm text-destructive-foreground",children:["Message is too long. Exceeded by ",c-1e5," ","characters."]}),(0,i.jsx)(j.z,{variant:"outline",onClick:()=>{t((null==s?void 0:s.custom_instructions)||""),l(!1)},children:"Cancel"}),(0,i.jsx)(j.z,{onClick:n,variant:"affirmative",disabled:d,children:"Save"})]})]})},eY=s(53647);let eX=e=>{let{project:t,onCategoryChange:s,disabled:a=!1}=e;return(0,i.jsx)(eM.P,{label:"Project Category",description:"Categorize your project to help others find it.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsxs)(eY.Ph,{defaultValue:(null==t?void 0:t.category)||"",onValueChange:e=>{s(e)},disabled:a,children:[(0,i.jsx)(eY.i4,{className:"w-[180px]",children:(0,i.jsx)(eY.ki,{placeholder:"Select category"})}),(0,i.jsxs)(eY.Bw,{children:[(0,i.jsx)(eY.Ql,{value:"internal_tools",children:"Internal Tools"}),(0,i.jsx)(eY.Ql,{value:"website",children:"Website"}),(0,i.jsx)(eY.Ql,{value:"personal",children:"Personal"}),(0,i.jsx)(eY.Ql,{value:"consumer_app",children:"Consumer App"}),(0,i.jsx)(eY.Ql,{value:"b2b_app",children:"B2B App"}),(0,i.jsx)(eY.Ql,{value:"prototype",children:"Prototype"})]})]})})};var e$=s(6812),e0=s(6512);let e1={Title:e=>{let{title:t,description:s,className:a,...n}=e;return(0,i.jsxs)("div",{className:(0,q.cn)("flex flex-col",a),...n,children:[(0,i.jsx)("h2",{children:t}),s&&(0,i.jsx)("p",{className:"text-muted-foreground",children:s})]})},Entry:e=>{let{label:t,value:s}=e;return(0,i.jsxs)("div",{className:"flex flex-col gap-1 text-sm",children:[(0,i.jsx)("p",{className:"font-medium",children:t}),"string"==typeof s?(0,i.jsx)("p",{className:"text-muted-foreground",children:s}):s]})},Separator:e0.Separator};var e2=s(12285),e5=s(59702),e4=s(79117),e3=s(78276),e6=s(1828),e7=s(56272),e8=s(2043),e9=s(46170),te=s(55157);let tt=e=>{let{visibility:t,setVisibility:s,redirectToSubscription:a=!1,workspacePlan:n,workspace:r,className:l,disabled:o,disabledTooltipContent:c}=e,d=(0,eR.DM)({workspacePlan:n}),u=(0,eR.dF)({workspacePlan:n}),{openSettings:m}=(0,te.r)(),p=(0,eZ.z)(eL.g),x=(0,y.Z)("md");return(0,i.jsx)(e3.b,{showTooltip:!!(o&&c),tooltipContent:(0,i.jsx)("p",{children:c}),children:(0,i.jsxs)(eY.Ph,{value:t,onValueChange:e=>{"private"!==e||u?"draft"!==e||d?s(e):a?m("billing"):p({childProps:{dialogDescription:"You need to be on a business plan to make your project personal."}}):a?m("billing"):p({childProps:{dialogDescription:"You need to be on a pro plan to make your project private."}})},disabled:o,children:[(0,i.jsx)(eY.i4,{className:(0,q.cn)("w-[180px] [&_.plan-badge]:hidden",l),children:(0,i.jsx)(eY.ki,{placeholder:"Select visibility",className:""})}),(0,i.jsxs)(eY.Bw,{align:x?"start":"end",children:[(0,i.jsx)(eY.Ql,{value:"public",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(b.Z,{name:"globe",size:"small"}),(0,i.jsx)("span",{children:"Public"})]})}),(0,i.jsx)(eY.Ql,{value:"private",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(b.Z,{name:"workspaces",size:"small"}),(0,i.jsx)("span",{children:"Workspace"}),r&&(0,i.jsx)(e7.y,{workspace:r,requiredPlanId:"pro",className:"plan-badge"})]})}),(0,i.jsx)(eY.Ql,{value:"draft",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(b.Z,{name:"draft",size:"small"}),(0,i.jsx)("span",{children:"Personal"}),r&&(0,i.jsx)(e7.y,{workspace:r,requiredPlanId:"biz",className:"plan-badge"})]})})]})]})})},ts=e=>{let{className:t,isAdmin:s}=e,a=(0,eJ.hO)(e=>e.projectWorkspace),n=(null==a?void 0:a.plan)||null,r=(0,er.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.visibility}),[l,c]=(0,o.useState)(void 0),{setVisibilityMutation:d}=(0,er.d2)(),{disableChangeVisibility:u,disabledTooltipContent:m}=(0,o.useMemo)(()=>s?{disableChangeVisibility:!1,disabledTooltipContent:void 0}:{disableChangeVisibility:!0,disabledTooltipContent:"You need to be an admin to change the visibility of your project."},[s]);return(0,o.useEffect)(()=>{r&&c(r)},[r]),(0,i.jsx)(tt,{disabled:u||d.isPending,disabledTooltipContent:m,workspacePlan:n,workspace:a,visibility:l||r||void 0,setVisibility:e=>{c(e),d.mutateAsync(e)},className:t})},ta=e=>{var t;let{isPaidUser:s,className:a}=e,{setBadgeVisibility:n}=(0,er.d2)(),r=(0,er.iZ)(e=>e.project),l=(0,eZ.z)(eL.g),[c,d]=(0,o.useState)(null!==(t=null==r?void 0:r.hide_badge)&&void 0!==t&&t);return(0,i.jsx)(e6.r,{checked:c,onCheckedChange:e=>{if(!s){l({childProps:{dialogDescription:'You need to be on a pro plan to hide the "Edit with Lovable" badge.'}});return}n(e),d(e)},disabled:!1,className:(0,q.cn)("",a)})};var tn=s(21770),tr=s(64040);let tl=e=>{let{projectId:t,initialFeatured:s,className:a}=e,[n,r]=(0,o.useState)(s),l=(0,tn.D)({mutationFn:e=>{let{featured:s}=e;return(0,g.SJ)().put("/projects/".concat(t,"/featured"),{featured:s})},onSuccess:(e,t)=>{let{featured:s}=t;r(s),eT.Am.success("Featured status updated",{description:"Project is now ".concat(s?"featured":"not featured",".")})},onError:e=>{(0,tr.Eo)(e)}});return(0,i.jsx)(e6.r,{disabled:l.isPending,checked:n,onCheckedChange:e=>{l.mutate({featured:e})},className:(0,q.cn)("",a)})},ti=e=>(null==e?void 0:e.seconds)?(0,z.WU)(new Date(1e3*e.seconds),"yyyy-MM-dd HH:mm:ss"):void 0;var to=e=>{var t,s,a,n;let{projectId:r}=e,{isProjectAdmin:l,canEdit:c}=(0,e8.t)(),[d,u]=(0,o.useState)(!1),[m,p]=(0,o.useState)(!1),x=(0,eJ.hO)(e=>e.projectWorkspace),h=(0,eJ.hO)(e=>{var t;return(null===(t=e.projectWorkspace)||void 0===t?void 0:t.plan)||null}),g=(0,er.iZ)(e=>e.project),{userData:f}=(0,eR.SE)(),v=!!(null==g?void 0:g.is_supabase_enabled)||!!(null==g?void 0:g.supabase_project_config),b=c||!v,{updateProject:y,setIsRemixDialogOpen:w}=(0,er.d2)(),N=(0,et.NL)(),_=(0,e9.Qx)(null!=h?h:void 0)||(0,e9.gG)(null!=h?h:void 0),k=(0,eZ.z)(eL.g),S=async e=>{if(_){if((null==g?void 0:g.visibility)==="draft"&&e){eT.Am.error("Personal projects cannot be used as templates",{description:"Change the project visibility to Public or Workspace to use it as a template."});return}y({is_template:e},{onSuccess:()=>{N.invalidateQueries({queryKey:ea.E.templates((null==x?void 0:x.id)||"")})}})}else{k({childProps:{dialogDescription:"You need to be on a business plan to use templates."}});return}},C=(null==g?void 0:g.is_analytics_disabled)||!1,E=async e=>{y({is_analytics_disabled:e},{onSuccess:()=>{(0,en.G)({projectId:r}).catch(e=>{console.error("Error updating deployment ID",e)})}})},A=(0,eZ.z)(eL.g),D=(0,e$.Q)(e=>e.workspaces).length>1,z=(0,e9.XB)(null!=h?h:void 0),I=(0,o.useMemo)(()=>(0,i.jsx)("span",{onClick:()=>{A({childProps:{dialogDescription:"Upgrade to Pro to unlock this feature."}})},className:"cursor-pointer text-sm text-muted-foreground underline transition-opacity duration-150 ease-in-out hover:opacity-75",children:"Upgrade your plan"}),[A]);return(0,i.jsxs)("div",{className:"flex w-full flex-col gap-6",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,i.jsx)("p",{className:"col-span-full font-medium",children:"Overview"}),(0,i.jsx)(e1.Entry,{label:"Project name",value:null==g?void 0:g.name}),(0,i.jsx)(e1.Entry,{label:"Owner",value:(null==g?void 0:g.created_by)&&(0,i.jsxs)(eO.default,{className:"break-words text-sm text-muted-foreground underline",target:"_blank",href:"/@".concat(g.created_by),children:["@",g.created_by]})}),(0,i.jsx)(e1.Entry,{label:"Created at",value:ti(null==g?void 0:g.created_at)}),(null==g?void 0:null===(t=g.creation_options)||void 0===t?void 0:t.tech_stack)&&(0,i.jsx)(e1.Entry,{label:"Tech stack",value:null==g?void 0:null===(s=g.creation_options)||void 0===s?void 0:s.tech_stack}),(0,i.jsx)(e1.Entry,{label:"Messages count",value:(null==g?void 0:null===(a=g.user_message_count)||void 0===a?void 0:a.toString())||"0"}),(0,i.jsx)(e1.Entry,{label:"AI Edits count",value:(null==g?void 0:null===(n=g.edit_count)||void 0===n?void 0:n.toString())||"0"})]}),(0,i.jsx)(e1.Separator,{}),(0,i.jsx)(eM.P,{label:"Project Visibility",description:z?"Keep your project hidden and prevent others from remixing it.":(0,i.jsxs)("p",{children:[I," to keep your project hidden and prevent others from remixing it."]}),mobileLayout:"vertical",justify:"end",customBadge:x&&(0,i.jsx)(e7.y,{workspace:x,requiredPlanId:"pro"}),children:(0,i.jsx)(ts,{isAdmin:l})}),g&&(0,i.jsx)(eX,{project:g,onCategoryChange:e=>y({category:e}),disabled:!c}),(0,i.jsx)(eM.P,{label:'Hide "Lovable" Badge',description:z?'Remove the "Edit with Lovable" badge from your published work.':(0,i.jsxs)("p",{children:[I,' to remove the \'"Edit with Lovable" badge from your published work.']}),mobileLayout:"horizontal",justify:"end",customBadge:x&&(0,i.jsx)(e7.y,{workspace:x,requiredPlanId:"pro"}),children:(0,i.jsx)(ta,{isPaidUser:z})}),g&&(null==f?void 0:f.is_admin)&&(0,i.jsx)(eM.P,{label:"Feature Project",description:"Highlight this project on the homepage.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(tl,{projectId:r,initialFeatured:!!g.featured})}),_&&(0,i.jsx)(eM.P,{label:"Use as a Template",description:(0,i.jsxs)("p",{children:["Use this project as a template in"," ",(0,i.jsx)("span",{className:"font-medium",children:(null==x?void 0:x.name)?x.name:"your workspace"})," ","to reference when starting new projects."]}),mobileLayout:"horizontal",justify:"end",customBadge:x&&(0,i.jsx)(e7.y,{workspace:x,requiredPlanId:"biz"}),children:(0,i.jsx)(e3.b,{showTooltip:(null==g?void 0:g.visibility)==="draft",tooltipContent:"Change project visibility to Public or Workspace to use it as a template.",delayDuration:0,children:(0,i.jsx)(e6.r,{checked:(null==g?void 0:g.is_template)||!1,onCheckedChange:S,disabled:(null==g?void 0:g.visibility)==="draft"})})}),g&&c&&(0,i.jsx)(eM.P,{label:"Rename Project",description:"Update your project's title.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(j.z,{onClick:()=>u(!0),children:"Rename"})}),g&&(0,i.jsx)(eM.P,{label:"Remix Project",description:"Duplicate this app in a new project.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsxs)(j.z,{onClick:()=>w(!0),disabled:!b,children:["Remix",!b&&(0,i.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:"Unavailable for projects connected to Supabase"})]})}),l&&D&&(0,i.jsx)(eM.P,{label:"Transfer",description:"Move this project to a different workspace.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(e2.O,{projectId:r,currentWorkspaceId:null==g?void 0:g.workspace_id})}),g&&l&&(0,i.jsx)(eM.P,{label:"Disable Analytics",description:"Disable collecting analytics data for this project.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(e6.r,{checked:C,onCheckedChange:E})}),g&&l&&(0,i.jsx)(eM.P,{label:"Delete Project",description:"Permanently delete this project.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(j.z,{variant:"destructive",onClick:()=>p(!0),children:"Delete"})}),g&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e4.i,{project:g,isOpen:d,onClose:()=>u(!1)}),(0,i.jsx)(e5.p,{project:g,isOpen:m,onClose:()=>p(!1)})]})]})},tc=s(49027),td=s(95098),tu=s(26110),tm=s(4216);let tp=e=>{let{shouldScaleBackground:t=!0,...s}=e;return(0,i.jsx)(tm.dy.Root,{shouldScaleBackground:t,...s})};tp.displayName="Drawer",tm.dy.Trigger;let tx=tm.dy.Portal;tm.dy.Close;let th=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(tm.dy.Overlay,{ref:t,className:(0,q.cn)("fixed inset-0 z-[10000] bg-black/80",s),...a})});th.displayName=tm.dy.Overlay.displayName;let tg=o.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,i.jsxs)(tx,{children:[(0,i.jsx)(th,{}),(0,i.jsxs)(tm.dy.Content,{ref:t,className:(0,q.cn)("fixed inset-x-0 bottom-0 z-[10000] mt-24 flex h-auto flex-col rounded-t-[24px] border bg-background",s),...n,children:[(0,i.jsx)("div",{className:"mx-auto mt-4 h-1.5 w-[60px] rounded-full bg-muted"}),a]})]})});tg.displayName="DrawerContent";let tf=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(tm.dy.Title,{ref:t,className:(0,q.cn)("text-lg font-medium leading-none tracking-tight",s),...a})});tf.displayName=tm.dy.Title.displayName;let tj=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(tm.dy.Description,{ref:t,className:(0,q.cn)("text-sm text-muted-foreground",s),...a})});tj.displayName=tm.dy.Description.displayName;let tv=e=>{let{children:t,open:s,onOpenChange:a}=e;return(0,y.Z)("md")?(0,i.jsx)(tp,{open:s,onOpenChange:a,children:(0,i.jsx)(ty,{children:t})}):(0,i.jsx)(tu.Vq,{open:s,onOpenChange:a,children:(0,i.jsx)(tb,{children:t})})},tb=e=>{let{children:t,className:s,...a}=e;return(0,i.jsxs)(tu.cZ,{hideCloseButton:!0,className:(0,q.cn)("flex h-[90dvh] max-h-[640px] w-[95dvw] flex-1 flex-col items-start px-0 py-0",s),size:"xl",...a,"aria-describedby":"Settings dialog",children:[(0,i.jsxs)(td.TX,{children:[(0,i.jsx)(tu.Be,{children:"Settings dialog"}),(0,i.jsx)(tc.$N,{children:"Settings dialog"})]}),(0,i.jsx)(tc.GG,{asChild:!0,children:(0,i.jsx)(j.z,{variant:"ghost",size:"icon-sm",className:"absolute right-2 top-2 z-10 hover:bg-transparent hover:opacity-75",children:(0,i.jsx)(b.Z,{name:"close",size:"small"})})}),t]})},ty=e=>{let{children:t,className:s,...a}=e;return(0,i.jsxs)(tg,{className:(0,q.cn)("flex h-[90dvh] flex-col items-start px-0 py-0",s),...a,children:[(0,i.jsxs)(td.TX,{children:[(0,i.jsx)(tj,{children:"Settings drawer"}),(0,i.jsx)(tf,{children:"Settings drawer"})]}),t]})};var tw=s(5103),tN=s(67817),t_=s(3813),tk=s(69084),tS=s(41135),tC=s(26438),tE=s(32429),tA=s(23664),tD=s(51408);function tz(e){let{title:t,description:s,featureKey:a,checked:n}=e,{authUser:r}=(0,d.Eu)(),l=(0,tA.U0)(),o=(0,et.NL)(),{mutate:c}=(0,tn.D)({mutationFn:async e=>{let t=(0,g.SJ)();return await t.patch("/users/".concat(null==r?void 0:r.uid,"/experimental-features"),{feature:a,enabled:e})},onMutate:e=>{o.cancelQueries({queryKey:tD.V.experimentalFeatures({user:r}).queryKey});let t=o.getQueryData(tD.V.experimentalFeatures({user:r}).queryKey);return o.setQueryData(tD.V.experimentalFeatures({user:r}).queryKey,t=>t?{...t,[a]:e}:null),{previousFeatures:t}},onSuccess:(e,t)=>{l.capture("lab-feature-toggled",{feature:a,checked:n})},onError:(e,t,s)=>{o.setQueryData(tD.V.experimentalFeatures({user:r}).queryKey,e=>{var t;return e?{...e,[a]:null==s?void 0:null===(t=s.previousFeatures)||void 0===t?void 0:t[a]}:null}),(0,tr.Eo)(e)}});return(0,i.jsx)(eM.P,{label:t,description:s,mobileLayout:"horizontal",children:(0,i.jsx)(e6.r,{checked:n,onCheckedChange:c,disabled:!r,className:"ml-auto"})})}let tI=()=>{let{isLoading:e,features:t}=(0,tE.G)(),s=(0,t_.so)(),a=(0,t_.zq)(),{isAgentModeDefault:n,setAgentMode:r}=(0,tC.v)();return(0,i.jsx)(p.tM,{value:"labs",title:"Labs",description:"These are experimental features, that might be modified or removed.",docsLink:"https://docs.lovable.dev/features/labs",children:e?(0,i.jsx)(X.O,{className:"h-10 w-full"}):(0,i.jsxs)(i.Fragment,{children:[a&&(0,i.jsx)(eM.P,{label:"Legacy Mode",description:(0,i.jsxs)(i.Fragment,{children:["Disables advanced agent features and adaptive pricing."," ",(0,i.jsx)(eO.default,{href:"https://lovable.dev/blog/agent",target:"_blank",className:"inline-flex items-center gap-1 underline hover:text-foreground",children:(0,i.jsx)("span",{children:"Learn more"})})]}),mobileLayout:"horizontal",children:(0,i.jsx)(e6.r,{checked:!n,onCheckedChange:e=>{r(!e)},className:"ml-auto"})}),(0,i.jsx)(tz,{title:"GitHub Branch Switching",description:"Select the branch to make edits to in your GitHub repository.",featureKey:"git_branch_switching",checked:!!(null==t?void 0:t.git_branch_switching)}),s&&(0,i.jsx)(tz,{title:"Lovable Backend",description:(0,i.jsxs)("p",{children:["Build full-stack apps natively in Lovable — no Supabase account needed, everything runs inside Lovable. Try it by selecting"," ",(0,i.jsx)("span",{className:"font-medium",children:"Backend → Lovable (Labs)"})," ","when creating a project."]}),featureKey:"lovable_backend",checked:!!(null==t?void 0:t.lovable_backend)})]})})};var tO=s(99376),tP=s(92825),tT=s(79858);let tL=e=>{var t;let{isInteractive:s=!1,className:a,authUser:n,userData:r,...l}=e,o=(0,tT.Q)(null==r?void 0:r.id),c=(null==r?void 0:null===(t=r.attributes)||void 0===t?void 0:t.display_name)||(null==n?void 0:n.email)||r.username;return(0,i.jsx)(tP.N,{name:c,isInteractive:s,photoSrc:void 0,userColor:o,className:a,...l})},tR=e=>{let{userData:t,authUser:s}=e;return(0,i.jsx)(eM.P,{label:"Your Avatar",description:"Your avatar is automatically generated based on your account.",mobileLayout:"horizontal",children:(0,i.jsx)(tL,{className:"ml-auto h-10 w-10 md:ml-0",userData:t,authUser:s})})};var tF=s(2124);let tZ=e=>{var t;let{isLast:s}=e,{userData:a}=(0,eR.SE)(),n=null!==(t=null==a?void 0:a.default_project_visibility)&&void 0!==t?t:void 0,[r,l]=(0,o.useState)(n);(0,o.useEffect)(()=>{l(n)},[n]);let c=(0,tn.D)({mutationFn:async e=>(0,g.SJ)().put("/user/".concat(a.id),{default_project_visibility:e}),onSuccess:(e,t)=>{l(t),eT.Am.success("Default project visibility updated",{description:"Default project visibility is now ".concat(t)})},onError:e=>{(0,tr.Eo)(e),l(n)}});return(0,i.jsx)(eM.P,{label:"Default Project Visibility",description:"Set whether new projects are publicly accessible by default. You can always change visibility settings later per project.",isLast:s,children:a?(0,i.jsx)(tF.F,{workspacePlan:null,visibility:r,setVisibility:e=>{l(e),c.mutate(e)},disabled:c.isPending,redirectToSubscription:!0}):(0,i.jsx)(X.O,{className:"h-10 w-full"})})};var tM=s(95186);let tq=e=>{var t;let{authUser:s}=e;return(0,i.jsx)(eM.P,{label:"Email",description:"Your email address associated with your account.",children:(0,i.jsx)(tM.I,{value:null!==(t=null==s?void 0:s.email)&&void 0!==t?t:"",disabled:!0,className:"w-full",placeholder:"No email available"})})};var tU=s(13590),tK=s(29501),tG=s(91351),tW=s(19060),tJ=s(15681);let tV=tG.Ry({display_name:tG.Z_().optional(),bio:tG.Z_().optional(),location:tG.Z_().optional(),link:tG.Z_().optional(),hide_profile_pictures:tG.O7().optional()}),tB=e=>{var t,s,a,n,r,l,o,c,d,u;let{userData:m,avatarExists:p}=e,x=(0,tK.cI)({defaultValues:{display_name:null!==(l=null===(t=m.attributes)||void 0===t?void 0:t.display_name)&&void 0!==l?l:"",bio:null!==(o=null===(s=m.attributes)||void 0===s?void 0:s.bio)&&void 0!==o?o:"",location:null!==(c=null===(a=m.attributes)||void 0===a?void 0:a.location)&&void 0!==c?c:"",link:null!==(d=null===(n=m.attributes)||void 0===n?void 0:n.link)&&void 0!==d?d:"",hide_profile_pictures:null!==(u=null===(r=m.attributes)||void 0===r?void 0:r.hide_profile_pictures)&&void 0!==u&&u},resolver:(0,tU.F)(tV)}),h=(0,et.NL)(),{mutate:f,isPending:v}=(0,tn.D)({mutationFn:async e=>(0,g.SJ)().put("/user/".concat(m.id),{attributes:e}),onSuccess:(e,t)=>{eT.Am.success("Success",{description:"Account settings updated successfully"}),x.reset(t),h.invalidateQueries({queryKey:ea.E.all})},onError:e=>{(0,tr.Eo)(e)}});return(0,i.jsx)(tJ.l0,{...x,children:(0,i.jsxs)("form",{className:"flex w-full flex-col gap-6",onSubmit:x.handleSubmit(e=>{let t=x.formState.defaultValues,s=Object.keys(e).filter(s=>e[s]!==(null==t?void 0:t[s]));eP.ZP.capture(eH.gg.SETTINGS_UPDATED,{changedFields:s,fieldsCount:s.length,hasDisplayName:!!e.display_name,hasBio:!!e.bio,hasLocation:!!e.location,hasLink:!!e.link,hideProfilePictures:!!e.hide_profile_pictures}),f(e)}),children:[(0,i.jsx)(eM.P,{label:"Name",description:"Your full name, as visible to others.",children:(0,i.jsx)(tJ.Wi,{control:x.control,name:"display_name",render:e=>{let{field:t}=e;return(0,i.jsxs)(tJ.xJ,{className:"w-full",children:[(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(tM.I,{...t})}),(0,i.jsx)(tJ.zG,{})]})}})}),(0,i.jsx)(eM.P,{label:"Description",description:"A short description of yourself or your work.",children:(0,i.jsx)(tJ.Wi,{control:x.control,name:"bio",render:e=>{let{field:t}=e;return(0,i.jsxs)(tJ.xJ,{className:"w-full",children:[(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(eB.g,{className:"resize-none border bg-background",rows:3,...t})}),(0,i.jsx)(tJ.zG,{})]})}})}),(0,i.jsx)(eM.P,{label:"Location",description:"Where you're based.",children:(0,i.jsx)(tJ.Wi,{control:x.control,name:"location",render:e=>{let{field:t}=e;return(0,i.jsxs)(tJ.xJ,{className:"w-full",children:[(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(tM.I,{...t})}),(0,i.jsx)(tJ.zG,{})]})}})}),(0,i.jsx)(eM.P,{label:"Link",description:"Add a link to your personal website or portfolio.",children:(0,i.jsx)(tJ.Wi,{control:x.control,name:"link",render:e=>{let{field:t}=e;return(0,i.jsxs)(tJ.xJ,{className:"w-full",children:[(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(tM.I,{...t})}),(0,i.jsx)(tJ.zG,{})]})}})}),p&&(0,i.jsx)(eM.P,{label:"Hide Profile Picture",mobileLayout:"horizontal",className:"last:border-b",children:(0,i.jsx)(tJ.Wi,{control:x.control,name:"hide_profile_pictures",render:e=>{let{field:t}=e;return(0,i.jsxs)(tJ.xJ,{className:"ml-auto flex flex-row items-center space-x-2 space-y-0",children:[(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(tW.X,{checked:t.value,onCheckedChange:t.onChange})}),(0,i.jsx)(tJ.zG,{})]})}})}),x.formState.isDirty&&(0,i.jsxs)(eM.j,{className:"justify-end gap-2",children:[(0,i.jsx)(j.z,{type:"button",variant:"secondary",onClick:()=>{eP.ZP.capture(eH.gg.SETTINGS_CANCELLED),x.reset()},children:"Cancel"}),(0,i.jsx)(j.z,{type:"submit",loading:v,variant:"affirmative",children:"Update"})]})]})})},tH=tG.Ry({username:tG.Z_().min(3,{message:"Username must be at least 3 characters"}).max(16,{message:"Username must be at most 16 characters"}).regex(/^[a-z]/,{message:"Username must start with a letter"}).regex(/^[a-z0-9_]+$/,{message:"Username can only contain lowercase letters, numbers, and underscores"})}),tQ=e=>{let t=(0,tK.cI)({resolver:(0,tU.F)(tH)}),s=(0,tn.D)({mutationFn:async e=>{let{username:t}=e;return(0,g.SJ)().put("/user/username",{username:t})},onSuccess:()=>{var t;eT.Am.success("Success",{description:"Username updated successfully"}),null===(t=e.onOpenChange)||void 0===t||t.call(e,!1)},onError:e=>{(0,tr.Eo)(e)}});return(0,i.jsx)(tu.Vq,{...e,children:(0,i.jsxs)(tu.cZ,{children:[(0,i.jsx)(tu.$N,{children:"Set Username"}),(0,i.jsx)(tu.Be,{children:"Please enter your desired username. You can not change your username once you have set it."}),(0,i.jsx)("form",{onSubmit:t.handleSubmit(e=>{s.mutate(e)}),children:(0,i.jsxs)(tJ.l0,{...t,children:[(0,i.jsx)(tJ.Wi,{control:t.control,name:"username",render:e=>{let{field:t}=e;return(0,i.jsxs)(tJ.xJ,{className:"w-full",children:[(0,i.jsx)(tJ.lX,{children:"Username"}),(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(tM.I,{...t})}),(0,i.jsx)(tJ.zG,{})]})}}),(0,i.jsx)(tu.cN,{className:"mt-4",children:(0,i.jsx)(j.z,{loading:s.isPending,type:"submit",children:"Save"})})]})})]})})},tY=e=>{let{username:t,userId:s}=e,[a,n]=(0,o.useState)(!1),r=!!s&&t===s;return(0,i.jsxs)(eM.P,{label:"Username",description:"Your public identifier and profile URL.",children:[(0,i.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,i.jsx)("div",{className:"flex items-center justify-start gap-2",children:(0,i.jsx)(tM.I,{placeholder:"Username",className:"w-full",value:null!=t?t:"",disabled:!r,onClick:()=>{t&&n(!0)}})}),(0,i.jsxs)("p",{className:"flex items-center gap-1 break-all text-sm text-muted-foreground underline transition-colors duration-150 ease-in-out hover:text-muted-foreground/80",children:[t?(0,i.jsxs)(eO.default,{className:"",href:"".concat(window.location.origin,"/@").concat(t),target:"_blank",rel:"noreferrer",children:["lovable.dev/@",t]}):"lovable.dev/@<username>",(0,i.jsx)(b.Z,{name:"arrow_outward",size:"small"})]})]}),(0,i.jsx)(tQ,{open:a,onOpenChange:n})]})};var tX=s(64975);let t$=e=>{let{data:t={}}=(0,h.a)({...tD.V.contributions({userData:e}),enabled:!!(null==e?void 0:e.username)});return new Map(Object.entries(t))},t0=Math.ceil(365/7),t1=e=>{let{}=e,{userData:t}=(0,eR.SE)(),s=t$(t),a=(0,o.useMemo)(()=>{let e=new Date,t=[];for(let a=0;a<t0;a++){let n=[];for(let t=0;t<7;t++){let r=(0,tX.k)(e,(t0-a-1)*7+(7-t-1)),l=(0,z.WU)(r,"yyyy-MM-dd"),i=s.get(l)||0;n.push({date:r,count:i})}t.push(n)}return t},[s]),n=(0,o.useRef)(null),[r,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=()=>{let e=n.current;e&&(l(e.scrollLeft>0),d(e.scrollLeft+e.clientWidth<e.scrollWidth-1))},t=n.current;if(t)return t.scrollLeft=t.scrollWidth,l(t.scrollLeft>0),d(t.scrollWidth>t.clientWidth&&t.scrollLeft+t.clientWidth<t.scrollWidth-1),t.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{t.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[]);let u=(0,o.useMemo)(()=>Math.max(...Array.from(s.values()),0),[s]),m=(0,o.useMemo)(()=>e=>{if(0===e||0===u)return"bg-muted";let t=e/u;return t<=.25?"bg-muted-hover":t<=.5?"bg-muted-active":t<=.75?"bg-muted-foreground":"bg-foreground"},[u]);return(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)("p",{className:"text-base font-medium",children:"Your Activity"}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{ref:n,className:"overflow-x-auto pb-2 scrollbar-thin scrollbar-track-background scrollbar-thumb-background",children:(0,i.jsx)("div",{className:"inline-block min-w-[600px] max-w-[760px] rounded-xl border border-input bg-card p-2",children:(0,i.jsx)("div",{className:"flex gap-[2px]",children:a.map((e,t)=>(0,i.jsx)("div",{className:"flex flex-col gap-[2px]",children:e.map((e,t)=>(0,i.jsxs)(ep.u,{children:[(0,i.jsx)(ep.aJ,{asChild:!0,children:(0,i.jsx)("div",{className:(0,q.cn)("size-2.5 rounded-[2px] transition-colors duration-200",m(e.count))})}),(0,i.jsxs)(ep._v,{side:"top",align:"center",children:["".concat((0,z.WU)(e.date,"MMM d, yyyy"),": ").concat(e.count>0?e.count:"No"," activity"),(0,i.jsx)(ep.Ce,{})]})]},t))},t))})})}),r&&(0,i.jsx)("div",{className:"pointer-events-none absolute left-0 top-0 h-full w-6 bg-gradient-to-r from-background via-background/80 to-transparent"}),c&&(0,i.jsx)("div",{className:"pointer-events-none absolute right-0 top-0 h-full w-6 bg-gradient-to-l from-background via-background/80 to-transparent"})]})]})},t2=()=>{let{userData:e}=(0,eR.SE)();return(0,tn.D)({mutationFn:async t=>{let s=(0,g.SJ)();return await s.put("/user/".concat(e.id),{sound_effect_active:t})},onSuccess:(e,t)=>{eT.Am.success("Sound effect settings updated",{description:"Sound effects will now play ".concat("firstgen"===t?"on first generation":"always"===t?"on all generations":"never")})},onError:e=>{(0,tr.Eo)(e)}})};var t5=s(26815),t4=s(74991);let t3=e=>{let{active:t,setActive:s,onClick:a,disabled:n}=e;return(0,i.jsxs)(t4.E,{className:"flex w-full flex-col gap-4",disabled:n,defaultValue:t,onValueChange:e=>{s(e)},children:[(0,i.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,i.jsx)(t4.m,{value:"firstgen",id:"firstgen",onClick:()=>{null==a||a()}}),(0,i.jsx)(t5.Label,{htmlFor:"firstgen",className:"flex w-full cursor-pointer flex-col gap-2",children:(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,i.jsx)(b.Z,{size:"small",name:"stacked_line_chart",className:"text-muted-foreground"}),"First Generation"]})})]}),(0,i.jsxs)("div",{className:"flex w-full items-start space-x-2",children:[(0,i.jsx)(t4.m,{value:"always",id:"always",onClick:()=>{null==a||a()}}),(0,i.jsx)(t5.Label,{htmlFor:"always",className:"flex w-full cursor-pointer flex-col gap-2",children:(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,i.jsx)(b.Z,{size:"small",name:"volume_up",className:"text-muted-foreground"}),"Always"]})})]}),(0,i.jsxs)("div",{className:"flex w-full items-start space-x-2",children:[(0,i.jsx)(t4.m,{value:"never",id:"never",onClick:()=>{null==a||a()}}),(0,i.jsx)(t5.Label,{htmlFor:"never",className:"flex w-full cursor-pointer flex-col gap-2",children:(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,i.jsx)(b.Z,{size:"small",name:"volume_off",className:"text-muted-foreground"}),"Never"]})})]})]})},t6=()=>{var e;let{userData:t}=(0,eR.SE)(),s=t2(),a=null!==(e=null==t?void 0:t.sound_effect_active)&&void 0!==e?e:"firstgen";return(0,i.jsx)(eM.P,{label:"Generation complete sound",description:"Plays a satisfying sound notification when a generation is finished.",isLast:!0,children:t?(0,i.jsx)(t3,{active:a,setActive:e=>{s.mutate(e)}}):(0,i.jsx)(X.O,{className:"h-10 w-full"})})},t7=()=>{let{userData:e}=(0,eR.SE)();return(0,tn.D)({mutationFn:async t=>(0,g.SJ)().put("/user/".concat(e.id),{suggestions_enabled:t}),onSuccess:(e,t)=>{eT.Am.success("Suggestions settings updated",{description:"Suggestions are now ".concat(t?"enabled":"disabled")})},onError:e=>{(0,tr.Eo)(e)}})},t8=()=>{let{userData:e}=(0,eR.SE)(),t=t7(),s=(null==e?void 0:e.suggestions_enabled)===!0;return(0,i.jsx)(eM.P,{label:"Chat Suggestions",description:"Show helpful suggestions in the chat interface to enhance your experience.",mobileLayout:"horizontal",isLast:!1,children:e?(0,i.jsx)(e6.r,{checked:s,onCheckedChange:e=>{t.mutate(e)},className:"ml-auto"}):(0,i.jsx)(X.O,{className:"h-5 w-9"})})};var t9=()=>{var e;let{authUser:t}=(0,d.Eu)(),{userData:s}=(0,eR.SE)(),a=(0,u.aS)(e=>{var t;return!!(null===(t=e.currentWorkspace)||void 0===t?void 0:t.id)}),n=null!==(e=(0,m.dl)(eK.P.GithubContribution))&&void 0!==e&&e,r=(0,t_.aI)(),l=(0,tO.useRouter)();return s?(0,i.jsxs)(p.tM,{value:"account",title:"Account Settings",description:"Personalize how others see and interact with you on Lovable.",children:[n&&(0,i.jsx)(t1,{}),(0,i.jsx)(tR,{userData:s,authUser:t}),(0,i.jsx)(tY,{userId:s.id,username:s.username}),(0,i.jsx)(tq,{authUser:t}),(0,i.jsx)(tB,{userData:s,avatarExists:!!(null==t?void 0:t.photoURL)}),!a&&(0,i.jsx)(tZ,{isLast:!1}),r&&(0,i.jsx)(t8,{}),(0,i.jsx)(t6,{}),(0,i.jsx)(eM.P,{label:"Link SSO",description:"Connect your account to company SSO.",children:(0,i.jsx)(j.z,{variant:"outline",onClick:()=>l.push("/sso-login/"),children:"Link SSO"})}),(0,i.jsx)("div",{className:"mb-12"})]}):null},se=s(4310),st=s(33910),ss=s(89668);let sa=e=>{var t,s,a,n;let{userData:r}=(0,eR.SE)(),l=null==r?void 0:null===(t=r.github)||void 0===t?void 0:t.encrypted_access_token,i=null==r?void 0:null===(s=r.github)||void 0===s?void 0:s.encrypted_access_token_v3,c=(0,o.useRef)({v2:l,v3:i}),d=(0,h.a)(ss.t.workspaceGithubInstallations({workspaceId:e}));return(0,o.useEffect)(()=>{(c.current.v2!==l||c.current.v3!==i)&&(d.refetch().catch(()=>{}),c.current={v2:l,v3:i})},[l,i,d]),{installations:null===(a=d.data)||void 0===a?void 0:a.installations,requiredAction:null===(n=d.data)||void 0===n?void 0:n.required_action}};var sn=s(81677);let sr=e=>{let{isLoading:t,hasAccessToken:s,hasValidAccessToken:a,githubUsername:n,onGithubConnected:r,isWorkspaceAdmin:l}=e;return(0,o.useEffect)(()=>{let e=e=>{"githubAppAuthenticated"===e.data&&r()};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[r]),(0,i.jsx)(eM.P,{label:"Connected Account",description:"Add your GitHub account to manage connected organizations.",justify:"end",badges:["admin"],children:t?(0,i.jsx)(X.O,{className:"h-7 w-32"}):s&&a?(0,i.jsxs)(j.z,{disabled:!0,variant:"outline",size:"sm",children:[(0,i.jsx)(tS.xR.GitHub,{className:"h-4 w-4"}),null!=n?n:"Connected"]}):(0,i.jsx)(sl,{isWorkspaceAdmin:l})})},sl=e=>{let{isWorkspaceAdmin:t}=e;return(0,i.jsxs)(j.z,{variant:"default",size:"sm",onClick:sn.Hp,disabled:!t,children:[(0,i.jsx)(tS.xR.GitHub,{className:"h-4 w-4"}),"Connect GitHub"]})};var si=s(57054),so=s(39484);function sc(e){let{projectId:t,main_branch:s,searchTerm:a,setSearchTerm:n,switchBranchMutation:r}=e,{data:l,isPending:c,error:d}=(0,h.a)({queryKey:ea.iZ.branches(t),queryFn:async()=>(0,g.SJ)().get("/projects/".concat(t,"/github/branches"))}),u=(0,o.useMemo)(()=>null==l?void 0:l.some(e=>e.name===s),[l,s]),{branchesWithCurrentFirst:m,filteredBranches:p}=(0,o.useMemo)(()=>{if(!l)return{branchesWithCurrentFirst:[],filteredBranches:[]};let e=l.filter(e=>e.name.toLowerCase().includes(a.toLowerCase())),t=e.find(e=>e.name===s);return t?{branchesWithCurrentFirst:[t,...e.filter(e=>e.name!==s)],filteredBranches:e}:{branchesWithCurrentFirst:e,filteredBranches:e}},[l,s,a]);return(0,i.jsxs)("div",{className:"relative flex flex-col gap-3 p-4",children:[(0,i.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,i.jsx)("h4",{children:"Switch or create branch"}),(0,i.jsx)(si.xp,{className:"absolute right-2 top-2",asChild:!0,children:(0,i.jsx)(j.z,{variant:"ghost",size:"icon-sm",children:(0,i.jsx)(b.Z,{name:"close",size:"small"})})})]}),(0,i.jsx)("div",{children:c?(0,i.jsx)(so.T,{text:"Loading branches from GitHub..."}):d?(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm text-destructive-primary",children:[(0,i.jsx)(b.Z,{name:"warning_fill",size:"small"}),d.message]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"",children:(0,i.jsx)(tM.I,{type:"text",placeholder:"Find or create a branch...",value:a,onChange:e=>n(e.target.value)})}),(0,i.jsxs)("div",{className:"branches-list flex max-h-[40vh] flex-col gap-2 overflow-y-auto pt-2",children:[m.map(e=>(0,i.jsxs)(j.z,{className:"branch-item flex w-full items-center justify-between px-3 text-left",onClick:()=>r.mutate(e.name),variant:e.name===s?"default":"ghost",disabled:r.isPending||e.name===s,loading:r.isPending&&r.variables===e.name,children:[(0,i.jsx)("span",{children:r.isPending&&r.variables===e.name?"Switching to "+e.name:e.name}),e.name===s&&(0,i.jsx)(b.Z,{name:"check"})]},e.name)),a&&!p.some(e=>e.name===a)&&(0,i.jsx)(e3.b,{showTooltip:!u,tooltipContent:"Your current branch does not exist on GitHub. Please switch to an existing branch first, then create your new branch.",children:(0,i.jsxs)(j.z,{className:(0,q.cn)("h-auto w-full items-center justify-start"),onClick:()=>r.mutate(a),variant:"outline",disabled:r.isPending||!u,loading:r.isPending,children:[(0,i.jsx)(b.Z,{name:"add",className:"text-muted-foreground",size:"small"}),(0,i.jsxs)("p",{className:"text-wrap text-left",children:["Create branch ",(0,i.jsx)("strong",{children:a})," from"," ",(0,i.jsx)("strong",{children:s})]})]})})]})]})})]})}let sd=e=>{let{mainBranch:t,projectId:s}=e,[a,n]=(0,o.useState)(""),[r,l]=(0,o.useState)(!1),c=(0,er.iZ)(e=>{var t;return(null===(t=e.project)||void 0===t?void 0:t.main_branch)||"main"}),d=(0,y.Z)("md"),u=(0,et.NL)(),m=(0,tn.D)({mutationFn:async e=>{await (0,g.SJ)().post("/projects/".concat(s,"/github/branches"),{branch_name:e})},onSuccess:(e,t)=>{u.invalidateQueries({queryKey:ea.iZ.branches(s)}),eT.Am.success("Lovable is now using branch: ".concat(t)),n(""),l(!1)},onError:e=>{(0,tr.Eo)(e)}});return(0,i.jsx)(eM.P,{label:"Branch",description:"Choose the GitHub branch you want to work on inside Lovable.",justify:"end",badges:["labs"],children:(0,i.jsxs)(si.J2,{open:r,onOpenChange:l,children:[(0,i.jsx)(si.xo,{asChild:!0,children:(0,i.jsxs)(j.z,{variant:"outline",size:"sm",loading:m.isPending,children:[(0,i.jsx)(b.Z,{name:"graph_1",className:"h-4 w-4"}),t,(0,i.jsx)(b.Z,{name:"chevron_right",size:"small",className:"rotate-90"})]})}),(0,i.jsx)(si.yk,{className:"p-0",align:d?"start":"end",children:(0,i.jsx)(sc,{projectId:s,main_branch:c,searchTerm:a,setSearchTerm:n,switchBranchMutation:m})})]})})};var su=s(12339),sm=s(6478);let sp=e=>{let{label:t,value:s}=e;return(0,i.jsx)(su.SP,{className:"rounded-none border-b border-transparent px-0 py-0.5 text-xs data-[state=active]:border-b-border data-[state=active]:font-medium data-[state=active]:shadow-none",value:s,children:t})},sx=e=>{let{url:t}=e,s=(0,o.forwardRef)((e,t)=>(0,i.jsx)(j.z,{ref:t,...e,variant:"ghost",className:"-mr-2 h-8 hover:text-primary",size:"icon-sm",children:(0,i.jsx)(b.Z,{name:"content_copy",className:"h-4 w-4"})}));s.displayName="TriggerComponent";let a=(0,sm.F)()({TriggerComponent:s,textToCopy:t});return(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(tM.I,{className:"h-8 flex-1 p-2 font-mono text-muted-foreground focus:text-primary md:text-xs",value:t,onFocus:e=>e.target.select(),readOnly:!0}),(0,i.jsxs)(ep.u,{children:[(0,i.jsx)(ep.aJ,{children:a}),(0,i.jsx)(ep._v,{children:"Copy to clipboard"})]})]})},sh=e=>{var t,s;let{project:a}=e,n=(null==a?void 0:a.github_repo_name)?(0,se.c_)(a.github_repo_name,null==a?void 0:null===(t=a.github_owner)||void 0===t?void 0:t.name):"#",r=(null==a?void 0:null===(s=a.github_owner)||void 0===s?void 0:s.name)+"/"+(null==a?void 0:a.github_repo_name);return(0,i.jsx)(eM.P,{label:"Clone",description:"Copy this repository to your local environment.",justify:"end",children:(0,i.jsxs)(su.mQ,{defaultValue:"https",className:"w-full pb-2",children:[(0,i.jsxs)(su.dr,{className:"gap-2 px-0 pb-0 pt-0",children:[(0,i.jsx)(sp,{value:"https",label:"HTTPS"}),(0,i.jsx)(sp,{value:"ssh",label:"SSH"}),(null==a?void 0:a.is_github)&&(0,i.jsx)(sp,{value:"githubcli",label:"GitHub CLI"})]}),(0,i.jsx)(su.nU,{value:"https",className:"mt-0",children:(0,i.jsx)(sx,{url:"".concat(n,".git")})}),(0,i.jsx)(su.nU,{value:"ssh",className:"mt-0",children:(0,i.jsx)(sx,{url:"git@github.com:".concat(r,".git")})}),(0,i.jsx)(su.nU,{value:"githubcli",className:"mt-0",children:(0,i.jsx)(sx,{url:"gh repo clone ".concat(r)})})]})})};var sg=s(74751);let sf=e=>{let{children:t}=e;return(0,i.jsx)(tu.cZ,{className:"max-h-[80vh] gap-0 overflow-y-auto p-0",size:"lg",children:t})},sj=e=>{let{title:t,description:s,badge:a}=e;return(0,i.jsxs)(tu.fK,{className:"px-6 py-6",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(tu.$N,{className:"font-medium",children:t}),a&&(0,i.jsx)(sg.p,{badge:a})]}),(0,i.jsx)(tu.Be,{className:"text-sm text-muted-foreground",children:s})]})},sv=e=>{let{children:t}=e;return(0,i.jsx)("div",{className:"flex gap-4 px-6 py-4",children:t})},sb=e=>{let{workspace:t}=e;return(0,i.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Workspace"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(tk.z,{workspace:t,className:"h-7 w-7"}),(0,i.jsx)("p",{className:"font-medium",children:t.name})]})]})};var sy=s(16831);let sw=e=>{let t=(0,et.NL)(),{mutate:s,isPending:a}=(0,tn.D)({mutationFn:async t=>{let{githubInstallation:s}=t,a=(0,g.SJ)();return await a.post("/workspaces/".concat(e,"/github-installations"),{github_installation_id:s.id})},onSuccess:async(s,a)=>{let n=ea.E.workspaceGithubInstallations(e),r=t.getQueryData(n);r&&t.setQueryData(n,{...r,installations:[...r.installations,a.githubInstallation]}),eT.Am.success("Added GitHub Organization",{description:"You can now transfer projects in this workspace to ".concat(a.githubInstallation.account.login)})},onError:e=>{(0,tr.Eo)(e)},onSettled:()=>{t.invalidateQueries({queryKey:ea.E.workspaceGithubInstallations(e)})}});return{addGithubTarget:s,isAddGithubTargetLoading:a}},sN=e=>{let t=(0,et.NL)(),{mutate:s,isPending:a}=(0,tn.D)({mutationFn:async t=>{let{githubInstallation:s}=t;return(0,g.SJ)().delete("/workspaces/".concat(e,"/github-installations/").concat(s.id))},onSuccess:async(s,a)=>{let n=ea.E.workspaceGithubInstallations(e),r=t.getQueryData(n);r&&t.setQueryData(n,{...r,installations:r.installations.filter(e=>e.id!==a.githubInstallation.id)}),eT.Am.success("Removed GitHub Organization",{description:"You can no longer transfer projects in this workspace to ".concat(a.githubInstallation.account.login)})},onError:e=>{(0,tr.Eo)(e)},onSettled:()=>{t.invalidateQueries({queryKey:ea.E.workspaceGithubInstallations(e)})}});return{deleteGithubTarget:s,isDeleteGithubTargetLoading:a}},s_=e=>{let{setStep:t,installations:s,workspaceInstallations:a,workspace:n}=e,r=a.filter(e=>!s.some(t=>t.id===e.id)),{addGithubTarget:l,isAddGithubTargetLoading:o}=sw(n.id),c=e=>{l({githubInstallation:e})},{deleteGithubTarget:d,isDeleteGithubTargetLoading:u}=sN(n.id),m=e=>{d({githubInstallation:e})},p=a.length>0;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(sj,{title:"Link your workspace to GitHub",description:"Anyone in your Lovable workspace can add Lovable projects to GitHub organizations.",badge:"admin"}),(0,i.jsx)(e0.Separator,{}),(0,i.jsxs)("div",{className:"grid min-h-[200px] grid-cols-1 gap-3 px-6 py-6 md:grid-cols-2",children:[(0,i.jsx)(sb,{workspace:n}),(0,i.jsxs)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"GitHub Organizations"}),s.map(e=>{let t=a.find(t=>t.id===e.id);return(0,i.jsx)(sk,{installation:e,workspaceInstallation:t,addWorkspaceInstallation:c,disabled:o||u,deleteGithubTarget:m},e.id)}),r.length>0&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)("p",{className:"text-sm font-medium",children:"Other users have added the following organizations:"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"If unlinked, you can not add them back."}),(0,i.jsx)("div",{className:"flex flex-col gap-2",children:r.map(e=>(0,i.jsx)(sk,{installation:e,workspaceInstallation:e,addWorkspaceInstallation:c,disabled:o||u,deleteGithubTarget:m},e.id))})]})}),(0,i.jsx)(j.z,{variant:s.length>0?"outline":"default",size:"sm",onClick:()=>(0,sn.Mn)({githubOwner:null,workspaceId:n.id}),className:"mt-auto",children:"Add Organizations"})]})]}),(0,i.jsx)(e0.Separator,{}),(0,i.jsx)(sv,{children:(0,i.jsx)(e3.b,{tooltipContent:"Please add and enable at least one organization to continue.",showTooltip:!p,className:"ml-auto",children:(0,i.jsx)(j.z,{disabled:!p,onClick:()=>t("transfer"),size:"sm",className:"ml-auto",children:"Continue"})})})]})},sk=e=>{let{installation:t,workspaceInstallation:s,addWorkspaceInstallation:a,disabled:n,deleteGithubTarget:r}=e,l=(null==s?void 0:s.id)===t.id;return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(sy.qE,{className:"h-7 w-7 border",children:(0,i.jsx)(sy.F$,{src:t.account.avatar_url})}),(0,i.jsx)("span",{className:"font-medium",children:t.account.login})]}),(0,i.jsx)(e6.r,{disabled:n,onCheckedChange:e=>{e?a(t):r(t)},checked:l})]})};var sS=s(35974);let sC=e=>{let{setStep:t,installations:s,isTransferProjectLoading:a,isWorkspaceAdmin:n,onTransfer:r}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(sj,{title:"Connect Project",description:"Connect your project to your GitHub organization in a 2-way sync."}),(0,i.jsx)(e0.Separator,{}),(0,i.jsxs)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto px-6 py-6",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"GitHub Organizations"}),s.map(e=>(0,i.jsx)(sE,{installation:e,disabled:a||!n&&!!e.suspended_at,onTransfer:r,isWorkspaceAdmin:n,isLoading:a},e.account.login))]}),(0,i.jsx)(e0.Separator,{}),(0,i.jsx)(sv,{children:(0,i.jsx)(j.z,{disabled:a,variant:"secondary",onClick:()=>t("organizations"),size:"sm",children:"Back"})})]})},sE=e=>{let{installation:t,disabled:s,onTransfer:a,isWorkspaceAdmin:n,isLoading:r}=e,[l,c]=(0,o.useState)(!1),d=r&&l;return(0,i.jsxs)("div",{className:"flex w-full items-center justify-start gap-2",children:[(0,i.jsx)(sy.qE,{className:"h-7 w-7 border",children:(0,i.jsx)(sy.F$,{src:t.account.avatar_url})}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("p",{className:"truncate font-medium",children:t.account.login}),t.suspended_at&&(0,i.jsxs)(ep.u,{children:[(0,i.jsx)(ep.aJ,{asChild:!0,children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(sS.C,{className:"inline",variant:"destructive",children:"Suspended"})})}),(0,i.jsx)(ep._v,{children:n?(0,i.jsx)("p",{children:"This account is suspended. Reconnect to continue."}):(0,i.jsx)("p",{children:"This account is suspended. Talk to your workspace owner to reconnect."})})]})]}),(0,i.jsx)(j.z,{onClick:()=>{if(t.suspended_at){window.open(t.html_url,"_blank");return}a(t),c(!0)},disabled:s,className:"ml-auto",size:"sm",variant:t.suspended_at?"outline":"default",loading:d,children:t.suspended_at?"Reconnect":d?"Connecting":"Connect"})]},t.account.login)},sA=e=>{let{isTransferProjectLoading:t,installations:s,isWorkspaceAdmin:a,onTransfer:n,showConnectDialog:r,setShowConnectDialog:l,workspace:c}=e,{installations:d}=sa(c.id),[u,m]=(0,o.useState)("organizations");return(0,i.jsxs)(tu.Vq,{open:r,onOpenChange:e=>{e||m("organizations"),l(e)},children:[(0,i.jsx)(tu.hg,{asChild:!0,className:"hidden",children:(0,i.jsx)(j.z,{size:"sm",children:"Connect Project"})}),(0,i.jsx)(sf,{children:"organizations"===u?(0,i.jsx)(s_,{setStep:m,installations:null!=s?s:[],workspaceInstallations:null!=d?d:[],workspace:c}):(0,i.jsx)(sC,{setStep:m,installations:null!=d?d:[],isTransferProjectLoading:t,isWorkspaceAdmin:a,onTransfer:n})})]})};var sD=s(26237);let sz=e=>{let{isTransferProjectLoading:t,workspaceInstallations:s,onTransfer:a,isWorkspaceAdmin:n,setShowConnectDialog:r}=e,l=(0,y.Z)("md"),c=(0,sD.C)(),[d,u]=(0,o.useState)(!1),m=(null==s?void 0:s.length)===0,{disabled:p,disabledReason:x}=(0,o.useMemo)(()=>c?{disabled:!0,disabledReason:"Cannot transfer project while there is an active operation in progress."}:!n&&m?{disabled:!0,disabledReason:"Ask a workspace admin to add GitHub Organizations."}:{disabled:!1,disabledReason:null},[c,n,m]);return(0,i.jsxs)(v.h_,{open:d,onOpenChange:e=>{m?r(!0):u(e)},children:[(0,i.jsx)(e3.b,{showTooltip:p,tooltipContent:x,children:(0,i.jsx)(v.$F,{asChild:!0,children:(0,i.jsx)(j.z,{disabled:p,className:"justify-start",size:"sm",loading:t,children:t?"Connecting":(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tS.xR.GitHub,{className:"h-4 w-4"}),"Connect Project"]})})})}),(0,i.jsxs)(v.AW,{className:"min-w-[200px]",align:l?"start":"end",children:[(0,i.jsx)(v.Ju,{className:"text-xs font-medium text-muted-foreground",children:"GitHub Organizations"}),null==s?void 0:s.map(e=>(0,i.jsx)(sI,{installation:e,disabled:t||!n&&!!e.suspended_at,onTransfer:a,isWorkspaceAdmin:n},e.account.login)),(0,i.jsx)(e3.b,{showTooltip:!n,tooltipContent:"Only workspace admins can add organizations.",side:"left",instant:!0,children:(0,i.jsxs)(v.Xi,{disabled:!n,onClick:()=>r(!0),children:[(0,i.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full border bg-background",children:(0,i.jsx)(b.Z,{name:"add",size:"small"})}),m?"Add Organization":"Manage Organizations",(0,i.jsx)(sg.p,{badge:"admin",className:"flex md:hidden"})]})})]})]})},sI=e=>{let{installation:t,disabled:s,onTransfer:a,isWorkspaceAdmin:n}=e;return(0,i.jsx)(e3.b,{showTooltip:!!t.suspended_at,tooltipContent:n?"This account is suspended. Click to reconnect.":"This account is suspended. Talk to your workspace owner to reconnect.",side:"left",children:(0,i.jsxs)(v.Xi,{className:"flex w-full items-center justify-start gap-2",onClick:()=>{if(t.suspended_at){window.open(t.html_url,"_blank");return}a(t)},disabled:s,children:[(0,i.jsx)(sy.qE,{className:"h-6 w-6 border",children:(0,i.jsx)(sy.F$,{src:t.account.avatar_url})}),(0,i.jsx)("p",{className:"truncate text-sm font-medium",children:t.account.login}),t.suspended_at&&(0,i.jsx)(sS.C,{className:"inline",variant:"destructive",children:"Suspended"})]},t.account.login)})};var sO=s(65666);let sP=e=>{let t=(0,sO.D)(),{mutate:s,isPending:a}=(0,tn.D)({mutationFn:async e=>{let s={new_owner:{id:e.account.id,name:e.account.login,type:e.target_type}},a=(0,g.SJ)();return await a.post("/projects/".concat(t,"/github/transfer"),s)},onSuccess:async(t,s)=>{eT.Am.success("A GitHub Repository is now under your account ".concat(s.account.login),{description:t.new_repo_url,action:(0,i.jsx)(j.z,{size:"sm",asChild:!0,children:(0,i.jsx)("a",{target:"_blank",href:t.new_repo_url,children:"View"})}),duration:2e4}),null==e||e()},onError:e=>{(0,tr.Eo)(e)}});return{transferProject:s,isTransferProjectLoading:a}},sT=e=>{let{isWorkspaceAdmin:t,workspace:s,showConnectDialog:a,setShowConnectDialog:n}=e,{transferProject:r,isTransferProjectLoading:l}=sP(()=>{n(!1)}),o=e=>{r(e)},{installations:c}=(0,st.D)({enabled:null!=t&&t}),{installations:d}=sa(s.id);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(sz,{isTransferProjectLoading:l,workspaceInstallations:null!=d?d:[],onTransfer:o,isWorkspaceAdmin:t,setShowConnectDialog:n}),(0,i.jsx)(sA,{installations:c,isTransferProjectLoading:l,isWorkspaceAdmin:t,onTransfer:o,setShowConnectDialog:n,showConnectDialog:a,workspace:s})]})};var sL=s(27058);let sR=e=>{let{githubRepoName:t,workspace:s,isWorkspaceAdmin:a,showConnectDialog:n,setShowConnectDialog:r}=e;return t?(0,i.jsx)(eM.P,{label:"Project",description:"Connect your project to your GitHub organization in a 2-way sync.",justify:"end",customBadge:(0,i.jsx)(sL.H,{status:"connected"}),children:(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)(j.z,{asChild:!0,variant:"outline",size:"sm",children:(0,i.jsxs)(eO.default,{href:"https://github.com/".concat(t),target:"_blank",rel:"noopener noreferrer",children:["View on GitHub",(0,i.jsx)(b.Z,{size:"small",name:"arrow_outward",className:"ml-auto"})]})})})}):(0,i.jsx)(eM.P,{label:"Connect Project",description:"Connect your project to your GitHub organization in a 2-way sync.",justify:"end",customBadge:(0,i.jsx)(sL.H,{status:"not-connected"}),children:(0,i.jsx)(sT,{isWorkspaceAdmin:a,workspace:s,showConnectDialog:n,setShowConnectDialog:r})})},sF=e=>{let{workspace:t,isInsideEditor:s,myWorkspaceRole:a}=e,[n,r]=(0,o.useState)(!1);return(0,i.jsxs)(p.tM,{value:"github",title:"GitHub",description:"Sync your project 2-way with GitHub to collaborate at source.",docsLink:"https://docs.lovable.dev/integrations/git-integration",children:[s&&(0,i.jsx)(sM,{workspace:t,myWorkspaceRole:a,showConnectDialog:n,setShowConnectDialog:r}),(0,i.jsx)(sZ,{myWorkspaceRole:a,setShowConnectDialog:r,isInsideEditor:s})]})},sZ=e=>{var t,s,a;let{myWorkspaceRole:n,setShowConnectDialog:r,isInsideEditor:l}=e,o="admin"===n||"owner"===n,{hasValidAccessToken:c,isLoading:d}=(0,st.D)({enabled:null!=o&&o}),{userData:u}=(0,eR.SE)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(sr,{isLoading:d||!u,hasAccessToken:!!((null==u?void 0:null===(t=u.github)||void 0===t?void 0:t.encrypted_access_token_v3)||(null==u?void 0:null===(s=u.github)||void 0===s?void 0:s.new_encrypted_access_token)),githubUsername:null==u?void 0:null===(a=u.github)||void 0===a?void 0:a.username,hasValidAccessToken:null!=c&&c,onGithubConnected:()=>{l&&r(!0)},isWorkspaceAdmin:o})})};function sM(e){var t,s,a,n,r,l,o;let{workspace:c,myWorkspaceRole:d,showConnectDialog:u,setShowConnectDialog:m}=e,p=(0,er.iZ)(e=>e.project),{installations:x}=sa(c.id),{userData:h}=(0,eR.SE)(),g=null===(t=(0,tE.G)().features)||void 0===t?void 0:t.git_branch_switching;if(!p)return null;let f=(null==p?void 0:null===(s=p.github_owner)||void 0===s?void 0:s.name)!==se.aR,j=(null==h?void 0:null===(a=h.github)||void 0===a?void 0:a.encrypted_access_token_v3)!==null&&(null==h?void 0:null===(n=h.github)||void 0===n?void 0:n.encrypted_access_token_v3)!==void 0||(null==h?void 0:null===(r=h.github)||void 0===r?void 0:r.new_encrypted_access_token)!==null&&(null==h?void 0:null===(l=h.github)||void 0===l?void 0:l.new_encrypted_access_token)!==void 0;return(0,i.jsxs)(i.Fragment,{children:[(j||x&&(null==x?void 0:x.length)>0)&&(0,i.jsx)(sR,{isWorkspaceAdmin:!!("admin"===d||"owner"===d),workspace:c,githubRepoName:f&&(null==p?void 0:p.github_repo_name)&&(null===(o=p.github_owner)||void 0===o?void 0:o.name)?"".concat(p.github_owner.name,"/").concat(p.github_repo_name):void 0,showConnectDialog:u,setShowConnectDialog:m}),f&&(0,i.jsx)(sh,{project:p}),f&&g&&(0,i.jsx)(sd,{mainBranch:p.main_branch||"main",projectId:p.id})]})}var sq=s(59709),sU=s(65613);let sK=e=>{var t,s;let{workspace:a,open:n,onOpenChange:r,shouldRefreshAfterOAuth:l,onRefreshComplete:c}=e,[d,u]=(0,o.useState)(""),[m,p]=(0,o.useState)(""),[x,h]=(0,o.useState)(null),[f,v]=(0,o.useState)(!1),[y,w]=(0,o.useState)(!1),[N,_]=(0,o.useState)(""),[k,S]=(0,o.useState)(!1),[C,E]=(0,o.useState)(null),A=(0,et.NL)(),D=(0,tn.D)({mutationFn:async e=>{let t=await (0,g.SJ)();return await t.post("/workspaces/".concat(a.id,"/integrations/mcp/test"),{...(null==e?void 0:e.serverId)?{server_id:e.serverId}:{url:m,...N&&{manual_token:N}}})},onSuccess:e=>{if(h(e),e.success){var t;eT.Am.success("Connected! Found ".concat((null===(t=e.tools)||void 0===t?void 0:t.length)||0," tools"))}else e.requires_oauth?eT.Am.info("This server requires OAuth authentication"):eT.Am.error(e.error||"Connection failed")},onError:e=>{var t,s,a,n;eT.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to test connection"),h({success:!1,error:(null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.error)||"Failed to test connection"})}}),z=(0,tn.D)({mutationFn:async()=>{let e=await (0,g.SJ)();if(k&&C)return console.log("[AddMCPServerDialog] OAuth server already created:",C.server_id),{alreadyCreated:!0};await e.post("/workspaces/".concat(a.id,"/integrations/connect"),{type:"mcp",name:d,url:m,...N&&{manual_token:N}})},onSuccess:()=>{A.invalidateQueries({queryKey:["mcp-servers",a.id]}),eT.Am.success("MCP server added successfully"),r(!1),u(""),p(""),h(null),_(""),w(!1),S(!1),E(null)},onError:e=>{var t,s;eT.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to add MCP server")}}),I=(0,tn.D)({mutationFn:async()=>{let e=await (0,g.SJ)();return await e.post("/workspaces/".concat(a.id,"/integrations/mcp/oauth/start"),{name:d,url:m,redirect_uri:"".concat(window.location.origin,"/mcp-callback")})},onSuccess:e=>{let t="".concat(window.location.origin,"/mcp-callback"),s={workspaceId:a.id,serverId:e.server_id,codeVerifier:e.code_verifier,redirectUri:t};E({server_id:e.server_id,name:d,url:m}),console.log("[OAuth Debug] Storing OAuth data in localStorage:",s),localStorage.setItem(sq.G,JSON.stringify(s)),console.log("[OAuth Debug] Verified stored data:",localStorage.getItem(sq.G)),console.log("[OAuth Debug] All localStorage keys:",Object.keys(localStorage)),console.log("[OAuth Debug] Opening OAuth window with URL:",e.authorization_url);let n=window.open(e.authorization_url,"_blank","width=600,height=700,left=200,top=100");n?n.focus():window.location.href=e.authorization_url,n&&setTimeout(()=>{n.closed&&console.error("[OAuth Debug] OAuth window closed within 1 second - possible redirect or error")},1e3)},onError:e=>{var t,s;eT.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to start OAuth flow")}});(0,o.useEffect)(()=>{l&&C&&(console.log("[AddMCPServerDialog] Testing connection after OAuth success"),S(!0),D.mutate({serverId:C.server_id}),null==c||c())},[l,C,D,c]);let O=()=>{r(!1),setTimeout(()=>{u(""),p(""),h(null),v(!1),_(""),w(!1),S(!1),E(null)},200)};return(0,i.jsx)(tu.Vq,{open:n,onOpenChange:O,children:(0,i.jsx)(tu.cZ,{className:"sm:max-w-[525px]",children:(0,i.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!d.trim()||!m.trim()){eT.Am.error("Please fill in all fields");return}if(!(null==x?void 0:x.success)&&!k){eT.Am.error("Please test the connection first");return}z.mutate()},children:[(0,i.jsxs)(tu.fK,{children:[(0,i.jsx)(tu.$N,{children:"Add MCP Server"}),(0,i.jsx)(tu.Be,{children:"Connect to a remote MCP server to extend the AI's capabilities."})]}),(0,i.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(t5.Label,{htmlFor:"name",children:"Server Name"}),(0,i.jsx)(tM.I,{id:"name",placeholder:"My MCP Server",value:d,onChange:e=>u(e.target.value),required:!0})]}),(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(t5.Label,{htmlFor:"url",children:"Server URL"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(tM.I,{id:"url",type:"url",placeholder:"https://mcp.example.com",value:m,onChange:e=>{p(e.target.value),h(null)},required:!0,className:"flex-1"}),(0,i.jsx)(j.z,{type:"button",variant:"secondary",onClick:()=>{if(!m.trim()){eT.Am.error("Please enter a URL");return}h(null),D.mutate(void 0)},disabled:D.isPending||!m.trim(),children:D.isPending?"Testing...":"Test"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)(j.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>w(!y),className:"flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground",children:[(0,i.jsx)(b.Z,{name:y?"keyboard_arrow_up":"keyboard_arrow_down",className:"h-4 w-4"}),"Advanced Settings"]}),y&&(0,i.jsx)("div",{className:"grid gap-2 pl-6",children:(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(t5.Label,{htmlFor:"manual-token",children:"Bearer Token (Optional)"}),(0,i.jsx)(tM.I,{id:"manual-token",type:"password",placeholder:"Enter Bearer token or API key",value:N,onChange:e=>{_(e.target.value),h(null)}}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Some MCP servers use API keys as Bearer tokens instead of OAuth. If your server requires a token, enter it here."})]})})]}),D.isPending&&(0,i.jsx)("div",{className:"rounded-lg border p-4",children:(0,i.jsx)(so.T,{text:"Testing connection..."})}),x&&!D.isPending&&(0,i.jsxs)(sU.bZ,{className:(0,q.cn)("transition-all",x.success||k?"border-green-600/20 bg-green-50/50 dark:bg-green-950/20":x.requires_oauth?"border-blue-600/20 bg-blue-50/50 dark:bg-blue-950/20":"border-destructive/20 bg-destructive/5"),children:[(0,i.jsx)(b.Z,{name:x.success||k?"check_circle":x.requires_oauth?"lock":"error",className:(0,q.cn)("h-4 w-4",x.success||k?"text-green-600":x.requires_oauth?"text-blue-600":"text-destructive")}),(0,i.jsxs)(sU.X,{className:"flex items-center justify-between",children:[(0,i.jsx)("div",{className:"flex-1",children:x.success?k?"OAuth authenticated successfully! Found ".concat((null===(t=x.tools)||void 0===t?void 0:t.length)||0," tools"):"Connection successful! Found ".concat((null===(s=x.tools)||void 0===s?void 0:s.length)||0," tools"):x.requires_oauth?"This server requires OAuth authentication":x.error||"Connection failed"}),x.success&&x.tools&&x.tools.length>0&&!k&&(0,i.jsx)(j.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>v(!f),children:(0,i.jsx)(b.Z,{name:f?"keyboard_arrow_up":"keyboard_arrow_down",className:"h-4 w-4"})}),x.requires_oauth&&(0,i.jsx)(j.z,{type:"button",size:"sm",onClick:()=>{if(!d.trim()||!m.trim()){eT.Am.error("Please fill in server name and URL first");return}I.mutate()},disabled:I.isPending,children:I.isPending?"Starting...":"Authorize"})]})]}),(null==x?void 0:x.success)&&x.tools&&f&&!k&&(0,i.jsx)("div",{className:"max-h-[200px] overflow-y-auto rounded-lg border p-4",children:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("h4",{className:"mb-2 text-sm font-medium",children:["Available Tools (",x.tools.length,")"]}),x.tools.map((e,t)=>(0,i.jsxs)("div",{className:"border-l-2 border-muted py-1 pl-3",children:[(0,i.jsx)("div",{className:"text-sm font-medium",children:e.name}),e.description&&(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:e.description})]},t))]})})]}),(0,i.jsxs)(tu.cN,{children:[(0,i.jsx)(j.z,{type:"button",variant:"outline",onClick:O,children:"Cancel"}),(0,i.jsx)(j.z,{type:"submit",disabled:z.isPending||!(null==x?void 0:x.success)&&!k,children:z.isPending?"Adding...":"Add Server"})]})]})})})},sG=e=>{let{workspace:t,isWorkspaceAdmin:s,shouldRefresh:a,onRefreshComplete:n}=e,r=(0,et.NL)(),[l,c]=(0,o.useState)(new Set);(0,o.useEffect)(()=>{a&&(r.invalidateQueries({queryKey:["mcp-servers",t.id]}),null==n||n())},[a,t.id,r,n]);let d=e=>{let t=new Set(l);t.has(e)?t.delete(e):t.add(e),c(t)},{data:u,isLoading:m}=(0,h.a)({queryKey:["mcp-servers",t.id],queryFn:async()=>{let e=await (0,g.SJ)();return(await e.get("/workspaces/".concat(t.id,"/integrations/mcp"))).servers||[]}}),p=(0,tn.D)({mutationFn:async e=>{let s=await (0,g.SJ)();await s.delete("/workspaces/".concat(t.id,"/integrations/mcp/").concat(e))},onSuccess:()=>{r.invalidateQueries({queryKey:["mcp-servers",t.id]}),eT.Am.success("MCP server removed successfully")},onError:()=>{eT.Am.error("Failed to remove MCP server")}});return m?(0,i.jsx)("div",{className:"flex justify-center py-8",children:(0,i.jsx)(so.T,{text:"Loading MCP servers..."})}):u&&0!==u.length?(0,i.jsx)("div",{className:"space-y-4",children:u.map(e=>{let t=l.has(e.id),a=e.tools&&e.tools.length>0;return(0,i.jsxs)("div",{className:"overflow-hidden rounded-lg border",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,i.jsxs)("div",{className:"flex flex-1 items-center gap-3",children:[(0,i.jsx)(b.Z,{name:"cloud",className:"h-5 w-5 flex-shrink-0 text-muted-foreground"}),(0,i.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,i.jsx)("p",{className:"font-medium",children:e.name}),(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,i.jsx)("span",{className:"truncate",children:e.url}),a&&(0,i.jsxs)("span",{className:"flex-shrink-0",children:["• ",e.tools.length," tools"]})]})]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[a&&(0,i.jsx)(j.z,{variant:"ghost",size:"sm",onClick:()=>d(e.id),children:(0,i.jsx)(b.Z,{name:t?"keyboard_arrow_up":"keyboard_arrow_down",className:"h-4 w-4"})}),s&&(0,i.jsx)(j.z,{variant:"ghost",size:"sm",onClick:()=>p.mutate(e.id),disabled:p.isPending,children:(0,i.jsx)(b.Z,{name:"delete"})})]})]}),t&&a&&(0,i.jsx)("div",{className:"border-t bg-muted/30 px-4 py-3",children:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("h5",{className:"mb-2 text-sm font-medium",children:"Available Tools"}),(0,i.jsx)("div",{className:"space-y-1",children:e.tools.map((e,t)=>(0,i.jsxs)("div",{className:"border-l-2 border-muted py-1 pl-3",children:[(0,i.jsx)("div",{className:"text-sm font-medium",children:e.name}),e.description&&(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:e.description})]},t))})]})})]},e.id)})}):(0,i.jsxs)("div",{className:"rounded-lg border border-dashed p-8 text-center",children:[(0,i.jsx)(b.Z,{name:"cloud",className:"mx-auto h-12 w-12 text-muted-foreground/50"}),(0,i.jsx)("h3",{className:"mt-4 text-sm font-medium",children:"No MCP servers connected"}),(0,i.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Get started by adding your first MCP server connection."})]})},sW=e=>{let{workspace:t,isInsideEditor:s,myWorkspaceRole:a}=e,[n,r]=(0,o.useState)(!1),[l,c]=(0,o.useState)(!1),d="admin"===a||"owner"===a,u=(0,o.useCallback)(()=>{console.log("[MCPTab] OAuth success, dialog stays open to show tools"),c(!0)},[]);return(0,sq.d)({workspaceId:t.id,onConnectSuccess:u}),(0,i.jsxs)(p.tM,{value:"mcp",title:"MCP",description:"Connect to Model Context Protocol servers for enhanced AI capabilities.",docsLink:"https://docs.lovable.dev/integrations/mcp",children:[(0,i.jsx)(sK,{workspace:t,open:n,onOpenChange:r,shouldRefreshAfterOAuth:l,onRefreshComplete:()=>c(!1)}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)("div",{className:"rounded-lg border p-6",children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-lg font-medium",children:"MCP Servers"}),(0,i.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Connect to remote MCP servers to extend the AI's capabilities with custom tools and integrations."})]}),d&&(0,i.jsx)(j.z,{onClick:()=>r(!0),className:"w-full sm:w-auto",children:"Add MCP Server"})]})}),(0,i.jsx)(sG,{workspace:t,isWorkspaceAdmin:d,shouldRefresh:l,onRefreshComplete:()=>c(!1)})]})]})},sJ=e=>{let{workspace:t,isInsideEditor:s,myWorkspaceRole:a,project:n}=e,[r,l]=(0,o.useState)([]),[c,d]=(0,o.useState)(!1),u=(0,sD.C)(),[m,x]=(0,o.useState)(!1),[h,f]=(0,o.useState)(null),[v,y]=(0,o.useState)({}),[w,N]=(0,o.useState)(""),[_,k]=(0,o.useState)("");(0,o.useEffect)(()=>{(null==n?void 0:n.id)&&S()},[null==n?void 0:n.id]);let S=async()=>{if(null==n?void 0:n.id){d(!0);try{let e=(0,g.SJ)(),t=(await e.get("/projects/".concat(n.id,"/integrations/memory"))||[]).sort((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime());l(t)}catch(e){console.error("Failed to load memories:",e),eT.Am.error("Failed to load memories")}finally{d(!1)}}},C=async e=>{if(null==n?void 0:n.id)try{let t=(0,g.SJ)();await t.post("/projects/".concat(n.id,"/integrations/memory"),e);let s=e.sort((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime());l(s),eT.Am.success("Memories updated successfully")}catch(e){throw console.error("Failed to save memories:",e),eT.Am.error("Failed to save memories"),e}},E=async()=>{if(!w||!_){eT.Am.error("Path and content are required");return}if(r.some(e=>e.path===w)){eT.Am.error("A memory with this path already exists");return}let e={path:w,content:_,updated_at:new Date().toISOString()};try{await C([...r,e]),N(""),k("")}catch(e){}},A=e=>{y({[e.path]:{path:e.path,content:e.content,originalPath:e.path,originalContent:e.content}})},D=e=>{let t=v[e];return!!t&&(t.path!==t.originalPath||t.content!==t.originalContent)},z=async e=>{let t=v[e];if(t){if(t.path!==e&&r.some(e=>e.path===t.path)){eT.Am.error("A memory with this path already exists");return}try{let s=r.map(s=>s.path===e?{path:t.path,content:t.content,updated_at:new Date().toISOString()}:s);await C(s);let a={...v};delete a[e],y(a)}catch(e){}}},I=e=>{let t={...v};delete t[e],y(t)},O=async()=>{if(h)try{let e=r.filter(e=>e.path!==h);await C(e),f(null),x(!1)}catch(e){}};return(0,i.jsx)(ep.pn,{children:(0,i.jsx)(p.tM,{value:"memory",title:"Memory",description:"Manage memory files that help Lovable remember important context about your project.",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsxs)("div",{className:"flex w-full flex-col gap-0",children:[(0,i.jsx)(tM.I,{placeholder:"Untitled Memory",value:w,onChange:e=>N(e.target.value),disabled:u,className:"h-10 rounded-b-none font-medium placeholder:text-foreground/50 focus-visible:ring-0 focus-visible:ring-offset-0"}),(0,i.jsx)(eB.g,{placeholder:"Remember that...",className:"min-h-40 resize-none rounded-b-lg rounded-t-none border border-t-0 border-border bg-background p-3 font-mono text-[13px] placeholder:text-foreground/50 focus-visible:ring-0 focus-visible:ring-offset-0",value:_,onChange:e=>k(e.target.value),disabled:u})]}),(0,i.jsxs)(ep.u,{children:[(0,i.jsx)(ep.aJ,{asChild:!0,children:(0,i.jsx)("span",{className:"cursor-not-allowed",children:(0,i.jsx)(j.z,{size:"icon-sm",variant:"ghost",disabled:u||!w||!_,onClick:E,children:(0,i.jsx)(b.Z,{name:"add_2",size:"default"})})})}),(0,i.jsx)(ep._v,{children:u?"Wait for Lovable to finish working":"Add a title and content to save the memory"})]})]}),c?(0,i.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,i.jsx)(b.Z,{name:"progress_activity",className:"h-6 w-6 animate-spin"}),(0,i.jsx)("span",{className:"ml-2",children:"Loading memories..."})]}):(0,i.jsx)(i.Fragment,{children:r.map(e=>{var t,s;let a=v[e.path],n=null!==(t=null==a?void 0:a.path)&&void 0!==t?t:e.path,r=null!==(s=null==a?void 0:a.content)&&void 0!==s?s:e.content;return(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsxs)("div",{className:"flex w-full flex-col gap-0",children:[(0,i.jsx)(tM.I,{value:n,onChange:a?t=>y({...v,[e.path]:{...v[e.path],path:t.target.value}}):void 0,className:"h-10 rounded-b-none font-medium placeholder:text-foreground/50 focus-visible:ring-0 focus-visible:ring-offset-0 ".concat(a?"":"cursor-text"),disabled:u,readOnly:!a,onClick:()=>!u&&!a&&A(e)}),(0,i.jsx)(eB.g,{value:r,onChange:a?t=>y({...v,[e.path]:{...v[e.path],content:t.target.value}}):void 0,className:"min-h-40 resize-none rounded-b-lg rounded-t-none border border-t-0 border-border bg-background p-3 font-mono text-[13px] placeholder:text-foreground/50 focus-visible:ring-0 focus-visible:ring-offset-0 ".concat(a?"":"cursor-text"),disabled:u,readOnly:!a,onClick:()=>!u&&!a&&A(e)})]}),a&&D(e.path)?(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsxs)(ep.u,{children:[(0,i.jsx)(ep.aJ,{asChild:!0,children:(0,i.jsx)(j.z,{variant:"ghost",size:"icon-sm",onClick:()=>z(e.path),disabled:u,children:(0,i.jsx)(b.Z,{name:"check",size:"default"})})}),(0,i.jsx)(ep._v,{children:u?"Wait for Lovable to finish working":"Save changes"})]}),(0,i.jsxs)(ep.u,{children:[(0,i.jsx)(ep.aJ,{asChild:!0,children:(0,i.jsx)(j.z,{variant:"ghost",size:"icon-sm",onClick:()=>I(e.path),disabled:u,children:(0,i.jsx)(b.Z,{name:"close",size:"default"})})}),(0,i.jsx)(ep._v,{children:u?"Wait for Lovable to finish working":"Discard changes"})]})]}):(0,i.jsxs)(ep.u,{children:[(0,i.jsx)(ep.aJ,{asChild:!0,children:(0,i.jsx)(j.z,{variant:"ghost",size:"icon-sm",onClick:()=>{f(e.path),x(!0)},disabled:u,children:(0,i.jsx)(b.Z,{name:"delete",size:"default"})})}),(0,i.jsx)(ep._v,{children:u?"Can't delete memories while Lovable is working":"Delete memory"})]})]},e.path)})}),(0,i.jsx)(tu.Vq,{open:m,onOpenChange:x,children:(0,i.jsxs)(tu.cZ,{children:[(0,i.jsxs)(tu.fK,{children:[(0,i.jsx)(tu.$N,{children:"Delete Memory"}),(0,i.jsxs)(tu.Be,{children:['Are you sure you want to delete "',h,'"? This action cannot be undone.']})]}),(0,i.jsxs)(tu.cN,{children:[(0,i.jsx)(j.z,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),(0,i.jsx)(j.z,{variant:"destructive",onClick:O,children:"Delete"})]})]})})]})})})};var sV=s(78079),sB=s(10867),sH=s(37675),sQ=s(75403);let sY=(0,o.createContext)(void 0);function sX(e){let{children:t,onStackEmpty:s,initialStack:a=[]}=e,[n,r]=(0,o.useState)(a),l=(0,o.useCallback)(e=>{r(t=>[...t,e])},[]),c=(0,o.useCallback)(()=>{r(e=>{let t=e.slice(0,-1);return 0===t.length&&(null==s||s()),t})},[s]),d=(0,o.useCallback)(e=>{e<0||r(t=>t.slice(0,e+1))},[]),u=(0,o.useCallback)(()=>{r([]),null==s||s()},[s]),m=(0,o.useMemo)(()=>({stack:n,push:l,pop:c,popTo:d,reset:u}),[n,l,c,d,u]);return(0,i.jsx)(sY.Provider,{value:m,children:t})}function s$(){let e=(0,o.useContext)(sY);if(void 0===e)throw Error("useSheetNavigation must be used within a SheetNavigationProvider");return e}function s0(e){let{isMobile:t,children:s,navigationItems:a}=e,{stack:n,push:r,popTo:l,reset:o}=s$(),c=(e,t)=>{(1!==n.length||n[0].title!==e)&&(o(),r({title:e,component:t}))},d=n[n.length-1],u=n.length>0?n[0].title:null;return t?(0,i.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,i.jsx)("div",{className:"flex h-full flex-col overflow-hidden",children:(0,i.jsx)("div",{className:"grow overflow-y-auto",children:d?d.component:s})}),(0,i.jsx)("div",{className:"border-t bg-background",children:(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsx)("div",{className:"flex min-w-max gap-1 p-2",children:a.map(e=>{let{title:t,icon:s,component:a}=e;return(0,i.jsxs)(j.z,{variant:u===t?"secondary":"ghost",className:"h-16 w-20 min-w-16 flex-col gap-1 px-2 text-xs",onClick:()=>c(t,a),children:[(0,i.jsx)(b.Z,{name:s,size:"small"}),(0,i.jsx)("span",{className:"text-center text-[10px] leading-tight",children:"Auth"===t?"Auth":t})]},t)})})})})]}):(0,i.jsx)("div",{className:"flex h-full w-full",children:(0,i.jsxs)("div",{className:"flex h-full w-full flex-col gap-6",children:[n.length>0&&(0,i.jsx)("div",{className:"relative flex shrink-0 items-center border-b pb-2",children:(0,i.jsxs)("div",{className:"relative z-10 flex items-center gap-1.5 text-sm text-muted-foreground",children:[(0,i.jsx)("button",{onClick:()=>o(),className:"hover:underline",children:"Home"}),n.map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,i.jsx)("span",{className:"text-muted-foreground",children:"/"}),t===n.length-1?(0,i.jsx)("span",{className:"text-foreground",children:e.title}):(0,i.jsx)("button",{onClick:()=>l(t),className:"hover:underline",children:e.title})]},"".concat(e.title,"-").concat(t)))]})}),(0,i.jsx)("div",{className:"flex grow flex-col gap-6 pb-12",children:d?d.component:s})]})})}var s1=s(43246),s2=s(25057),s5=s(80733),s4=s(45008),s3=s(87057);function s6(){let e=(0,s4._)(["\n    with\n      tables as (","),\n      columns as (",")\n    select\n      *,\n      ","\n    from tables\n  "]);return s6=function(){return e},e}function s7(){let e=(0,s4._)(["\n    COALESCE(\n      (\n        SELECT\n          array_agg(row_to_json(",")) FILTER (WHERE ",")\n        FROM\n          ","\n      ),\n      '{}'\n    ) AS ","\n  "]);return s7=function(){return e},e}let s8=["information_schema","pg_catalog","pg_toast","_timescaledb_internal"],s9=(e,t)=>(0,s3.Pn)(s7(),e,t,e,e),ae=async(e,t)=>{let{data:s,error:a}=await t.GET("/v1/projects/{ref}/config/auth",{params:{path:{ref:e}}});if(a)throw a;return s},at=(0,s2.t)(),as=e=>{let t=aa();return(0,h.a)({queryKey:["auth-config",e],queryFn:()=>ae(e,t),enabled:!!e&&!!t,retry:!1})},aa=()=>{let e=(0,er.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.id});return(0,o.useMemo)(()=>e?(0,s1.ZP)({baseUrl:"".concat(at,"/projects/").concat(e,"/db-proxy"),fetch:async e=>{let t=await s5.g.getValidToken();if(!t)throw Error("No token available");return e.headers.append("Authorization","Bearer ".concat(t)),fetch(e)}}):null,[e])},an=async e=>{let{projectRef:t,payload:s,dbClient:a}=e,{data:n,error:r}=await a.PATCH("/v1/projects/{ref}/config/auth",{params:{path:{ref:t}},body:s});if(r)throw r;return n},ar=()=>{let e=(0,et.NL)(),t=aa();return(0,tn.D)({mutationFn:e=>{let{projectRef:s,payload:a}=e;if(!t)throw Error("Database client not available");return an({projectRef:s,payload:a,dbClient:t})},onSuccess:(t,s)=>{eT.Am.success("Auth config updated."),e.invalidateQueries({queryKey:["auth-config",s.projectRef]})},onError:e=>{(0,tr.Eo)(e)}})},al=async e=>{let{projectRef:t,query:s,readOnly:a,dbClient:n}=e,{data:r,error:l}=await n.POST("/v1/projects/{ref}/database/query",{params:{path:{ref:t}},body:{query:s,read_only:a}});if(l)throw l;return r},ai=()=>{let e=aa();return(0,tn.D)({mutationFn:t=>{let{projectRef:s,query:a,readOnly:n}=t;if(!e)throw Error("Database client not available");return al({projectRef:s,query:a,readOnly:n,dbClient:e})},onError:e=>{(0,tr.Eo)(e)}})},ao=e=>{let{projectRef:t,schemas:s,dbClient:a}=e;return al({projectRef:t,query:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,s3.Pn)(s6(),"\nSELECT\n  c.oid :: int8 AS id,\n  nc.nspname AS schema,\n  c.relname AS name,\n  c.relrowsecurity AS rls_enabled,\n  c.relforcerowsecurity AS rls_forced,\n  CASE\n    WHEN c.relreplident = 'd' THEN 'DEFAULT'\n    WHEN c.relreplident = 'i' THEN 'INDEX'\n    WHEN c.relreplident = 'f' THEN 'FULL'\n    ELSE 'NOTHING'\n  END AS replica_identity,\n  pg_total_relation_size(format('%I.%I', nc.nspname, c.relname)) :: int8 AS bytes,\n  pg_size_pretty(\n    pg_total_relation_size(format('%I.%I', nc.nspname, c.relname))\n  ) AS size,\n  pg_stat_get_live_tuples(c.oid) AS live_rows_estimate,\n  pg_stat_get_dead_tuples(c.oid) AS dead_rows_estimate,\n  obj_description(c.oid) AS comment,\n  coalesce(pk.primary_keys, '[]') as primary_keys,\n  coalesce(\n    jsonb_agg(relationships) filter (where relationships is not null),\n    '[]'\n  ) as relationships\nFROM\n  pg_namespace nc\n  JOIN pg_class c ON nc.oid = c.relnamespace\n  left join (\n    select\n      table_id,\n      jsonb_agg(_pk.*) as primary_keys\n    from (\n      select\n        n.nspname as schema,\n        c.relname as table_name,\n        a.attname as name,\n        c.oid :: int8 as table_id\n      from\n        pg_index i,\n        pg_class c,\n        pg_attribute a,\n        pg_namespace n\n      where\n        i.indrelid = c.oid\n        and c.relnamespace = n.oid\n        and a.attrelid = c.oid\n        and a.attnum = any (i.indkey)\n        and i.indisprimary\n    ) as _pk\n    group by table_id\n  ) as pk\n  on pk.table_id = c.oid\n  left join (\n    select\n      c.oid :: int8 as id,\n      c.conname as constraint_name,\n      nsa.nspname as source_schema,\n      csa.relname as source_table_name,\n      sa.attname as source_column_name,\n      nta.nspname as target_table_schema,\n      cta.relname as target_table_name,\n      ta.attname as target_column_name\n    from\n      pg_constraint c\n    join (\n      pg_attribute sa\n      join pg_class csa on sa.attrelid = csa.oid\n      join pg_namespace nsa on csa.relnamespace = nsa.oid\n    ) on sa.attrelid = c.conrelid and sa.attnum = any (c.conkey)\n    join (\n      pg_attribute ta\n      join pg_class cta on ta.attrelid = cta.oid\n      join pg_namespace nta on cta.relnamespace = nta.oid\n    ) on ta.attrelid = c.confrelid and ta.attnum = any (c.confkey)\n    where\n      c.contype = 'f'\n  ) as relationships\n  on (relationships.source_schema = nc.nspname and relationships.source_table_name = c.relname)\n  or (relationships.target_table_schema = nc.nspname and relationships.target_table_name = c.relname)\nWHERE\n  c.relkind IN ('r', 'p')\n  AND NOT pg_is_other_temp_schema(nc.oid)\n  AND (\n    pg_has_role(c.relowner, 'USAGE')\n    OR has_table_privilege(\n      c.oid,\n      'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n    )\n    OR has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n  )\ngroup by\n  c.oid,\n  c.relname,\n  c.relrowsecurity,\n  c.relforcerowsecurity,\n  c.relreplident,\n  nc.nspname,\n  pk.primary_keys\n","\n-- Adapted from information_schema.columns\n\nSELECT\n  c.oid :: int8 AS table_id,\n  nc.nspname AS schema,\n  c.relname AS table,\n  (c.oid || '.' || a.attnum) AS id,\n  a.attnum AS ordinal_position,\n  a.attname AS name,\n  CASE\n    WHEN a.atthasdef THEN pg_get_expr(ad.adbin, ad.adrelid)\n    ELSE NULL\n  END AS default_value,\n  CASE\n    WHEN t.typtype = 'd' THEN CASE\n      WHEN bt.typelem <> 0 :: oid\n      AND bt.typlen = -1 THEN 'ARRAY'\n      WHEN nbt.nspname = 'pg_catalog' THEN format_type(t.typbasetype, NULL)\n      ELSE 'USER-DEFINED'\n    END\n    ELSE CASE\n      WHEN t.typelem <> 0 :: oid\n      AND t.typlen = -1 THEN 'ARRAY'\n      WHEN nt.nspname = 'pg_catalog' THEN format_type(a.atttypid, NULL)\n      ELSE 'USER-DEFINED'\n    END\n  END AS data_type,\n  COALESCE(bt.typname, t.typname) AS format,\n  a.attidentity IN ('a', 'd') AS is_identity,\n  CASE\n    a.attidentity\n    WHEN 'a' THEN 'ALWAYS'\n    WHEN 'd' THEN 'BY DEFAULT'\n    ELSE NULL\n  END AS identity_generation,\n  a.attgenerated IN ('s') AS is_generated,\n  NOT (\n    a.attnotnull\n    OR t.typtype = 'd' AND t.typnotnull\n  ) AS is_nullable,\n  (\n    c.relkind IN ('r', 'p')\n    OR c.relkind IN ('v', 'f') AND pg_column_is_updatable(c.oid, a.attnum, FALSE)\n  ) AS is_updatable,\n  uniques.table_id IS NOT NULL AS is_unique,\n  check_constraints.definition AS \"check\",\n  array_to_json(\n    array(\n      SELECT\n        enumlabel\n      FROM\n        pg_catalog.pg_enum enums\n      WHERE\n        enums.enumtypid = coalesce(bt.oid, t.oid)\n        OR enums.enumtypid = coalesce(bt.typelem, t.typelem)\n      ORDER BY\n        enums.enumsortorder\n    )\n  ) AS enums,\n  col_description(c.oid, a.attnum) AS comment\nFROM\n  pg_attribute a\n  LEFT JOIN pg_attrdef ad ON a.attrelid = ad.adrelid\n  AND a.attnum = ad.adnum\n  JOIN (\n    pg_class c\n    JOIN pg_namespace nc ON c.relnamespace = nc.oid\n  ) ON a.attrelid = c.oid\n  JOIN (\n    pg_type t\n    JOIN pg_namespace nt ON t.typnamespace = nt.oid\n  ) ON a.atttypid = t.oid\n  LEFT JOIN (\n    pg_type bt\n    JOIN pg_namespace nbt ON bt.typnamespace = nbt.oid\n  ) ON t.typtype = 'd'\n  AND t.typbasetype = bt.oid\n  LEFT JOIN (\n    SELECT DISTINCT ON (table_id, ordinal_position)\n      conrelid AS table_id,\n      conkey[1] AS ordinal_position\n    FROM pg_catalog.pg_constraint\n    WHERE contype = 'u' AND cardinality(conkey) = 1\n  ) AS uniques ON uniques.table_id = c.oid AND uniques.ordinal_position = a.attnum\n  LEFT JOIN (\n    -- We only select the first column check\n    SELECT DISTINCT ON (table_id, ordinal_position)\n      conrelid AS table_id,\n      conkey[1] AS ordinal_position,\n      substring(\n        pg_get_constraintdef(pg_constraint.oid, true),\n        8,\n        length(pg_get_constraintdef(pg_constraint.oid, true)) - 8\n      ) AS \"definition\"\n    FROM pg_constraint\n    WHERE contype = 'c' AND cardinality(conkey) = 1\n    ORDER BY table_id, ordinal_position, oid asc\n  ) AS check_constraints ON check_constraints.table_id = c.oid AND check_constraints.ordinal_position = a.attnum\nWHERE\n  NOT pg_is_other_temp_schema(nc.oid)\n  AND a.attnum > 0\n  AND NOT a.attisdropped\n  AND (c.relkind IN ('r', 'v', 'm', 'f', 'p'))\n  AND (\n    pg_has_role(c.relowner, 'USAGE')\n    OR has_column_privilege(\n      c.oid,\n      a.attnum,\n      'SELECT, INSERT, UPDATE, REFERENCES'\n    )\n  )\n",s9("columns","columns.table_id = tables.id"));return t+="\n",e.length>0?t+="where schema in (".concat(e.map(e=>"'".concat(e,"'")).join(","),")"):t+="where schema not in (".concat(s8.map(e=>"'".concat(e,"'")).join(","),")"),t}(s),readOnly:!0,dbClient:a})},ac=(e,t)=>{let s=aa();return(0,h.a)({queryKey:["tables",e,t],queryFn:()=>ao({projectRef:e,schemas:t,dbClient:s}),enabled:!!e&&!!s})},ad=async(e,t)=>{let{data:s,error:a}=await t.GET("/v1/projects/{ref}/storage/buckets",{params:{path:{ref:e}}});if(a)throw a;return s},au=e=>{let t=aa();return(0,h.a)({queryKey:["buckets",e],queryFn:()=>ad(e,t),enabled:!!e&&!!t,retry:!1})},am=async e=>{let{projectRef:t,iso_timestamp_start:s,iso_timestamp_end:a,sql:n,dbClient:r}=e,{data:l,error:i}=await r.GET("/v1/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:t},query:{iso_timestamp_start:s,iso_timestamp_end:a,sql:n}}});if(i)throw i;return l},ap=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=aa(),a=["logs",e,t.sql];return(0,h.a)({queryKey:a,queryFn:()=>{var a,n;let r=new Date,l=new Date(r.getTime()-36e5);return am({projectRef:e,sql:t.sql,iso_timestamp_start:null!==(a=t.iso_timestamp_start)&&void 0!==a?a:l.toISOString(),iso_timestamp_end:null!==(n=t.iso_timestamp_end)&&void 0!==n?n:r.toISOString(),dbClient:s})},enabled:!!e&&!!s,retry:!1})},ax=e=>{let{projectRef:t,days:s,dbClient:a}=e;return al({projectRef:t,query:"\n    WITH days_series AS (\n      SELECT generate_series(\n        date_trunc('day', now() - interval '".concat(Number(s)-1," days'),\n        date_trunc('day', now()),\n        '1 day'::interval\n      )::date AS date\n    )\n    SELECT\n      d.date,\n      COALESCE(u.users, 0)::int as users\n    FROM\n      days_series d\n    LEFT JOIN (\n      SELECT\n        date_trunc('day', created_at AT TIME ZONE 'UTC')::date as date,\n        count(id) as users\n      FROM\n        auth.users\n      GROUP BY 1\n    ) u ON d.date = u.date\n    ORDER BY\n      d.date ASC;\n  "),readOnly:!0,dbClient:a})},ah=(e,t)=>{let s=aa();return(0,h.a)({queryKey:["user-counts",e,t],queryFn:()=>ax({projectRef:e,days:t,dbClient:s}),enabled:!!e&&!!s,retry:!1})},ag=async(e,t)=>{let[{data:s,error:a},{data:n,error:r}]=await Promise.all([t.GET("/v1/projects/{ref}/advisors/performance",{params:{path:{ref:e}}}),t.GET("/v1/projects/{ref}/advisors/security",{params:{path:{ref:e}}})]);if(a)throw a;if(r)throw r;return[...((null==s?void 0:s.lints)||[]).map(e=>({...e,type:"performance"})),...((null==n?void 0:n.lints)||[]).map(e=>({...e,type:"security"}))]},af=e=>{let t=aa();return(0,h.a)({queryKey:["suggestions",e],queryFn:()=>ag(e,t),enabled:!!e&&!!t,retry:!1})},aj=e=>{let t=af(e),s=(0,o.useMemo)(()=>!!t.data&&t.data.some(e=>"ERROR"===e.level||"WARN"===e.level),[t.data]);return{...t,hasWarningsOrErrors:s}},av=async(e,t)=>{let{data:s,error:a}=await t.GET("/v1/projects/{ref}/secrets",{params:{path:{ref:e}}});if(a)throw a;return console.log("SECRETS-DATA",s),s},ab=e=>{let t=aa();return(0,h.a)({queryKey:["secrets",e],queryFn:()=>av(e,t),enabled:!!e&&!!t,retry:!1})},ay=async e=>{let{projectRef:t,secrets:s,dbClient:a}=e,{data:n,error:r}=await a.POST("/v1/projects/{ref}/secrets",{params:{path:{ref:t}},body:s});if(r)throw r;return n},aw=()=>{let e=(0,et.NL)(),t=aa();return(0,tn.D)({mutationFn:e=>{let{projectRef:s,secrets:a}=e;if(!t)throw Error("Database client not available");return ay({projectRef:s,secrets:a,dbClient:t})},onSuccess:(t,s)=>{eT.Am.success("Secrets created successfully."),e.refetchQueries({queryKey:["secrets",s.projectRef]})},onError:e=>{(0,tr.Eo)(e)}})},aN=async e=>{let{projectRef:t,secretNames:s,dbClient:a}=e,{data:n,error:r}=await a.DELETE("/v1/projects/{ref}/secrets",{params:{path:{ref:t}},body:s});if(r)throw r;return n},a_=()=>{let e=(0,et.NL)(),t=aa();return(0,tn.D)({mutationFn:e=>{let{projectRef:s,secretNames:a}=e;if(!t)throw Error("Database client not available");return aN({projectRef:s,secretNames:a,dbClient:t})},onSuccess:(t,s)=>{eT.Am.success("Secrets deleted successfully."),e.invalidateQueries({queryKey:["secrets",s.projectRef]})},onError:e=>{(0,tr.Eo)(e)}})};var ak=s(29133);let aS={disable_signup:"Disable Signup",external_anonymous_users_enabled:"Allow Anonymous Sign-ins",external_email_enabled:"Enable Email Provider",mailer_autoconfirm:"Confirm Email",mailer_secure_email_change_enabled:"Secure Email Change",security_update_password_require_reauthentication:"Secure Password Change",password_hibp_enabled:"Prevent Leaked Passwords",password_min_length:"Minimum Password Length",password_required_characters:{label:"Password Requirements",options:{NO_REQUIRED_CHARS:"No requirements","abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789":"Letters and numbers","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789":"Lowercase, uppercase, and numbers","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789:!@#$%^&*()_+-=[]{};'\\\\:\"|<>?,./`~":"Letters, numbers, and symbols"}},mailer_otp_exp:"Email OTP Expiration (seconds)",mailer_otp_length:"Email OTP Length",external_phone_enabled:"Enable Phone Provider",sms_provider:{label:"SMS Provider",options:{twilio:"Twilio",messagebird:"MessageBird",textlocal:"TextLocal",vonage:"Vonage",twilio_verify:"Twilio Verify"}},sms_twilio_account_sid:"Twilio Account SID",sms_twilio_auth_token:"Twilio Auth Token",sms_twilio_message_service_sid:"Twilio Message Service SID",sms_twilio_content_sid:"Twilio Content SID",sms_twilio_verify_account_sid:"Twilio Verify Account SID",sms_twilio_verify_auth_token:"Twilio Verify Auth Token",sms_twilio_verify_message_service_sid:"Twilio Verify Message Service SID",sms_messagebird_access_key:"MessageBird Access Key",sms_messagebird_originator:"MessageBird Originator",sms_textlocal_api_key:"TextLocal API Key",sms_textlocal_sender:"TextLocal Sender",sms_vonage_api_key:"Vonage API Key",sms_vonage_api_secret:"Vonage API Secret",sms_vonage_from:"Vonage From Number",sms_autoconfirm:"Enable Phone Confirmations",sms_otp_exp:"SMS OTP Expiry (seconds)",sms_otp_length:"SMS OTP Length",sms_template:"SMS Message Template",sms_test_otp:"Test Phone Numbers and OTPs",sms_test_otp_valid_until:"Test OTPs Valid Until",external_google_enabled:"Enable Google Sign-in",external_google_client_id:"Google Client ID(s)",external_google_secret:"Google OAuth Client Secret",external_google_skip_nonce_check:"Skip Nonce Check",name:"Secret Name",value:"Secret Value",secretNames:"Secret Names"},aC=tG.Ry({disable_signup:tG.O7().optional().describe("This will prevent new users from signing up."),external_anonymous_users_enabled:tG.O7().optional().describe("This will enable anonymous users to sign in to your application.")}),aE="NO_REQUIRED_CHARS",aA=tG.Ry({external_email_enabled:tG.O7().optional().describe("This will enable Email based signup and login for your application."),mailer_autoconfirm:tG.O7().optional().describe("Users will need to confirm their email address before signing in for the first time."),mailer_secure_email_change_enabled:tG.O7().optional().describe("Users will be required to confirm any email change on both the old email address and new email address. If disabled, only the new email is required to confirm."),security_update_password_require_reauthentication:tG.O7().optional().describe("Users will need to be recently logged in to change their password without requiring reauthentication. (A user is considered recently logged in if the session was created within the last 24 hours.) If disabled, a user can change their password at any time."),password_hibp_enabled:tG.O7().optional().describe("Rejects the use of known or easy to guess passwords on sign up or password change. Powered by the HaveIBeenPwned.org Pwned Passwords API."),password_min_length:tG.Rx().int().min(6,"Must be greater or equal to 6.").describe("Passwords shorter than this value will be rejected as weak. Minimum 6, recommended 8 or more."),password_required_characters:tG.dj(e=>""===e||null==e?aE:e,tG.Km([aE,"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789:!@#$%^&*()_+-=[]{};'\\\\:\"|<>?,./`~"])).optional().transform(e=>e===aE?"":e).describe("Passwords that do not have at least one of each will be rejected as weak."),mailer_otp_exp:tG.Rx().int().min(0,"Must be more than 0").max(86400,"Must be no more than 86400").describe("Duration before an email otp / link expires in seconds."),mailer_otp_length:tG.Rx().int().min(6,"Must be at least 6").max(10,"Must be no more than 10").optional().describe("Number of digits in the email OTP")}).describe("Email provider settings."),aD=tG.Ry({external_phone_enabled:tG.O7().optional().describe("This will enable phone based login for your application"),sms_provider:tG.Km(["twilio","messagebird","textlocal","vonage","twilio_verify"]).optional().describe("External provider that will handle sending SMS messages"),sms_twilio_account_sid:tG.Z_().optional(),sms_twilio_auth_token:tG.Z_().optional(),sms_twilio_message_service_sid:tG.Z_().optional(),sms_twilio_content_sid:tG.Z_().optional().describe("Twilio Content SID (Optional, For WhatsApp Only)"),sms_twilio_verify_account_sid:tG.Z_().optional(),sms_twilio_verify_auth_token:tG.Z_().optional(),sms_twilio_verify_message_service_sid:tG.Z_().optional(),sms_messagebird_access_key:tG.Z_().optional(),sms_messagebird_originator:tG.Z_().optional(),sms_textlocal_api_key:tG.Z_().optional(),sms_textlocal_sender:tG.Z_().optional(),sms_vonage_api_key:tG.Z_().optional(),sms_vonage_api_secret:tG.Z_().optional(),sms_vonage_from:tG.Z_().optional(),sms_autoconfirm:tG.O7().optional().describe("Users will need to confirm their phone number before signing in."),sms_otp_exp:tG.Rx().int().optional().describe("Duration before an SMS OTP expires in seconds."),sms_otp_length:tG.Rx().int().optional().describe("Number of digits in OTP."),sms_template:tG.Z_().optional().describe("To format the OTP code use `{{ .Code }}`"),sms_test_otp:tG.Z_().optional().describe("Register phone number and OTP combinations for testing as a comma separated list of <phone number>=<otp> pairs. Example: `18005550123=789012`"),sms_test_otp_valid_until:tG.Z_().datetime({message:"Invalid datetime string."}).optional().describe("Test phone number and OTP combinations won't be active past this date and time (local time zone).")}).describe("Phone provider settings."),az=tG.Ry({external_google_enabled:tG.O7().optional().describe("Enable Sign in with Google"),external_google_client_id:tG.Z_().regex(/^([a-z0-9-]+\.[a-z0-9-]+(\.[a-z0-9-]+)*(,[a-z0-9-]+\.[a-z0-9-]+(\.[a-z0-9-]+)*)*)$/i,"Google Client IDs should be a comma-separated list of domain-like strings.").optional(),external_google_secret:tG.Z_().regex(/^[a-z0-9.\/_-]*$/i,"Google OAuth Client Secrets usually contain letters, numbers, dots, dashes, and underscores.").optional(),external_google_skip_nonce_check:tG.O7().optional().describe("Allows ID tokens with any nonce to be accepted, which is less secure.")}),aI=az.superRefine((e,t)=>{e.external_google_enabled&&!e.external_google_client_id&&t.addIssue({code:ak.NL.custom,path:["external_google_client_id"],message:"At least one Client ID is required when Google sign-in is enabled."}),e.external_google_client_id&&e.external_google_client_id.includes(" ")&&t.addIssue({code:ak.NL.custom,path:["external_google_client_id"],message:"Client IDs should not contain spaces."})}).describe("Google provider settings.");aC.merge(aA).merge(aD).merge(az).partial();let aO=tG.Ry({secrets:tG.IX(tG.Ry({name:tG.Z_().min(1,"Secret name is required.").regex(/^[a-zA-Z_][a-zA-Z0-9_]*$/,"Must contain letters, numbers, and underscores, starting with a letter or underscore."),value:tG.Z_().min(1,"Secret value is required.")}))}).describe("Secrets schema for managing environment variables.");tG.Ry({secretNames:tG.IX(tG.Z_().min(1,"Secret name cannot be empty.")).min(1,"At least one secret name is required.")}).describe("Schema for deleting secrets by name.");let aP=e=>{if(!e||"object"!=typeof e._def||null===e._def)throw Error("unwrapZodType received an invalid Zod schema object. Check the console for the problematic schema/key.");let t=e;for(;"ZodOptional"===t._def.typeName||"ZodDefault"===t._def.typeName||"ZodNullable"===t._def.typeName||"ZodEffects"===t._def.typeName;)t="ZodEffects"===t._def.typeName?t._def.schema:t._def.innerType;return t};function aT(e){let{schema:t,onSubmit:s,isLoading:a=!1,initialValues:n,labels:r,columnInfo:l,onCancel:c}=e,d=(0,o.useRef)(!0),u=Object.keys(t.shape).reduce((e,s)=>{let a=t.shape[s];if(void 0===a)throw Error("Schema error: schema.shape['".concat(s,"'] is undefined. Check schema definition."));if("ZodDefault"===a._def.typeName)return e[s]=a._def.defaultValue(),e;let n=aP(a);switch(n._def.typeName){case"ZodString":e[s]="";break;case"ZodBoolean":e[s]=!1;break;case"ZodEnum":let r=n._def.values||[];e[s]=r.length>0?r[0]:"";break;case"ZodNumber":e[s]=0;break;case"ZodArray":e[s]=[];break;default:e[s]=void 0}return e},{}),m=(0,tK.cI)({resolver:(0,tU.F)(t),defaultValues:u});(0,o.useEffect)(()=>{if(n){d.current=!0;let e=Object.keys(t.shape).reduce((e,s)=>{let a=t.shape[s];if(void 0===a)throw Error("Schema error in useEffect: schema.shape['".concat(s,"'] is undefined."));let r=n.hasOwnProperty(s)?n[s]:void 0,l=aP(a);if("ZodBoolean"===l._def.typeName)e[s]=!!r;else if("ZodString"===l._def.typeName)e[s]=null==r?"":String(r);else if("ZodEnum"===l._def.typeName){let t=l._def.values||[];e[s]=null!=r&&t.includes(r)?String(r):t[0]||""}else if("ZodNumber"===l._def.typeName){let t=Number(r);e[s]=isNaN(t)?0:t}else if("ZodArray"===l._def.typeName){if(Array.isArray(r))e[s]=r;else if(null==r)e[s]=[];else if("string"==typeof r&&r.startsWith("{")&&r.endsWith("}"))try{let t=r.slice(1,-1);""===t.trim()?e[s]=[]:e[s]=t.split(",").map(e=>e.trim())}catch(t){e[s]=[]}else e[s]=[]}else e[s]=r;return e},{});m.reset(e),setTimeout(()=>{d.current=!1},0)}else d.current=!1},[n,m,t]);let p=(e,t,s)=>{let a=aP(t),n=a._def.typeName,o=t.description;return(0,i.jsx)(tJ.Wi,{control:m.control,name:e,render:t=>{var c,u,m,p;let{field:x}=t,h=null==r?void 0:r[e],g="string"==typeof h?h:(null==h?void 0:h.label)||e,f=(null==l?void 0:null===(c=l[e])||void 0===c?void 0:c.data_type)||"";switch(n){case"ZodString":return(0,i.jsx)(aL,{isLast:s,children:(0,i.jsxs)("div",{className:"flex w-full flex-col justify-between gap-4 lg:flex-row lg:items-center lg:gap-8",children:[(0,i.jsxs)("div",{className:"flex-1 pr-4",children:[(0,i.jsx)(tJ.lX,{children:g}),(0,i.jsx)("div",{className:"mt-1 text-sm text-muted-foreground",children:f}),o&&(0,i.jsx)(tJ.pf,{children:o}),(0,i.jsx)(tJ.zG,{})]}),(0,i.jsx)("div",{className:"lg:max-w-1/2 flex-1",children:(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(tM.I,{placeholder:"Enter your ".concat(e),...x,value:x.value||""})})})]})});case"ZodNumber":return(0,i.jsx)(aL,{isLast:s,children:(0,i.jsxs)("div",{className:"flex w-full flex-col justify-between gap-4 lg:flex-row lg:items-center lg:gap-8",children:[(0,i.jsxs)("div",{className:"flex-1 pr-4",children:[(0,i.jsx)(tJ.lX,{children:g}),(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:f}),o&&(0,i.jsx)(tJ.pf,{children:o}),(0,i.jsx)(tJ.zG,{})]}),(0,i.jsx)("div",{className:"lg:max-w-1/2 flex-1",children:(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(tM.I,{type:"number",placeholder:"Enter value for ".concat(e),...x,value:null!==(u=x.value)&&void 0!==u?u:"",onChange:e=>{let t=parseInt(e.target.value,10);x.onChange(isNaN(t)?void 0:t)}})})})]})});case"ZodBoolean":return(0,i.jsxs)(aL,{isLast:s,className:"flex flex-row items-center justify-between gap-8",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(tJ.lX,{children:g}),(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:f}),o&&(0,i.jsx)(tJ.pf,{children:o}),(0,i.jsx)(tJ.zG,{})]}),(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(e6.r,{checked:!!x.value,onCheckedChange:x.onChange})})]});case"ZodEnum":let j=a._def.values,v="object"==typeof h?h.options:void 0;return(0,i.jsx)(aL,{isLast:s,children:(0,i.jsxs)("div",{className:"flex w-full flex-col justify-between gap-4 lg:flex-row lg:items-center lg:gap-8",children:[(0,i.jsxs)("div",{className:"flex-1 pr-4",children:[(0,i.jsx)(tJ.lX,{children:g}),(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:f}),o&&(0,i.jsx)(tJ.pf,{children:o}),(0,i.jsx)(tJ.zG,{})]}),(0,i.jsx)("div",{className:"lg:max-w-1/2 flex-1",children:(0,i.jsxs)(eY.Ph,{onValueChange:e=>{d.current||x.onChange(e)},value:x.value,children:[(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(eY.i4,{children:(0,i.jsx)(eY.ki,{placeholder:"Select a ".concat(e)})})}),(0,i.jsx)(eY.Bw,{children:j.map(e=>(0,i.jsx)(eY.Ql,{value:e,children:(null==v?void 0:v[e])||e},e))})]})})]})});case"ZodArray":return(0,i.jsx)(aL,{isLast:s,children:(0,i.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-8",children:[(0,i.jsxs)("div",{className:"flex-1 pr-4",children:[(0,i.jsx)(tJ.lX,{children:g}),(0,i.jsxs)("div",{className:"text-sm text-muted-foreground",children:['Enter as JSON array: ["item1", "item2"]',(null==l?void 0:null===(m=l[e])||void 0===m?void 0:m.is_nullable)&&" (leave empty for null)"]}),o&&(0,i.jsx)(tJ.pf,{children:o}),(0,i.jsx)(tJ.zG,{})]}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(tM.I,{placeholder:(null==l?void 0:null===(p=l[e])||void 0===p?void 0:p.is_nullable)?'["item1", "item2"] or leave empty for null':'["item1", "item2"]',...x,value:null===x.value||void 0===x.value?"":Array.isArray(x.value)?JSON.stringify(x.value):x.value||"",onChange:e=>{let t=e.target.value;if(""===t.trim())x.onChange(null);else try{let e=JSON.parse(t);Array.isArray(e)?x.onChange(e):x.onChange(t)}catch(e){x.onChange(t)}}})})})]})});default:return(0,i.jsx)(i.Fragment,{})}}},e)},x=m.formState.isDirty;return(0,i.jsx)(tJ.l0,{...m,children:(0,i.jsxs)("form",{onSubmit:m.handleSubmit(s),className:"flex flex-col gap-4",children:[Object.keys(t.shape).map((e,s)=>p(e,t.shape[e],s===Object.keys(t.shape).length-1)),x&&(0,i.jsxs)(eM.j,{className:"justify-end gap-2",children:[c&&(0,i.jsx)(j.z,{variant:"outline",type:"button",onClick:c,children:"Cancel"}),(0,i.jsx)(j.z,{type:"submit",loading:a,variant:"affirmative",children:a?"Saving":"Save"})]})]})})}let aL=e=>{let{isLast:t,children:s,className:a}=e;return(0,i.jsx)(tJ.xJ,{className:(0,q.cn)("border-b pb-4",t&&"border-b-0",a),children:s})};function aR(e){let{projectRef:t,schema:s,title:a,initialValues:n,onSuccess:r}=e,{mutate:l,isPending:c}=ar(),d="shape"in s?s:s._def.schema,u=(0,o.useMemo)(()=>{if(n)return Object.keys(d.shape).reduce((e,t)=>(Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]),e),{})},[n,d]);return(0,i.jsx)("div",{className:"mx-auto w-full pb-4 pt-4",children:(0,i.jsx)(aT,{schema:d,onSubmit:e=>{let s=Object.fromEntries(Object.entries(e).filter(e=>{let[t,s]=e;return void 0!==s}));if(0===Object.keys(s).length){alert("No changes to submit. Please modify a field to update.");return}l({projectRef:t,payload:s},{onSuccess:r})},isLoading:c,initialValues:u,labels:aS})})}function aF(e){let{projectRef:t}=e,{data:s,isLoading:a,error:n}=as(t),{mutate:r,isPending:l}=ar(),{push:c,pop:d}=s$(),u=[{icon:"mail",name:"Email",description:"Allow users to sign in with their email address",enabledKey:"external_email_enabled",schema:aA},{icon:"phone_iphone",name:"Phone",description:"Allow users to sign in with their phone number",enabledKey:"external_phone_enabled",schema:aD},{icon:"google",name:"Google",description:"Allow users to sign in with their Google account",enabledKey:"external_google_enabled",schema:aI}],m=(0,o.useCallback)(e=>{c({title:"".concat(e.name),component:(0,i.jsx)(aR,{projectRef:t,schema:e.schema,title:"".concat(e.name),initialValues:s,onSuccess:()=>d()})})},[t,s,c,d]),p=(e,s)=>{r({projectRef:t,payload:{[e]:s}})},x=(0,o.useMemo)(()=>{if(s)return Object.keys(aC.shape).reduce((e,t)=>(Object.prototype.hasOwnProperty.call(s,t)&&(e[t]=s[t]),e),{})},[s]);return n?(0,i.jsx)("div",{className:"mx-6 mt-8 lg:mx-8",children:(0,i.jsxs)(sU.bZ,{variant:"destructive",children:[(0,i.jsx)(b.Z,{name:"warning",className:"h-4 w-4"}),(0,i.jsx)(sU.Cd,{children:"Error loading auth settings"}),(0,i.jsx)(sU.X,{children:"There was a problem loading your authentication configuration."})]})}):a?(0,i.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,i.jsx)(X.O,{className:"h-12 w-full"}),(0,i.jsx)(X.O,{className:"h-12 w-full"}),(0,i.jsx)(X.O,{className:"h-12 w-full"})]}):(0,i.jsxs)("div",{className:"mx-auto flex w-full flex-col gap-6 pb-6 pt-4",children:[(0,i.jsx)(aT,{schema:aC,onSubmit:e=>{let s=Object.fromEntries(Object.entries(e).filter(e=>{let[t,s]=e;return void 0!==s}));if(0===Object.keys(s).length){alert("No changes to submit. Please modify a field to update.");return}r({projectRef:t,payload:s})},isLoading:l,initialValues:x,labels:aS}),(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)("p",{className:"text-base font-medium",children:"Sign in methods"}),(0,i.jsx)("div",{className:"overflow-hidden rounded-xl border bg-background",children:u.map(e=>(0,i.jsxs)("div",{className:"flex items-center gap-4 border-b px-3 py-3 last:border-b-0",children:[(0,i.jsx)("div",{className:"flex size-12 flex-shrink-0 items-center justify-center rounded-lg bg-muted",children:(0,i.jsx)(b.Z,{name:e.icon,className:"h-4 w-4 text-muted-foreground"})}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("p",{className:"text-base font-medium",children:e.name}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]}),(0,i.jsx)(e6.r,{checked:!!(null==s?void 0:s[e.enabledKey]),onCheckedChange:t=>p(e.enabledKey,t),disabled:l}),(0,i.jsx)(j.z,{variant:"ghost",size:"icon-sm",onClick:()=>m(e),children:(0,i.jsx)(b.Z,{name:"settings",className:"h-4 w-4 text-muted-foreground"})})]},e.name))})]})]})}var aZ=s(61563);let aM=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)("div",{className:"relative w-full overflow-auto",children:(0,i.jsx)("table",{ref:t,className:(0,q.cn)("w-full caption-bottom text-sm",s),...a})})});aM.displayName="Table";let aq=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)("thead",{ref:t,className:(0,q.cn)("[&_tr]:border-b",s),...a})});aq.displayName="TableHeader";let aU=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)("tbody",{ref:t,className:(0,q.cn)("[&_tr:last-child]:border-0",s),...a})});aU.displayName="TableBody",o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)("tfoot",{ref:t,className:(0,q.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a})}).displayName="TableFooter";let aK=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)("tr",{ref:t,className:(0,q.cn)("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",s),...a})});aK.displayName="TableRow";let aG=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)("th",{ref:t,className:(0,q.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})});aG.displayName="TableHead";let aW=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)("td",{ref:t,className:(0,q.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})});function aJ(e){let{data:t,onRowClick:s,handleGoBack:a,openSqlEditor:n}=e;if(!t||0===t.length)return(0,i.jsxs)("div",{className:"flex min-h-[200px] w-full flex-col items-center justify-center gap-4",children:[(0,i.jsxs)("p",{className:"text-center text-sm text-muted-foreground",children:[(0,i.jsx)("span",{children:"No results found."})," "]}),n&&a&&(0,i.jsxs)("p",{className:"text-center text-sm text-muted-foreground",children:["Try"," ",(0,i.jsx)("button",{type:"button",className:"cursor-pointer font-medium hover:text-primary",onClick:n,children:"adjusting your query"})," ","or"," ",(0,i.jsx)("button",{type:"button",className:"cursor-pointer underline underline-offset-2 hover:text-primary",onClick:a,children:"go back"}),"."]})]});let r=Object.keys(t[0]);return(0,i.jsx)("div",{className:"overflow-auto",children:(0,i.jsxs)(aM,{children:[(0,i.jsx)(aq,{children:(0,i.jsx)(aK,{className:"hover:bg-transparent",children:r.map(e=>(0,i.jsx)(aG,{children:e},e))})}),(0,i.jsx)(aU,{children:t.map((e,t)=>(0,i.jsx)(aK,{onClick:()=>null==s?void 0:s(e),className:(0,q.cn)(s&&"group cursor-pointer hover:bg-muted/50"),children:r.map(s=>(0,i.jsx)(aW,{className:"min-w-32 text-xs text-muted-foreground group-hover:text-foreground",children:(0,i.jsx)("div",{className:"w-fit max-w-96 truncate font-mono text-xs",children:JSON.stringify(e[s]).replace(/^"|"$/g,"")})},"".concat(t,"-").concat(s)))},t))})]})})}aW.displayName="TableCell",o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)("caption",{ref:t,className:(0,q.cn)("mt-4 text-sm text-muted-foreground",s),...a})}).displayName="TableCaption";let aV=e=>{let{errorMessage:t}=e,[s,a]=(0,o.useState)(!1),n=(0,y.Z)("md");return(0,i.jsxs)(sU.bZ,{variant:"destructive",children:[(0,i.jsx)(b.Z,{name:"warning",size:"small"}),(0,i.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,i.jsx)(sU.Cd,{children:"Something went wrong"}),(0,i.jsxs)(j.z,{onClick:()=>a(e=>!e),size:"sm",variant:"secondary",children:[!n&&(s?"Hide error":"Show error"),n&&(s?"Hide":"Show")]})]}),(0,i.jsxs)(sU.X,{className:"flex flex-col items-start gap-2",children:[(0,i.jsx)("p",{children:"There was an error executing your query, please try again."}),(0,i.jsx)("div",{className:(0,q.cn)("font-mono text-xs",s?"block":"hidden"),children:t})]})]})},aB=e=>{let{title:t,description:s,children:a,className:n}=e;return(0,i.jsxs)("div",{className:(0,q.cn)("flex min-h-9 w-full items-center justify-between gap-6",n),children:[(0,i.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,i.jsx)("h3",{className:"text-base font-medium lg:text-lg",children:t}),s&&(0,i.jsx)("p",{className:"hidden text-sm text-muted-foreground lg:flex",children:s})]}),a]})},aH=e=>{let{tooltip:t,children:s,selected:a,...n}=e;return(0,i.jsxs)(ep.u,{children:[(0,i.jsx)(ep.aJ,{asChild:!0,children:(0,i.jsx)(aZ.G,{...n,className:(0,q.cn)("border data-[state=on]:border-primary",a&&"bg-accent-primary text-accent-primary-foreground hover:bg-accent-primary hover:text-accent-primary-foreground hover:opacity-80",n.className),children:s})}),(0,i.jsx)(ep._v,{children:t})]})},aQ=e=>{let{isChartVisible:t,setIsChartVisible:s,xAxisColumn:a,setXAxisColumn:n,yAxisColumn:r,setYAxisColumn:l,columns:o,selected:c}=e;return(0,i.jsxs)(si.J2,{children:[(0,i.jsx)(si.xo,{asChild:!0,children:(0,i.jsx)(aH,{selected:c,value:"chart","aria-label":"Chart",tooltip:"Visualize your data with a chart",children:(0,i.jsx)(b.Z,{name:"bar_chart",size:"small"})})}),(0,i.jsx)(si.yk,{className:"w-80",align:"end",children:(0,i.jsx)("div",{className:"grid gap-4",children:(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)(t5.Label,{className:"mb-2 block flex-1",children:"Show Chart"}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Visualize your data with a chart."})]}),(0,i.jsx)(e6.r,{id:"show-chart",className:"mb-0",checked:t,onCheckedChange:s})]}),t&&(0,i.jsxs)("div",{className:"mt-2",children:[(0,i.jsxs)("div",{className:"mb-2 grid grid-cols-3 items-center gap-4",children:[(0,i.jsx)(t5.Label,{htmlFor:"x-axis",children:"X-Axis"}),(0,i.jsxs)(eY.Ph,{onValueChange:n,defaultValue:a||void 0,children:[(0,i.jsx)(eY.i4,{className:"col-span-2 h-8",id:"x-axis",children:(0,i.jsx)(eY.ki,{placeholder:"Select column"})}),(0,i.jsx)(eY.Bw,{children:o.map(e=>(0,i.jsx)(eY.Ql,{value:e,children:e},e))})]})]}),(0,i.jsxs)("div",{className:"mb-2 grid grid-cols-3 items-center gap-4",children:[(0,i.jsx)(t5.Label,{htmlFor:"y-axis",children:"Y-Axis"}),(0,i.jsxs)(eY.Ph,{onValueChange:l,defaultValue:r||void 0,children:[(0,i.jsx)(eY.i4,{className:"col-span-2 h-8",id:"y-axis",children:(0,i.jsx)(eY.ki,{placeholder:"Select column"})}),(0,i.jsx)(eY.Bw,{children:o.map(e=>(0,i.jsx)(eY.Ql,{value:e,children:e},e))})]})]})]})]})})})]})},aY=e=>{let{naturalLanguageQuery:t,setNaturalLanguageQuery:s,handleRunNaturalLanguageQuery:a,isGeneratingSql:n,isPending:r,placeholder:l="Ask Lovable to show me..."}=e;return(0,i.jsxs)("div",{className:"flex items-center gap-3 rounded-3xl border border-muted-border bg-muted px-4 py-1",children:[(0,i.jsx)(b.Z,{name:"wand_stars",size:"small"}),(0,i.jsx)(tM.I,{placeholder:l,value:t,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),a())},className:"rounded-none border-none bg-transparent px-0 py-4 shadow-none focus-visible:ring-0 focus-visible:ring-offset-0"}),(0,i.jsx)(j.z,{onClick:a,disabled:n||r||!t.trim(),className:"shrink-0 rounded-full p-0",size:"icon-xs",children:n||r?(0,i.jsx)(Z.$,{size:"small"}):(0,i.jsx)(b.Z,{name:"arrow_upward",size:"small"})})]})};function aX(e){let{data:t,xAxis:s,yAxis:a}=e;return(0,i.jsx)(G,{config:{[a]:{label:a,color:"var(--chart-1)"}},className:"aspect-auto h-[250px] w-full",children:(0,i.jsxs)(O.v,{accessibilityLayer:!0,data:t,margin:{left:-24,right:12},children:[(0,i.jsx)(P.q,{vertical:!1}),(0,i.jsx)(T.K,{dataKey:s,tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:32}),(0,i.jsx)(L.B,{dataKey:a,tickLine:!1,axisLine:!1,tickMargin:8,tickCount:5,allowDecimals:!1}),(0,i.jsx)(J,{content:(0,i.jsx)(V,{className:"w-[150px]",indicator:"dot"})}),(0,i.jsx)(F.$,{dataKey:a,fill:"var(--color-".concat(a,")")})]})})}var a$=s(76003),a0=s(78298),a1=s(90962);let a2=e=>{let{sql:t,setSql:s,isPending:a,handleRunQuery:n}=e,{resolvedTheme:r}=(0,a0.F)(),l="dark"===r?a1.Lm:a1.C0;return(0,i.jsxs)("div",{className:"relative min-h-[200px] overflow-hidden border-b border-t bg-muted",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("p",{className:"py-2 pl-2 text-sm font-medium text-muted-foreground",children:"SQL Editor"}),(0,i.jsxs)(ep.u,{children:[(0,i.jsx)(ep.aJ,{className:"text-muted-foreground",children:(0,i.jsx)(b.Z,{name:"info",size:"small"})}),(0,i.jsx)(ep._v,{className:"max-w-[40ch]",children:(0,i.jsx)("p",{children:"You can write SQL queries here. You can also use the natural language input to generate SQL queries."})})]})]}),(0,i.jsx)(a$.ZP,{height:"100%",value:t,onChange:e=>s(e||""),theme:l,className:"h-full bg-transparent text-xs",extensions:a1.A4}),(0,i.jsx)(j.z,{size:"sm",onClick:n,disabled:a,className:"absolute bottom-4 right-4",children:a?"Running...":"Run Query"})]})};function a5(e){var t,s;let{projectRef:a,initialSql:n,queryKey:r,onResults:l,onRowClick:c,label:d="Query your data",description:u,hideSql:m=!1,readOnly:p=!1,runAutomatically:x=!1,refetch:h,initialNaturalLanguageMode:g=!1,hideChartOption:f=!1,className:j,naturalLanguagePlaceholder:v}=e,[y,w]=(0,o.useState)(n||""),[N,_]=(0,o.useState)(!m),[k,S]=(0,o.useState)(g),[C,E]=(0,o.useState)(""),{mutate:A,data:D,isPending:z,error:I}=ai(),[O,P]=(0,o.useState)(!1),[T,L]=(0,o.useState)(null),[R,F]=(0,o.useState)(!1),[Z,M]=(0,o.useState)(null),[U,K]=(0,o.useState)(null),G=(0,o.useMemo)(()=>D&&0!==D.length&&D[0]?Object.keys(D[0]):[],[D]);(0,o.useEffect)(()=>{n&&w(n)},[n]);let W=async()=>{if(C){P(!0),L(null);try{let e=await fetch("/api/ai/sql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:C,projectRef:a})});if(!e.ok){let t=await e.json();throw Error(t.message||"Failed to generate SQL")}let{sql:t}=await e.json();w(t),A({projectRef:a,query:t,readOnly:!0})}catch(e){console.error(e),L(e.message)}finally{P(!1)}}},J=(0,o.useCallback)(()=>{y&&A({projectRef:a,query:y,readOnly:!0})},[y,a,A]);(0,o.useEffect)(()=>{_(!m)},[m]),(0,o.useEffect)(()=>{x&&n&&A({projectRef:a,query:n,readOnly:!0})},[x,n,a,A]),(0,o.useEffect)(()=>{h&&h>0&&J()},[h,J]),(0,o.useEffect)(()=>{l&&l(D)},[D,l]),(0,o.useEffect)(()=>{!(!D||Array.isArray(D)&&0===D.length)||N||k||p||z||_(!0)},[D,N,k,p,z]);let V=(null==I?void 0:null===(s=I.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"",B=V.includes("permission denied")||V.includes("42501"),H=(0,o.useMemo)(()=>{let e=[];return k&&e.push("chat"),N&&e.push("sql"),!f&&R&&e.push("chart"),e},[k,N,R,f]),{pop:Q}=s$(),Y=!f&&D&&R&&Z&&U;return(0,i.jsxs)("div",{className:(0,q.cn)("flex flex-col gap-6",j),children:[(0,i.jsx)(aB,{title:d,description:u,children:(0,i.jsxs)(aZ.t,{type:"multiple",size:"sm",value:H,onValueChange:e=>{S(e.includes("chat")),_(e.includes("sql")),f||F(e.includes("chart"))},className:"gap-1",children:[(0,i.jsx)(aH,{value:"sql","aria-label":"SQL",tooltip:"Open SQL editor to write your own queries",selected:H.includes("sql"),children:(0,i.jsx)(b.Z,{name:"article",size:"small"})}),!f&&(0,i.jsx)(aQ,{isChartVisible:R,setIsChartVisible:F,xAxisColumn:Z,setXAxisColumn:M,yAxisColumn:U,setYAxisColumn:K,columns:G,selected:H.includes("chart")})]})}),k&&(0,i.jsx)(aY,{naturalLanguageQuery:C,setNaturalLanguageQuery:E,handleRunNaturalLanguageQuery:W,isGeneratingSql:O,isPending:z,placeholder:v}),N&&(0,i.jsx)(a2,{sql:y,setSql:w,isPending:z,handleRunQuery:J}),z&&(0,i.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,i.jsx)(X.O,{className:"h-6 w-full"}),(0,i.jsx)(X.O,{className:"h-6 w-full"}),(0,i.jsx)(X.O,{className:"h-6 w-full"}),(0,i.jsx)(X.O,{className:"h-6 w-full"})]}),T&&(0,i.jsx)(aV,{errorMessage:T}),I&&(0,i.jsxs)(sU.bZ,{variant:"destructive",children:[(0,i.jsx)(b.Z,{name:"warning",size:"small"}),(0,i.jsx)(sU.Cd,{children:"Query Error"}),(0,i.jsx)(sU.X,{children:B?"You can't directly alter your database schema, use chat instead":V||(null==I?void 0:I.message)||"An unexpected error occurred"})]}),Y&&(0,i.jsx)(aX,{data:D,xAxis:Z,yAxis:U}),D&&(0,i.jsx)(aJ,{data:D,onRowClick:c?e=>null==c?void 0:c(e,r):void 0,handleGoBack:()=>Q(),openSqlEditor:()=>_(!0)})]})}var a4=s(66070);let a3=o.forwardRef((e,t)=>{let{onClick:s,icon:a,title:n,description:r,className:l,badge:o,...c}=e;return(0,i.jsxs)(a4.Zb,{className:(0,q.cn)("flex cursor-pointer flex-row items-center gap-4 rounded-2xl border-none bg-transparent p-2 text-left shadow-none hover:bg-accent",l),onClick:s,ref:t,...c,children:[(0,i.jsx)("div",{className:"flex size-12 flex-shrink-0 items-center justify-center rounded-lg bg-muted",children:(0,i.jsx)(b.Z,{name:a,size:"small"})}),(0,i.jsxs)("div",{className:"flex flex-col gap-1 py-1",children:[(0,i.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,i.jsx)("h2",{className:"truncate text-lg font-medium leading-tight",children:n}),o]}),(0,i.jsx)("div",{className:"shrink-0 text-sm font-normal leading-none text-muted-foreground",children:r})]})]})});a3.displayName="NavigationCard";let a6=e=>e&&e.primary_keys?e.primary_keys.map(e=>e.name):[];function a7(e){let{projectRef:t,table:s,row:a,onSuccess:n}=e,{mutate:r,isPending:l}=ai(),c=(0,o.useMemo)(()=>(function(e){if(!e||!e.columns)return tG.Ry({});let t={};for(let s of e.columns){let e;if(!s.is_updatable||s.is_generated)continue;let a=s.data_type.toLowerCase();e=a.includes("array")?tG.IX(tG.Yj()):a.includes("int")||a.includes("numeric")?tG.Rx():a.includes("bool")?tG.O7():"user-defined"===a&&s.enums&&Array.isArray(s.enums)&&s.enums.length>0?tG.Km(s.enums):tG.Z_(),s.is_nullable&&(e=e.nullish()),t[s.name]=e}return tG.Ry(t)})(s),[s]),d=(0,o.useMemo)(()=>{if(!s||!s.columns)return{};let e={};for(let t of s.columns){if(!t.is_updatable||t.is_generated)continue;let s=t.data_type.toLowerCase(),a="user-defined"===s&&t.enums&&Array.isArray(t.enums)&&t.enums.length>0?"enum":s;e[t.name]={data_type:a,is_nullable:t.is_nullable}}return e},[s]),{pop:u}=s$(),m=(0,o.useCallback)(e=>{let l=a6(s);if(0===l.length){eT.Am.error("Cannot update row. This table does not have a primary key.");return}let i=Object.entries(e).map(e=>{var t;let n,[r,l]=e;if(JSON.stringify(a[r])===JSON.stringify(l))return null;let i=s.columns.find(e=>e.name===r),o=(null==i?void 0:null===(t=i.data_type)||void 0===t?void 0:t.toLowerCase())||"",c=(null==i?void 0:i.is_nullable)||!1;if(null==l||"string"==typeof l&&""===l.trim()){if(c)n="NULL";else if(o.includes("array")){let e=JSON.stringify({[r]:[]});n="(select ".concat(r,' from json_populate_record(null::public."').concat(s.name,"\", '").concat(e.replace(/'/g,"''"),"'))")}else n="''"}else if(Array.isArray(l)&&0===l.length){let e=JSON.stringify({[r]:[]});n="(select ".concat(r,' from json_populate_record(null::public."').concat(s.name,"\", '").concat(e.replace(/'/g,"''"),"'))")}else if(o.includes("array")){let e=JSON.stringify({[r]:l});n="(select ".concat(r,' from json_populate_record(null::public."').concat(s.name,"\", '").concat(e.replace(/'/g,"''"),"'))")}else n="user-defined"===o&&(null==i?void 0:i.enums)?"'".concat(String(l).replace(/'/g,"''"),"'"):"string"==typeof l?"'".concat(l.replace(/'/g,"''"),"'"):l;return'"'.concat(r,'" = ').concat(n)}).filter(Boolean).join(", ");if(!i){eT.Am.error("No changes to save"),n();return}let o=l.map(e=>{let t=a[e],s="string"==typeof t?"'".concat(t.replace(/'/g,"''"),"'"):t;return'"'.concat(e,'" = ').concat(s)}).join(" AND ");r({projectRef:t,query:'UPDATE public."'.concat(s.name,'" SET ').concat(i," WHERE ").concat(o,";"),readOnly:!1},{onSuccess:n})},[t,s,a,r,n]);return(0,i.jsxs)("div",{className:"flex flex-col gap-6 pb-12",children:[(0,i.jsx)(aB,{title:"Editing row in ".concat(s.name)}),(0,i.jsx)(aT,{schema:c,initialValues:a,onSubmit:m,isLoading:l,columnInfo:d,onCancel:u})]})}function a8(e){let{projectRef:t,table:s}=e,{push:a,pop:n}=s$(),[r,l]=(0,o.useState)(0),c=(0,o.useCallback)(e=>{a({title:"Editing row",component:(0,i.jsx)(a7,{projectRef:t,table:s,row:e,onSuccess:()=>{n(),l(e=>e+1)}})})},[a,n,t,s]);return(0,i.jsx)(a5,{hideChartOption:!0,projectRef:t,label:"View records in ".concat(s.name),description:"Click a row to edit it.",initialSql:'SELECT * FROM public."'.concat(s.name,'" LIMIT 100;'),queryKey:s.id,onRowClick:c,hideSql:!0,runAutomatically:!0,refetch:r,readOnly:!0})}function a9(e){let{projectRef:t}=e,{push:s}=s$(),{data:a,isLoading:n,isError:r}=ac(t,["public"]),l=(0,o.useCallback)(e=>{s({title:e.name,component:(0,i.jsx)(a8,{projectRef:t,table:e})})},[s,t]);return(0,o.useCallback)(()=>{s({title:"Talk to your database",component:(0,i.jsx)(a5,{projectRef:t,initialNaturalLanguageMode:!0,hideSql:!0})})},[s,t]),(0,i.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,i.jsx)(aB,{title:"Database",description:"View and manage the data stored in your app."}),r&&(0,i.jsxs)(sU.bZ,{variant:"destructive",className:"mt-8",children:[(0,i.jsx)(b.Z,{name:"warning",size:"small"}),(0,i.jsx)(sU.Cd,{children:"Error loading tables"}),(0,i.jsx)(sU.X,{children:"There was a problem loading your database tables."})]}),n&&(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-4 xl:grid-cols-2",children:[(0,i.jsx)(X.O,{className:"h-16 w-full rounded-2xl"}),(0,i.jsx)(X.O,{className:"h-16 w-full rounded-2xl"}),(0,i.jsx)(X.O,{className:"h-16 w-full rounded-2xl"})]}),a&&a.length>0?(0,i.jsx)("div",{className:"grid grid-cols-1 gap-2 lg:grid-cols-2",children:a.map(e=>(0,i.jsx)(a3,{onClick:()=>l(e),icon:"table",title:e.name,description:"".concat(e.live_rows_estimate," rows")},e.id))}):n||a&&0!==a.length?null:(0,i.jsxs)(sU.bZ,{className:"mt-8",children:[(0,i.jsx)(b.Z,{name:"table",size:"small"}),(0,i.jsx)(sU.Cd,{children:"No database tables"}),(0,i.jsx)(sU.X,{children:"Create tables to store and organize your data."})]})]})}var ne=s(23518);(a=r||(r={})).FN_EDGE="function_edge_logs",a.AUTH="auth_logs",a.POSTGRES="postgres_logs",a.REALTIME="realtime_logs",a.STORAGE="storage_logs",a.PG_CRON="pg_cron_logs",a.EDGE="edge_logs",a.FUNCTIONS="function_logs",a.POSTGREST="postgrest_logs",a.SUPAVISOR="supavisor_logs",a.PGBOUNCER="pgbouncer_logs",a.WAREHOUSE="warehouse_logs",a.PG_UPGRADE="pg_upgrade_logs";let nt=e=>{switch(e){case"edge_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.request) as request\n  cross join unnest(m.response) as response";case"postgres_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.parsed) as parsed";case"function_logs":case"auth_logs":return"cross join unnest(metadata) as metadata";case"function_edge_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.response) as response\n  cross join unnest(m.request) as request";case"supavisor_logs":return"cross join unnest(metadata) as m";default:return""}},ns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=nt(e),a="order by timestamp desc";switch(e){case"edge_logs":return"select id, ".concat(e,".timestamp, event_message, request.method, request.path, request.search, response.status_code\nfrom ").concat(e,"\n").concat(s,"\n").concat(a,"\nlimit ").concat(t);case"postgres_logs":return"select ".concat(e,".timestamp, id, event_message, parsed.error_severity, parsed.detail, parsed.hint\nfrom ").concat(e,"\n").concat(s,"\n").concat(a,"\nlimit ").concat(t);case"function_logs":return"select id, ".concat(e,".timestamp, event_message, metadata.event_type, metadata.function_id, metadata.level\nfrom ").concat(e,"\n").concat(s,"\n").concat(a,"\nlimit ").concat(t);case"auth_logs":return"select id, ".concat(e,".timestamp, event_message, metadata.level, metadata.status, metadata.path, metadata.msg as msg, metadata.error\nfrom ").concat(e,"\n").concat(s,"\n").concat(a,"\nlimit ").concat(t);case"function_edge_logs":return"select id, ".concat(e,".timestamp, event_message, response.status_code, request.method, m.function_id, m.execution_time_ms, m.deployment_id, m.version\nfrom ").concat(e,"\n").concat(s,"\n").concat(a,"\nlimit ").concat(t);case"supavisor_logs":case"pg_upgrade_logs":default:return"select id, ".concat(e,".timestamp, event_message\nfrom ").concat(e,"\n").concat(s,"\n").concat(a,"\nlimit ").concat(t);case"pg_cron_logs":return"select postgres_logs.timestamp, id, event_message, parsed.error_severity, parsed.query\nfrom postgres_logs\ncross join unnest(metadata) as m\ncross join unnest(m.parsed) as parsed\nwhere (parsed.application_name = 'pg_cron' OR event_message LIKE '%cron job%')\n".concat(a,"\nlimit ").concat(t)}};var na=s(5073);let nn=e=>{let{logs:t}=e;return t&&t.result&&0!==t.result.length?(0,i.jsxs)(aM,{className:"w-full overflow-auto",children:[(0,i.jsx)(aq,{children:(0,i.jsx)(aK,{className:"hover:bg-transparent",children:Object.keys(t.result[0]).map((e,t,s)=>(0,i.jsx)(aG,{children:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())},e))})}),(0,i.jsx)(aU,{children:t.result.map((e,s)=>{var a,n;return(0,i.jsx)(aK,{className:"group relative hover:bg-muted/50",children:Object.keys(null!==(n=null===(a=t.result)||void 0===a?void 0:a[0])&&void 0!==n?n:[]).map((t,s,a)=>{let n=e[t],r="timestamp"===t&&"number"==typeof n?new Date(n/1e3).toLocaleString():null===n?"NULL":"object"==typeof n?JSON.stringify(n,null,2):String(n);return(0,i.jsx)(aW,{className:"min-w-32 text-xs text-muted-foreground group-hover:text-foreground",children:(0,i.jsxs)(na.zs,{children:[(0,i.jsx)(na.Yi,{asChild:!0,children:(0,i.jsx)("div",{className:"w-fit max-w-96 cursor-default truncate font-mono text-xs",children:r})}),(0,i.jsx)(na.bZ,{className:"max-h-96 w-96 overflow-auto p-3",children:(0,i.jsx)("pre",{className:"whitespace-pre-wrap break-words font-mono text-xs",children:r})})]})},t)})},e.id||s)})})]}):null},nr=[{value:r.FN_EDGE,label:"Function Edge Logs",description:"Edge function execution logs with request/response data"},{value:r.AUTH,label:"Authentication Logs",description:"User authentication events and security logs"},{value:r.POSTGRES,label:"PostgreSQL Logs",description:"Database queries, errors, and performance metrics"},{value:r.REALTIME,label:"Realtime Logs",description:"WebSocket connections and realtime subscriptions"},{value:r.STORAGE,label:"Storage Logs",description:"File uploads, downloads, and storage operations"},{value:r.PG_CRON,label:"Cron Job Logs",description:"Scheduled job executions and cron task logs"},{value:r.EDGE,label:"Edge Logs",description:"HTTP requests and responses from Edge Functions"},{value:r.FUNCTIONS,label:"Function Logs",description:"Serverless function execution logs and events"},{value:r.POSTGREST,label:"PostgREST Logs",description:"API requests to your database through PostgREST"},{value:r.SUPAVISOR,label:"Supavisor Logs",description:"Connection pooling and database proxy logs"},{value:r.PGBOUNCER,label:"PgBouncer Logs",description:"Legacy connection pooling logs"},{value:r.WAREHOUSE,label:"Warehouse Logs",description:"Data warehouse operations and analytics"},{value:r.PG_UPGRADE,label:"PostgreSQL Upgrade Logs",description:"Database upgrade processes and migration logs"}];function nl(e){var t;let{projectRef:s}=e,[a,n]=(0,o.useState)(r.FN_EDGE),[l,c]=(0,o.useState)(!1),{data:d,isLoading:u,error:m}=ap(s,{sql:(0,o.useMemo)(()=>ns(a),[a])}),p=nr.find(e=>e.value===a);return(0,i.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,i.jsx)(aB,{title:"Logs",description:"Debug errors and track activity in your app",children:(0,i.jsxs)(si.J2,{open:l,onOpenChange:c,children:[(0,i.jsx)(si.xo,{asChild:!0,children:(0,i.jsxs)(j.z,{variant:"outline",role:"combobox","aria-expanded":l,children:[p?p.label:"Select log type...",(0,i.jsx)(b.Z,{name:"chevron_down",size:"small",className:"text-muted-foreground"})]})}),(0,i.jsx)(si.yk,{className:"w-80 p-0",align:"end",children:(0,i.jsxs)(ne.mY,{children:[(0,i.jsx)(ne.sZ,{placeholder:"Search log types...",className:"h-9"}),(0,i.jsxs)(ne.e8,{className:"max-h-60 overflow-y-auto",onWheel:e=>{e.stopPropagation()},style:{overscrollBehavior:"contain"},children:[(0,i.jsx)(ne.rb,{children:"No log type found."}),(0,i.jsx)(ne.fu,{children:nr.map(e=>(0,i.jsxs)(ne.di,{value:e.value,onSelect:e=>{n(e),c(!1)},className:"flex items-center gap-2 p-3",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("div",{className:"mb-1 text-xs font-medium leading-none",children:e.label}),(0,i.jsx)("div",{className:"text-xs leading-snug text-muted-foreground",children:e.description})]}),(0,i.jsx)(b.Z,{name:"check",size:"small",className:(0,q.cn)("mt-0.5",a===e.value?"opacity-100":"opacity-0")})]},e.value))})]})]})})]})}),u&&(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)(X.O,{className:"h-6 w-full"}),(0,i.jsx)(X.O,{className:"h-6 w-full"}),(0,i.jsx)(X.O,{className:"h-6 w-full"}),(0,i.jsx)(X.O,{className:"h-6 w-full"})]}),(m||d&&d.error)&&(0,i.jsxs)(sU.bZ,{variant:"destructive",children:[(0,i.jsx)(b.Z,{name:"terminal",size:"small"}),(0,i.jsx)(sU.Cd,{children:"Error fetching logs"}),(0,i.jsx)(sU.X,{children:(null==m?void 0:m.message)||"object"==typeof(null==d?void 0:d.error)&&(null===(t=d.error)||void 0===t?void 0:t.message)||"An unexpected error occurred. Please try again."})]}),(0,i.jsx)(nn,{logs:d}),d&&d.result&&0===d.result.length&&(0,i.jsxs)(sU.bZ,{variant:"secondary",children:[(0,i.jsx)(b.Z,{name:"data_table",size:"small"}),(0,i.jsx)(sU.Cd,{children:"No logs found"}),(0,i.jsx)(sU.X,{children:"Logs will appear here when your application generates activity."})]})]})}function ni(e){let{projectRef:t}=e,{data:s,isLoading:a,error:n}=ab(t),{mutate:r,isPending:l}=aw(),{mutate:o,isPending:c}=a_(),d=(0,tK.cI)({resolver:(0,tU.F)(aO),defaultValues:{secrets:[{name:"",value:""}]}}),{fields:u,append:m,remove:p}=(0,tK.Dq)({control:d.control,name:"secrets"}),x=e=>{window.confirm('Are you sure you want to delete the secret "'.concat(e,'"?'))&&o({projectRef:t,secretNames:[e]})};return a?(0,i.jsxs)("div",{className:"mx-auto w-full max-w-4xl space-y-4 p-12",children:[(0,i.jsx)(X.O,{className:"h-48 w-full"}),(0,i.jsx)(X.O,{className:"h-16 w-full"}),(0,i.jsx)(X.O,{className:"h-16 w-full"})]}):n?(0,i.jsx)("div",{className:"mx-6 mt-8 lg:mx-8",children:(0,i.jsxs)(sU.bZ,{variant:"destructive",children:[(0,i.jsx)(b.Z,{name:"warning",className:"h-4 w-4"}),(0,i.jsx)(sU.Cd,{children:"Error loading secrets"}),(0,i.jsx)(sU.X,{children:"There was a problem loading your secrets configuration."})]})}):(0,i.jsxs)("div",{className:"mx-auto w-full max-w-3xl pt-4 lg:pt-12",children:[(0,i.jsxs)("div",{className:"mb-16",children:[(0,i.jsx)("h2",{className:"font-semibold mb-1 text-base lg:text-xl",children:"Add New Secret"}),(0,i.jsx)("p",{className:"mb-6 text-sm text-muted-foreground lg:text-base",children:"Add sensitive information like API keys that your app needs to work securely."}),(0,i.jsx)(tJ.l0,{...d,children:(0,i.jsxs)("form",{onSubmit:d.handleSubmit(e=>{r({projectRef:t,secrets:e.secrets},{onSuccess:()=>{d.reset({secrets:[{name:"",value:""}]})}})}),children:[u.map((e,t)=>(0,i.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,i.jsx)(tJ.Wi,{control:d.control,name:"secrets.".concat(t,".name"),render:e=>{let{field:s}=e;return(0,i.jsxs)(tJ.xJ,{className:(0,q.cn)("relative flex-1",{"mt-3":0!==t}),children:[0===t&&(0,i.jsx)(tJ.lX,{className:"mb-4",children:"Name"}),(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(tM.I,{placeholder:"SECRET_NAME",...s})}),(0,i.jsx)(tJ.zG,{className:"absolute left-[1px]",style:{marginTop:"3px"}})]})}}),(0,i.jsx)(tJ.Wi,{control:d.control,name:"secrets.".concat(t,".value"),render:e=>{let{field:s}=e;return(0,i.jsxs)(tJ.xJ,{className:(0,q.cn)("relative flex-1",{"mt-3":0!==t}),children:[0===t&&(0,i.jsx)(tJ.lX,{className:"mb-4",children:"Value"}),(0,i.jsx)(tJ.NI,{children:(0,i.jsx)(tM.I,{type:"password",placeholder:"••••••••",...s})}),(0,i.jsx)(tJ.zG,{className:"absolute left-[1px]",style:{marginTop:"3px"}})]})}}),(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[0===t&&(0,i.jsx)(tJ.lX,{className:"mb-4 opacity-0",children:"Remove"}),(0,i.jsx)(j.z,{type:"button",variant:"outline",className:(0,q.cn)("h-9",{"mt-3":0!==t}),onClick:()=>{1===u.length?(d.setValue("secrets.0.name",""),d.setValue("secrets.0.value","")):p(t)},children:(0,i.jsx)(b.Z,{name:"remove",className:"h-4 w-4"})})]})]},e.id)),(0,i.jsx)("div",{className:"mt-7 flex items-center",children:(0,i.jsxs)(j.z,{type:"button",variant:"outline",size:"sm",onClick:()=>m({name:"",value:""}),children:[(0,i.jsx)(b.Z,{name:"add",className:"mr-1 h-4 w-4"}),"Add Secret"]})}),(()=>{let e=d.watch("secrets");return(null==e?void 0:e.some(e=>{var t,s;return(null===(t=e.name)||void 0===t?void 0:t.trim())&&(null===(s=e.value)||void 0===s?void 0:s.trim())}))?(0,i.jsx)(eM.j,{className:"justify-end gap-2",children:(0,i.jsx)(j.z,{type:"submit",loading:l,variant:"affirmative",children:l?"Creating...":"Create Secrets"})}):null})()]})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"font-semibold mb-4 lg:text-lg",children:"Existing secrets"}),s&&s.length>0?s.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between border-b py-4 last:border-b-0",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-mono text-sm tracking-wider",children:e.name}),e.updated_at&&(0,i.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["Last updated: ",new Date(e.updated_at).toLocaleString()]})]}),(0,i.jsx)(j.z,{variant:"outline",size:"sm",onClick:()=>x(e.name),disabled:c,children:"Delete"})]},e.name)):(0,i.jsxs)(sU.bZ,{children:[(0,i.jsx)(b.Z,{name:"key",className:"h-4 w-4"}),(0,i.jsx)(sU.Cd,{children:"No secrets found"}),(0,i.jsx)(sU.X,{children:"No secrets found for this project."})]})]})]})}function no(e){let{projectRef:t}=e,{data:s,isLoading:a,isError:n}=au(t);return(0,i.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,i.jsx)(aB,{title:"Storage",description:"View and manage the files stored in your app."}),n&&(0,i.jsxs)(sU.bZ,{variant:"destructive",children:[(0,i.jsx)(b.Z,{name:"warning",className:"h-4 w-4"}),(0,i.jsx)(sU.Cd,{children:"Error loading buckets"}),(0,i.jsx)(sU.X,{children:"There was a problem loading your storage buckets."})]}),a&&(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-4 xl:grid-cols-2",children:[(0,i.jsx)(X.O,{className:"h-16 w-full rounded-2xl"}),(0,i.jsx)(X.O,{className:"h-16 w-full rounded-2xl"}),(0,i.jsx)(X.O,{className:"h-16 w-full rounded-2xl"})]}),s&&s.length>0?(0,i.jsx)("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:s.map(e=>(0,i.jsxs)(ep.u,{children:[(0,i.jsx)(ep.aJ,{asChild:!0,children:(0,i.jsx)(a3,{onClick:()=>{},icon:"folder",title:e.name,description:"Updated ".concat(new Date(e.updated_at).toLocaleDateString()),badge:(0,i.jsx)(sS.C,{variant:"secondary",children:e.public?"Public":"Private"})})}),(0,i.jsx)(ep._v,{children:(0,i.jsx)("p",{children:"Viewing files is coming soon"})})]},e.id))}):s&&0===s.length?(0,i.jsxs)(sU.bZ,{variant:"secondary",children:[(0,i.jsx)(b.Z,{name:"folder",className:"h-4 w-4"}),(0,i.jsx)(sU.Cd,{children:"No storage buckets"}),(0,i.jsx)(sU.X,{children:"A bucket is a container used to store and protect files in your app."})]}):null]})}var nc=s(40236);function nd(e){let{projectRef:t}=e,{data:s,isLoading:a,error:n,hasWarningsOrErrors:r}=aj(t),l=(0,sO.D)(),{closeSettings:c}=(0,te.r)(),d=(0,sH.bk)(e=>e.isSendChatMessageMutationPending),u=(0,sV.mo)({projectId:l}),m=u.isPending,p=(0,o.useMemo)(()=>{if(!s)return[];let e={ERROR:1,WARN:2,INFO:3};return[...s].sort((t,s)=>(e[t.level]||99)-(e[s.level]||99))},[s]),x=e=>{switch(e){case"ERROR":return"destructive";case"WARN":return"warning";default:return"outline"}},h=e=>{if(!e.type)return e.level;let t=e.type.charAt(0).toUpperCase()+e.type.slice(1),s="warn"===e.level.toLowerCase()?"warning":e.level.toLowerCase();return"".concat(t," ").concat(s)};return(0,i.jsxs)("div",{className:"mx-auto flex flex-col gap-4",children:[a&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(X.O,{className:"h-6 w-full"}),(0,i.jsx)(X.O,{className:"h-6 w-full"}),(0,i.jsx)(X.O,{className:"h-6 w-full"}),(0,i.jsx)(X.O,{className:"h-6 w-full"})]}),n&&(0,i.jsxs)(sU.bZ,{variant:"destructive",className:"mt-8",children:[(0,i.jsx)(b.Z,{name:"code",className:"h-4 w-4"}),(0,i.jsx)(sU.Cd,{children:"Error fetching suggestions"}),(0,i.jsx)(sU.X,{children:(null==n?void 0:n.message)||"An unexpected error occurred. Please try again."})]}),r&&(0,i.jsxs)(sU.bZ,{variant:"warning",className:"flex flex-row items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,i.jsx)(b.Z,{name:"warning",className:"h-4 w-4"}),(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsx)(sU.Cd,{className:"mb-0",children:"Security issues detected"}),(0,i.jsx)(sU.X,{children:"These issues may impact user privacy and data integrity."})]})]}),(0,i.jsx)(e3.b,{showTooltip:d,tooltipContent:"Wait for Lovable to finish working",children:(0,i.jsx)(j.z,{size:"sm",onClick:()=>{u.mutate({body:{message:"Please perform a comprehensive security review of my project.",id:(0,sB.Fd)(),security_review:!0,chat_only:!0}}),c()},disabled:m||d,loading:m,variant:"warning",children:"Review Security"})})]}),s&&(0,i.jsx)("div",{className:"flex flex-col gap-4 px-1",children:p.length>0?(0,i.jsx)("div",{children:p.map(e=>(0,i.jsx)("div",{className:"group relative border-b py-4 last:border-b-0",children:(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("div",{className:"flex items-start justify-start gap-4",children:[(0,i.jsx)("h4",{className:"font-semibold text-sm",children:e.title}),(0,i.jsx)("div",{className:"flex items-center gap-1",children:(0,i.jsx)(sS.C,{variant:x(e.level),className:"shrink-0",children:h(e)})})]}),(0,i.jsx)("div",{className:"prose prose-sm mt-2 max-w-none text-sm text-muted-foreground",children:(0,i.jsx)(nc.UG,{components:{code(e){let{inline:t,children:s,...a}=e;return t?(0,i.jsx)("code",{className:"rounded bg-muted px-1",...a,children:s}):(0,i.jsx)("pre",{className:"overflow-x-auto rounded bg-muted p-2",...a,children:(0,i.jsx)("code",{children:s})})}},children:e.detail})})]})},e.cache_key))}):(0,i.jsxs)(sU.bZ,{children:[(0,i.jsx)(b.Z,{name:"lightbulb_2",className:"h-4 w-4"}),(0,i.jsx)(sU.Cd,{children:"No suggestions found"}),(0,i.jsx)(sU.X,{children:"Your project looks good! No suggestions at this time."})]})})]})}let nu={users:{label:"New Users",color:"var(--chart-1)"}};function nm(e){let{projectRef:t,timeRange:s}=e,{data:a,isLoading:n,isError:r}=ah(t,s);return(0,i.jsxs)("div",{children:[n&&(0,i.jsx)(X.O,{className:"h-[250px] w-full"}),r&&(0,i.jsxs)(sU.bZ,{variant:"destructive",children:[(0,i.jsx)(b.Z,{name:"warning",className:"h-4 w-4"}),(0,i.jsx)(sU.Cd,{children:"Error loading chart data"}),(0,i.jsx)(sU.X,{children:"There was a problem loading your chart data."})]}),a&&!n&&(0,i.jsx)(G,{config:nu,className:"aspect-auto h-[250px] w-full",children:(0,i.jsxs)(O.v,{accessibilityLayer:!0,data:a,margin:{left:-24,right:12},children:[(0,i.jsx)(P.q,{vertical:!1}),(0,i.jsx)(T.K,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:32,tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),(0,i.jsx)(L.B,{tickLine:!1,axisLine:!1,tickMargin:8,tickCount:5,allowDecimals:!1}),(0,i.jsx)(J,{content:(0,i.jsx)(V,{labelFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})}),(0,i.jsx)(F.$,{dataKey:"users",fill:"var(--color-users)"})]})})]})}function np(e){let{projectRef:t}=e,[s,a]=(0,o.useState)(7);return(0,i.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,i.jsx)(aB,{title:"Users",description:"View user signups over time",children:(0,i.jsxs)(eY.Ph,{value:String(s),onValueChange:e=>a(Number(e)),children:[(0,i.jsx)(eY.i4,{className:"w-[160px] rounded-lg sm:ml-auto","aria-label":"Select a value",children:(0,i.jsx)(eY.ki,{placeholder:"Select time range"})}),(0,i.jsxs)(eY.Bw,{className:"rounded-xl",children:[(0,i.jsx)(eY.Ql,{value:"90",className:"rounded-lg",children:"Last 90 days"}),(0,i.jsx)(eY.Ql,{value:"30",className:"rounded-lg",children:"Last 30 days"}),(0,i.jsx)(eY.Ql,{value:"7",className:"rounded-lg",children:"Last 7 days"})]})]})}),(0,i.jsx)(nm,{projectRef:t,timeRange:s}),(0,i.jsx)(a5,{hideChartOption:!0,projectRef:t,initialSql:"SELECT * FROM auth.users ORDER BY created_at DESC LIMIT 100;",initialNaturalLanguageMode:!0,label:"Recent users",description:"View recent user signups",naturalLanguagePlaceholder:"Show me the most recent 100 user signups",hideSql:!0,readOnly:!0,runAutomatically:!0,className:"mt-4"})]})}var nx=s(72253);let nh=e=>{let{projectId:t,disabled:s}=e,[a,n]=(0,o.useState)(!1),r=()=>n(!1),l=(0,tn.D)({mutationFn:()=>(0,g.SJ)().post("/projects/".concat(t,"/supabase/disconnect")),onSuccess:()=>{(0,eT.Am)("Supabase disconnected",{description:"You can connect to a new Supabase project later."}),r()},onError:e=>{eT.Am.error("Error",{description:e.message})}});return(0,i.jsxs)(tu.Vq,{open:a,onOpenChange:n,children:[(0,i.jsx)(tu.hg,{asChild:!0,children:(0,i.jsx)(j.z,{variant:"outline",size:"sm",disabled:s,children:"Disconnect"})}),(0,i.jsxs)(tu.cZ,{size:"sm",children:[(0,i.jsxs)(tu.fK,{children:[(0,i.jsx)(tu.$N,{children:"Disconnect Supabase"}),(0,i.jsx)(tu.Be,{children:"Are you sure you want to disconnect Supabase?"})]}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"We will stop deploying edge functions and reading your database schema, but no changes will be made to your code. You can reconnect to Supabase later."}),(0,i.jsxs)(tu.cN,{children:[(0,i.jsx)(j.z,{variant:"outline",onClick:r,children:"Cancel"}),(0,i.jsx)(j.z,{variant:"destructive",onClick:()=>{l.mutate()},loading:l.isPending,children:"Disconnect"})]})]})]})},ng=e=>{let{projectId:t}=e,s=(0,sH.bk)(e=>e.isSendChatMessageMutationPending);return(0,i.jsx)(eM.P,{label:"Disconnect Project",description:"Remove the Supabase project from this Lovable project.",justify:"end",children:(0,i.jsx)(nh,{projectId:t,disabled:s})})};var nf=s(78844);let nj=e=>{var t;let{workspace:s,myWorkspaceRole:a,setShowConnectDialog:n}=e,{isLoading:r,noOrganizations:l}=(0,nx.S)({workspaceId:s.id}),{handleConnect:o,isConnecting:c}=(0,nf.hb)(null!==(t=null==s?void 0:s.id)&&void 0!==t?t:""),d="admin"===a||"owner"===a;return(0,i.jsx)(eM.P,{label:"Organizations",description:"Connected Supabase organizations will be accessible to all members in this workspace.",justify:"end",badges:["admin"],children:r?(0,i.jsx)(X.O,{className:"h-7 w-40"}):l?(0,i.jsxs)(j.z,{disabled:c||!d,onClick:o,size:"sm",loading:c,children:[(0,i.jsx)(tS.xR.Supabase,{className:"h-4 w-4"}),"Connect Supabase"]}):(0,i.jsx)(j.z,{disabled:c||!d,onClick:()=>n(!0),size:"sm",variant:"outline",children:"Manage Connected Organizations"})})};var nv=s(38343);let nb=e=>{let{setStep:t,workspace:s,supabaseOrganizations:a,handleConnect:n,isConnecting:r,showConnectStep:l}=e,o=0===a.length;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(sj,{title:"Linked Supabase Organizations",description:"Anyone in your Lovable workspace can view and link Supabase projects..",badge:"admin"}),(0,i.jsx)(e0.Separator,{}),(0,i.jsxs)("div",{className:"grid min-h-[200px] grid-cols-1 gap-3 px-6 py-6 md:grid-cols-2",children:[(0,i.jsx)(sb,{workspace:s}),(0,i.jsxs)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Supabase Organizations"}),a.map(e=>{let t="connected"===e.status;return(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("div",{className:"flex h-7 w-7 items-center justify-center rounded-full border bg-muted",children:(0,i.jsx)(tS.xR.Supabase,{className:"h-4 w-4"})}),(0,i.jsx)("p",{className:"font-medium",children:e.name}),!t&&(0,i.jsx)(j.z,{variant:"default",size:"sm",className:"ml-auto",onClick:n,disabled:r,children:"Reconnect"})]},e.id)}),(0,i.jsx)(j.z,{variant:"outline",className:"mt-auto w-full",onClick:n,size:"sm",children:o?"Add Organization":"Add More Organizations"})]})]}),(0,i.jsx)(e0.Separator,{}),l&&(0,i.jsx)(sv,{children:(0,i.jsx)(j.z,{onClick:()=>t("connect"),className:"ml-auto",size:"sm",disabled:0===a.length,children:"Continue"})})]})};var ny=s(93459),nw=s(27559);let nN=e=>{let{setStep:t,supabaseOrganizations:s,closeDialog:a}=e,n=(0,sO.D)(),r=(0,sH.bk)(e=>e.isSendChatMessageMutationPending),[l,c]=(0,o.useState)(null),{handleProjectSelect:d,isConnecting:u}=(0,ny._)(n,a),m=u||r;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(sj,{title:"Connect Project",description:"Select a project of one of your connected Supabase organizations to connect it to your Lovable project."}),(0,i.jsx)(e0.Separator,{}),(0,i.jsx)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto px-6 py-6",children:s.map(e=>{let t=[...e.projects].sort((e,t)=>(0,nw.u)(e)&&!(0,nw.u)(t)?-1:(0,nw.u)(t)&&!(0,nw.u)(e)?1:0),s=0===t.length;return(0,i.jsxs)("div",{className:"flex w-full flex-col gap-3",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:e.name}),t.map(e=>{let t=(0,nw.u)(e),s=l===e.id;return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("p",{className:"font-medium",children:e.name}),!t&&(0,i.jsx)(e3.b,{showTooltip:!t,tooltipContent:"Check project status in Supabase.",instant:!0,children:(0,i.jsx)(b.Z,{name:"warning_fill",className:"text-destructive-primary",size:"small"})},e.id)]}),(0,i.jsx)(j.z,{size:"sm",disabled:!t||m,onClick:()=>{c(e.id),d(e)},loading:s&&m,children:s&&m?"Connecting":"Connect"})]},e.id)}),(0,i.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[s&&(0,i.jsx)("p",{className:"w-full text-sm text-muted-foreground",children:"No Supabase projects found for this organization."}),(0,i.jsx)(j.z,{size:"sm",variant:s?"default":"secondary",className:"ml-auto w-fit",asChild:!0,children:(0,i.jsxs)("a",{href:"https://supabase.com/dashboard/new/".concat(e.id),target:"_blank",children:[(0,i.jsx)(tS.xR.Supabase,{className:"h-3 w-3"}),"Create Project"]})})]})]},e.id)})}),(0,i.jsx)(e0.Separator,{}),(0,i.jsx)(sv,{children:(0,i.jsx)(j.z,{variant:"outline",onClick:()=>t("organizations"),size:"sm",children:"Back"})})]})},n_=e=>{var t;let{workspace:s,showConnectStep:a,showConnectDialog:n,setShowConnectDialog:r}=e,[l,c]=(0,o.useState)("organizations"),{supabaseOrganizations:d}=(0,nx.S)({workspaceId:s.id}),{handleConnect:u,isConnecting:m}=(0,nf.hb)(null!==(t=null==s?void 0:s.id)&&void 0!==t?t:"");return(0,i.jsxs)(tu.Vq,{open:n,onOpenChange:e=>{r(e),e||c("organizations")},children:[(0,i.jsx)(tu.hg,{asChild:!0,className:"hidden",children:(0,i.jsx)(j.z,{size:"sm",children:"Connect Supabase"})}),(0,i.jsx)(sf,{children:"organizations"===l?(0,i.jsx)(nb,{setStep:c,workspace:s,supabaseOrganizations:null!=d?d:[],handleConnect:u,isConnecting:m,showConnectStep:a}):(0,i.jsx)(nN,{setStep:c,supabaseOrganizations:null!=d?d:[],closeDialog:()=>{r(!1),c("organizations")}})})]})};var nk=e=>{let t=(0,er.iZ)(e=>e.project),s=null==t?void 0:t.supabase_project_config,a=!!(null==s?void 0:s.supabase_project_id);return(0,i.jsx)(n_,{...e,showConnectStep:!a})},nS=s(15492);let nC=e=>{let{isConnectedToSupabase:t}=e,[s,a]=(0,nS.B)("supabase-explainer",{defaultValue:!0}),[n,r]=(0,o.useState)(!1);return t||!s?null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"rounded-md border border-border/50 bg-muted/20 p-4",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,i.jsx)(b.Z,{name:"info",size:"small",className:"text-muted-foreground"}),(0,i.jsx)("h3",{className:"text-sm font-medium",children:"What is Supabase?"}),(0,i.jsx)(j.z,{variant:"ghost",className:"ml-auto hover:bg-transparent",size:"icon-sm",onClick:()=>a(!1),children:(0,i.jsx)(b.Z,{name:"close",size:"small",className:"text-muted-foreground"})})]}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"Supabase is a complete platform for building apps with user authentication, data storage, and other backend capabilities. Connecting it to your Lovable project will enable you to build more advanced apps and support things such as AI features and payments."}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-3 pt-2",children:[(0,i.jsxs)("a",{href:"https://docs.lovable.dev/integrations/supabase",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1.5 rounded-md bg-primary/10 px-3 py-1.5 text-sm font-medium text-primary transition-colors hover:bg-primary/20",children:[(0,i.jsx)(b.Z,{name:"menu_book",size:"small"}),"See docs"]}),(0,i.jsxs)("button",{onClick:()=>r(!0),className:"inline-flex items-center gap-1.5 rounded-md bg-primary/10 px-3 py-1.5 text-sm font-medium text-primary transition-colors hover:bg-primary/20",children:[(0,i.jsx)(b.Z,{name:"play_circle",size:"small"}),"Watch tutorial"]})]})]})}),(0,i.jsx)(tu.Vq,{open:n,onOpenChange:r,children:(0,i.jsx)(tu.cZ,{className:"max-w-4xl p-0",children:(0,i.jsx)("div",{className:"aspect-video w-full",children:(0,i.jsx)("iframe",{src:"https://www.youtube.com/embed/eVHg4wipRrU",title:"Supabase Tutorial",className:"h-full w-full rounded-lg",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})})})]})},nE=e=>{var t,s;let{workspace:a,isInsideEditor:n,myWorkspaceRole:r,project:l,resetCallbackRef:c}=e,[d,u]=(0,o.useState)(!1),m=(0,o.useCallback)(()=>{n&&u(!0)},[n]);(0,nx.I)({workspaceId:a.id,onConnectSuccess:m});let x=null==l?void 0:null===(t=l.enabled_integrations)||void 0===t?void 0:t.includes("supabase_exp");return(0,i.jsx)(p.tM,{value:"supabase",title:x?"Backend":"Supabase",description:"Integrate user authentication, data storage, and backend capabilities.",docsLink:"https://docs.lovable.dev/integrations/supabase",children:(null==l?void 0:null===(s=l.enabled_integrations)||void 0===s?void 0:s.includes("supabase_exp"))?(0,i.jsx)(nz,{resetCallbackRef:c}):(0,i.jsxs)(i.Fragment,{children:[l?(0,i.jsx)(nk,{workspace:a,showConnectDialog:d,setShowConnectDialog:u}):(0,i.jsx)(n_,{workspace:a,showConnectDialog:d,setShowConnectDialog:u}),l&&(0,i.jsx)(nD,{workspace:a,myWorkspaceRole:r,setShowConnectDialog:u}),(0,i.jsx)(nA,{workspace:a,myWorkspaceRole:r,isInsideEditor:n,showConnectDialog:d,setShowConnectDialog:u})]})})},nA=e=>{let{workspace:t,myWorkspaceRole:s,isInsideEditor:a,showConnectDialog:n,setShowConnectDialog:r}=e;return(0,i.jsx)(nj,{workspace:t,myWorkspaceRole:s,isInsideEditor:a,showConnectDialog:n,setShowConnectDialog:r})},nD=e=>{var t,s,a;let{workspace:n,myWorkspaceRole:r,setShowConnectDialog:l}=e,o=(0,er.iZ)(e=>e.project),c=null==o?void 0:o.supabase_project_config,d=!!(null==o?void 0:o.is_supabase_enabled),u=(0,nx.S)({workspaceId:n.id}),m=(0,sQ.Z)(u,c),p=null==o?void 0:o.creation_options.tech_stack,x=(null==c?void 0:c.supabase_project_id)&&!m,h=null===(t=u.supabaseOrganizations)||void 0===t?void 0:t.flatMap(e=>e.projects||[]),f=null==h?void 0:h.find(e=>e.id===(null==c?void 0:c.supabase_project_id)),v=null==o?void 0:o.id,b=(0,tn.D)({mutationFn:()=>(0,g.SJ)().post("/projects/".concat(v,"/supabase/disconnect")),onSuccess:()=>{(0,eT.Am)("Supabase disconnected",{description:"You can connect to a new Supabase project later."})},onError:e=>{eT.Am.error("Error",{description:e.message})}}),y=null===(s=u.supabaseOrganizations)||void 0===s?void 0:s.find(e=>e.id===(null==c?void 0:c.supabase_organization_id));if(!o)return null;if(d||p&&"vite_react_shadcn_ts"!==p)return(0,i.jsx)("div",{className:"text-sm",children:"Unfortunately, your project is not able to use Supabase."});let w=u.noOrganizations;return u.isLoading?(0,i.jsx)(so.T,{text:"Loading Supabase..."}):(0,i.jsxs)(i.Fragment,{children:[!y&&!!(null==c?void 0:c.supabase_organization_id)&&(0,i.jsxs)(sU.bZ,{variant:"destructive",children:[(0,i.jsx)(sU.Cd,{children:"Problem with your Supabase connection"}),(0,i.jsxs)(sU.X,{children:[(0,i.jsxs)("p",{children:["This project is connected to Supabase organization"," ",(0,i.jsx)("span",{className:"rounded-md bg-muted px-1 py-0.5 font-mono font-medium text-muted-foreground",children:null==c?void 0:c.supabase_organization_id}),", but this workspace is not connected to that organization. Disconnect the project or add the organization again."]}),(0,i.jsx)("div",{className:"mt-4 flex",children:(0,i.jsx)(j.z,{variant:"destructive",onClick:()=>b.mutate(),disabled:b.isPending,size:"sm",children:"Disconnect"})})]})]}),(0,i.jsx)(nC,{isConnectedToSupabase:!u.noOrganizations}),!w&&(0,i.jsx)(nv.c,{supabaseOrganizations:null!==(a=u.supabaseOrganizations)&&void 0!==a?a:[],connectedSupabaseProject:null!=f?f:null,setShowConnectDialog:l,isWorkspaceAdmin:"admin"===r||"owner"===r}),x&&f&&(0,i.jsx)(ng,{projectId:null==o?void 0:o.id})]})},nz=e=>{let{resetCallbackRef:t}=e,s=(0,er.iZ)(e=>e.project),a=null==s?void 0:s.id,{closeSettings:n}=(0,te.r)(),r=(0,sH.bk)(e=>e.isSendChatMessageMutationPending),{data:l,isLoading:o}=(0,h.a)({queryKey:["supabase-integration-data",a],queryFn:()=>(0,g.SJ)().get("/projects/".concat(a,"/integrations/supabase_exp")),enabled:!!a}),c=null==l?void 0:l.supabase_project_id,d=(0,sV.mo)({projectId:a});if(o)return(0,i.jsx)("div",{className:"flex h-full w-full flex-col items-center justify-center gap-4",children:(0,i.jsx)(so.T,{text:"Loading..."})});if(!c)return(0,i.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center",children:[(0,i.jsx)("div",{className:"flex size-12 items-center justify-center rounded-lg bg-muted",children:(0,i.jsx)(b.Z,{name:"database",size:"xlarge",className:"text-muted-foreground"})}),(0,i.jsx)("p",{className:"mt-4 text-lg font-medium",children:"No Backend Added"}),(0,i.jsxs)("p",{className:"mt-1 max-w-xs text-center text-sm text-muted-foreground",children:["Setup Backend to store data, add authentication, and execute background functions."," ",(0,i.jsx)(eO.default,{href:"https://docs.lovable.dev/integrations/supabase",target:"_blank",className:"inline-block underline underline-offset-1",children:"Learn more"})]}),(0,i.jsx)("div",{className:"mt-6 flex gap-2",children:(0,i.jsx)(e3.b,{showTooltip:r,tooltipContent:"Wait for Lovable to finish working",children:(0,i.jsx)(j.z,{variant:"default",onClick:()=>{a&&(d.mutate({body:{message:"Please connect Lovable Backend to my existing app.",id:(0,sB.Fd)(),chat_only:!1}}),n())},disabled:d.isPending||r,loading:d.isPending,children:"Add Backend"})})})]});let u=[{title:"Database",icon:"table",description:"Manage tables, queries, and database schema",component:(0,i.jsx)(a9,{projectRef:c})},{title:"Storage",icon:"hard_drive",description:"Upload and manage files, images, and documents",component:(0,i.jsx)(no,{projectRef:c})},{title:"Auth",icon:"shield",description:"Configure authentication providers",component:(0,i.jsx)(aF,{projectRef:c})},{title:"Users",icon:"group",description:"View and manage user accounts and profiles",component:(0,i.jsx)(np,{projectRef:c})},{title:"Secrets",icon:"key",description:"Store and manage environment variables securely",component:(0,i.jsx)(ni,{projectRef:c})},{title:"Logs",icon:"data_table",description:"Monitor application logs to debug issues",component:(0,i.jsx)(nl,{projectRef:c})},{title:"Suggestions",icon:"lightbulb_2",description:"Get security and performance recommendations",component:(0,i.jsx)(nd,{projectRef:c})}];return(0,i.jsxs)(sX,{onStackEmpty:()=>{},initialStack:[],children:[(0,i.jsx)(nI,{resetCallbackRef:t}),(0,i.jsx)(nO,{navigationItems:u,projectRef:c})]})},nI=e=>{let{resetCallbackRef:t}=e,{reset:s}=s$();return(0,o.useEffect)(()=>{t&&(t.current=s)},[s,t]),null},nO=e=>{let{navigationItems:t,projectRef:s}=e,{push:a}=s$(),{hasWarningsOrErrors:n}=aj(s||"");return(0,i.jsx)(s0,{navigationItems:t,children:(0,i.jsx)("div",{className:"grid grid-cols-1 gap-4 pb-4 xl:grid-cols-2",children:t.map(e=>{let{title:t,component:s,icon:r,description:l}=e;return(0,i.jsx)(a3,{onClick:()=>{a({title:t,component:s})},icon:r,title:t,description:l,badge:"Suggestions"===t&&n&&(0,i.jsx)(sS.C,{variant:"warning",children:"Security Issues"})},t)})})})};var nP=s(77755),nT=s(48581),nL=s(54596),nR=s(108),nF=s(7309),nZ=s(60610);let nM=o.forwardRef((e,t)=>{let{className:s,value:a,...n}=e;return(0,i.jsx)(nZ.fC,{ref:t,className:(0,q.cn)("relative h-4 w-full overflow-hidden rounded-full bg-muted-active",s),...n,children:(0,i.jsx)(nZ.z$,{className:"h-full w-full flex-1 bg-brand-twilight-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});nM.displayName=nZ.fC.displayName;var nq=s(59053),nU=s(79358);let nK=e=>{let{workspace:t,myWorkspaceRole:s}=e,{billingPeriodCreditLimit:a,billingPeriodCreditsUsed:n,dailyCreditLimit:r,dailyCreditsUsed:l,rolloverCredits:o,billingPeriodEndDate:c}=(0,nq.O)({projectWorkspace:t}),d=t.plan,u=(0,e9.fA)(d),m="ambassador"===d,p=(0,e9.XB)(d),x=(u||m)&&0===t.billing_period_credits_limit,h=x?null!=l?l:0:null!=n?n:0,g=x?null!=r?r:0:null!=a?a:0,f=(0,e9.Iw)(d),j=(0,nF.oW)({id:d,type:"monthly"});return p?(0,i.jsxs)(a4.Zb,{className:"flex w-full flex-col gap-4 bg-muted p-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("span",{className:"font-medium text-foreground",children:"Credits"}),(0,i.jsx)("span",{className:"text-sm font-medium text-foreground",children:(0,nU.u)(h,g)})]}),(0,i.jsx)(nM,{value:h/g*100,className:"h-[11px] w-full"}),void 0!==o&&o>0&&(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,nU.H)(o)," rollover credits available"]}),("admin"===s||"owner"===s)&&(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:[u?(0,i.jsxs)(i.Fragment,{children:["You're currently on a legacy plan:"," ",(0,i.jsx)("span",{className:"font-medium capitalize",children:f})," ","charged at $",j,"/mo. You're welcome to stay on this plan — but if you're curious to explore our new plans, you'll get 20% off for the first 3 months."," ",(0,i.jsx)(nG,{workspace:t,children:"Manage your payment preferences"}),", or change to one of our new plans below."]}):(0,i.jsxs)(i.Fragment,{children:["You're currently subscribed to plan:"," ",(0,i.jsx)("span",{className:"font-medium capitalize",children:f})," ","charged at $",j,"/mo."," ",(0,i.jsx)(nG,{workspace:t,children:"Manage your payment preferences"}),", or change your plan below."]})," ",!x&&(0,i.jsx)("span",{className:"text-sm text-muted-foreground",children:c?"Your monthly credits will renew on ".concat((0,z.WU)(c,"MMMM d")," at ").concat((0,z.WU)(c,"HH:mm"),"."):"Your credits will renew each month (at midnight UTC)."})]})]}):"inactive"!==d?(0,i.jsx)(a4.Zb,{className:"flex w-full flex-col gap-4 bg-muted p-4",children:(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,i.jsxs)("span",{children:["You're currently on plan:"," ",(0,i.jsx)("span",{className:"font-medium capitalize",children:f}),". "]})," ",(0,i.jsx)(nG,{workspace:t,children:"Manage your payment preferences and view past invoices"}),", or change your plan below."]})}):void 0},nG=e=>{let{workspace:t,children:s}=e,{createPortalSession:a,isCreatePortalSessionLoading:n}=(0,nR.m)();return(0,i.jsx)("span",{role:"button",tabIndex:0,onClick:()=>{n||a({workspaceId:t.id})},onKeyDown:e=>{n||"Enter"!==e.key&&" "!==e.key||a({workspaceId:t.id})},className:"inline cursor-pointer underline disabled:opacity-50","aria-disabled":n,children:s})},nW=[{value:"technical_issues",label:"I am having too many techincal issues"},{value:"too_expensive",label:"It's too expensive"},{value:"not_using",label:"I'm not using Lovable enough"},{value:"missing_features",label:"It's missing features"},{value:"switched_to_competitor",label:"I switched to a competitor"},{value:"other",label:"Other reason"}],nJ=[{id:"custom-domains",name:"Custom domains",description:"Connect your own domain to your projects"},{id:"team-collab",name:"Team collaboration",description:"Invite team members to work together"},{id:"visual-editor",name:"Visual editor",description:"Edit the frontend of your project instantly"},{id:"code-editor",name:"Code editor",description:"Edit the backend of your project in code"},{id:"chat-mode",name:"Chat mode",description:"Plan your next step with AI"},{id:"security-checks",name:"Security checks",description:"Run checks when publishing with Supabase to find and fix vulnerabilities"}];var nV=s(48351);(n=l||(l={})).SUGGEST_LOWER_PLAN="SUGGEST_LOWER_PLAN",n.FEATURES_TO_TRY="FEATURES_TO_TRY",n.KTLO_OFFER="KTLO_OFFER",n.FEEDBACK="FEEDBACK",n.FINAL_CONFIRMATION="FINAL_CONFIRMATION";let nB=(0,o.createContext)(void 0),nH=e=>{var t;let{children:s,targetPlan:a,onCancel:n,workspace:r}=e,c=(0,t_.f7)(),d=r.plan!==nV.It.KTLO&&c&&(null==a?void 0:a.id)===e9.tJ.FREE,u=(0,t_.$d)(),m=(0,o.useMemo)(()=>u?(null==a?void 0:a.id)!==e9.tJ.FREE||r.plan.endsWith("_1")?l.FEATURES_TO_TRY:l.SUGGEST_LOWER_PLAN:l.FEATURES_TO_TRY,[a,r.plan,u]),[p,x]=(0,o.useState)(m),[h,g]=(0,o.useState)({reason:""}),[f,j]=(0,o.useState)(!1),v=(0,nT.tS)(),{toCheckout:b}=(0,nR.m)(),y=async e=>{j(!0);let t=null!=e?e:a;(null==r?void 0:r.id)&&(t&&t.id!==e9.tJ.FREE?await b({plan:t,workspaceId:r.id,grandfatheredDiscount:!1,planType:v.planType,changeType:"downgrade"}):await v.createPortalSession())},w=async()=>{j(!0);try{(null==r?void 0:r.id)&&await b({plan:nF.Ds,workspaceId:r.id,grandfatheredDiscount:!1,planType:"monthly",changeType:"upgrade"})}catch(e){console.error("Error switching to KTLO plan:",e),j(!1)}},N={currentStep:p,feedback:h,currentPlan:r.plan,targetPlan:null!==(t=null==a?void 0:a.id)&&void 0!==t?t:e9.tJ.FREE,shouldShowKtloOffer:d,setCurrentStep:x,setFeedback:g,onCancel:n,onConfirm:y,onSwitchToKtlo:w,isLoading:f,getNextStepAfterSuggestLowerPlan:()=>l.FEATURES_TO_TRY,getNextStepAfterFeatures:()=>d?l.KTLO_OFFER:l.FEEDBACK,getNextStepAfterKtlo:()=>l.FEEDBACK,getNextStepAfterFeedback:()=>l.FINAL_CONFIRMATION,getPreviousStepBeforeFeedback:()=>d?l.KTLO_OFFER:l.FEATURES_TO_TRY,getPreviousStepBeforeFinalConfirmation:()=>l.FEEDBACK};return(0,i.jsx)(nB.Provider,{value:N,children:s})},nQ=()=>{let e=(0,o.useContext)(nB);if(void 0===e)throw Error("useDowngrade must be used within a DowngradeProvider");return e},nY=()=>{let{onCancel:e,setCurrentStep:t,getNextStepAfterFeatures:s}=nQ();return(0,i.jsx)(a4.Zb,{className:"bg-muted p-4 md:p-6",children:(0,i.jsxs)("div",{className:"flex flex-col md:gap-6",children:[(0,i.jsx)("div",{className:"flex flex-col gap-3 md:gap-4",children:(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)(t5.Label,{className:"text-lg md:text-xl",children:"Have you tried these features yet?"}),(0,i.jsx)("div",{className:"flex flex-col gap-1.5 md:gap-2",children:nJ.map(e=>(0,i.jsxs)("div",{className:"flex items-start gap-3 rounded-lg px-2 py-2 transition-colors md:gap-4 md:px-3",children:[(0,i.jsx)("span",{className:"mt-1.5 select-none text-base md:mt-2 md:text-lg",children:"•"}),(0,i.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,i.jsx)(t5.Label,{htmlFor:e.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.id))})]})}),(0,i.jsxs)("div",{className:"flex flex-col justify-end gap-3 sm:flex-row",children:[(0,i.jsx)(j.z,{variant:"outline",onClick:()=>{eP.ZP.capture(eH.f8.FEATURE_USAGE.KEEP_PLAN_CLICKED),e()},className:"w-full sm:w-auto",children:"Keep Current Plan"}),(0,i.jsx)(j.z,{onClick:()=>{eP.ZP.capture(eH.f8.FEATURE_USAGE.CONTINUE_CLICKED),t(s())},className:"w-full sm:w-auto",children:"Continue Downgrading"})]})]})})},nX=()=>{var e;let{feedback:t,setFeedback:s,setCurrentStep:a,getPreviousStepBeforeFeedback:n}=nQ();return(0,i.jsx)(a4.Zb,{className:"bg-muted p-6",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,i.jsx)(t5.Label,{className:"text-2xl",children:"Why are you downgrading?"}),(0,i.jsx)(t4.E,{value:t.reason,onValueChange:e=>s({...t,reason:e}),className:"flex flex-col gap-1",children:nW.map(e=>(0,i.jsxs)("div",{className:(0,q.cn)("flex items-center gap-4 rounded-lg px-3 py-3","cursor-pointer transition-colors",t.reason===e.value?"bg-primary/5":"hover:bg-muted/50"),onClick:()=>s({...t,reason:e.value}),children:[(0,i.jsx)(t4.m,{value:e.value,id:e.value}),(0,i.jsx)("div",{className:"flex flex-1 flex-col gap-0.5",children:(0,i.jsx)(t5.Label,{htmlFor:e.value,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.label})})]},e.value))})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,i.jsx)(t5.Label,{htmlFor:"additional-feedback",className:"text-base",children:"Additional feedback (optional)"}),(0,i.jsx)(eB.g,{id:"additional-feedback",placeholder:"Tell us more about your decision...",value:t.additionalNotes,onChange:e=>s({...t,additionalNotes:e.target.value}),maxLength:500,className:"min-h-[80px] resize-none border-muted-foreground/20 bg-background placeholder:text-muted-foreground/50 focus:border-primary focus:ring-1 focus:ring-primary"}),(0,i.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null===(e=t.additionalNotes)||void 0===e?void 0:e.length)||0,"/500 characters"]})]})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-3 pt-1",children:[(0,i.jsx)(j.z,{variant:"outline",onClick:()=>{a(n())},children:"Back"}),(0,i.jsx)(j.z,{variant:"default",onClick:()=>{eP.ZP.capture(eH.f8.FEEDBACK.CONTINUE_CLICKED,{reason:t.reason,has_additional_notes:!!t.additionalNotes,additional_notes:t.additionalNotes||""}),a(l.FINAL_CONFIRMATION)},children:"Continue"})]})]})})},n$=(e,t)=>{var s,a;let n=(0,e9.Ll)(e),r=(0,e9.Ll)(t),l=null!==(s=(0,nF.z_)(e))&&void 0!==s?s:0,i=null!==(a=(0,nF.z_)(t))&&void 0!==a?a:0;if("pro"===n){if("pro"===r)return["Credits will decrease from ".concat(l," to ").concat(i," per month"),"Credit rollover maximum will be adjusted to the new plan","Same pro features will be maintained at a lower tier"];if("free"===r)return["All new projects will be public","A Lovable badge will be added to all new projects","You will lose team management features","Custom domains will be removed","Credits will reset to 5 per day","No credit rollovers"]}if("biz"===n){if("biz"===r)return["Credits will decrease from ".concat(l," to ").concat(i," per month"),"Credit rollover maximum will be adjusted to the new plan","Same business features will be maintained at a lower tier"];if("pro"===r)return["No SSO","No design templates","No data opt out","No personal projects"];if("free"===r)return["No SSO","No design templates","No data opt out","No personal projects","All new projects will be public","A Lovable badge will be added to all new projects","You will lose team management features","Custom domains will be removed","Credits will reset to 5 per day","No credit rollovers"]}return"ktlo"===r?["Credits will change from ".concat(l," per month to freemium (5 per day, up to 30 per month)"),"No credit rollovers","You keep: Pro features: Private Projects, No Lovable Badge, Roles and Permissions, Custom Domains"]:[]},n0=tG.Ry({reason:tG.Z_().optional(),additional_notes:tG.Z_().max(500,"Additional notes must be less than 500 characters").optional()}),n1=()=>{let{currentPlan:e,targetPlan:t,onConfirm:s,isLoading:a,setCurrentStep:n,feedback:r,getPreviousStepBeforeFinalConfirmation:l}=nQ(),o=(0,g.SJ)(),c=(0,tn.D)({mutationFn:async()=>{let e=n0.parse({reason:r.reason,additional_notes:r.additionalNotes});await o.post("/user/cancellation",e),await s()},onSuccess:()=>{eP.ZP.capture(eH.f8.FINAL_CONFIRMATION.CONFIRM_CLICKED,{from_plan:e,to_plan:t})},onError:e=>{if(eU.logging.error("Error submitting feedback:",e),e instanceof ak.jm){let t=e.errors[0];eT.Am.error("Validation Error",{description:t.message})}else{var t;eT.Am.error("Error",{description:(null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to submit feedback"})}}}),d=n$(e,t);return(0,i.jsx)(a4.Zb,{className:"bg-muted",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3 text-amber-500",children:[(0,i.jsx)(b.Z,{name:"warning_fill",size:"small"}),(0,i.jsx)("h2",{className:"text-lg font-medium",children:"Confirm Plan Downgrade"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"mb-4 text-muted-foreground",children:d.length>0?"By downgrading to the ".concat((0,e9.Ll)(t)," plan, you will lose access to the following features:"):"By downgrading to the ".concat((0,e9.Ll)(t)," plan, you will lose access to some features of your current plan.")}),d.length>0&&(0,i.jsx)("ul",{className:"list-disc space-y-2 pl-6",children:d.map((e,t)=>(0,i.jsx)("li",{className:"text-foreground",children:e},t))})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,i.jsx)(j.z,{variant:"outline",onClick:()=>{n(l())},children:"Back"}),(0,i.jsx)(j.z,{variant:"destructive",onClick:()=>{c.mutate()},disabled:c.isPending||a,children:c.isPending||a?"Processing...":"Confirm Downgrade"})]})]})})};var n2=s(33145);let n5=()=>{let{setCurrentStep:e,feedback:t,onSwitchToKtlo:s,isLoading:a,getNextStepAfterKtlo:n}=nQ(),r=async()=>{eP.ZP.capture(eH.f8.KTLO_OFFER.SWITCH_CLICKED,{reason:t.reason}),await s()};return(0,i.jsxs)(a4.Zb,{className:"border-border bg-muted",children:[(0,i.jsxs)("div",{className:"flex flex-1 flex-col gap-8 lg:flex-row lg:gap-12",children:[(0,i.jsxs)("div",{className:"flex max-w-md flex-col justify-center",children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("h2",{className:"mb-3 text-3xl font-medium text-foreground",children:"Switch to Lite"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Try our new Lite plan and retain important features that keep your project going."})]}),(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("p",{className:"mb-2 font-medium text-foreground",children:"What's included:"}),(0,i.jsx)("ul",{className:"flex flex-col gap-2",children:["5 daily credits up to a maximum of 30 per month","Keep custom domains","No Lovable badge","Team settings stay in place","Access to private projects"].map((e,t)=>(0,i.jsxs)("li",{className:"flex items-center gap-3",children:[(0,i.jsx)(b.Z,{name:"check",size:"small",className:"flex-shrink-0 text-success-primary"}),(0,i.jsx)("span",{className:"text-foreground",children:e})]},t))})]}),(0,i.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,i.jsx)("span",{className:"text-5xl font-medium text-foreground",children:"$15"}),(0,i.jsx)("span",{className:"text-lg text-muted-foreground",children:"/month"})]})]}),(0,i.jsx)("div",{className:"flex w-full flex-1 items-center justify-center",children:(0,i.jsx)("div",{className:"h-full max-h-80 w-full max-w-lg overflow-hidden rounded-2xl lg:max-h-96",children:(0,i.jsx)(n2.default,{src:"/img/lovable-lite.webp",alt:"Lite Plan",className:"h-full w-full object-cover",width:500,height:400})})})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:justify-between",children:[(0,i.jsx)(j.z,{variant:"outline",onClick:()=>{e(l.FEATURES_TO_TRY)},children:"Back"}),(0,i.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row",children:[(0,i.jsx)(j.z,{variant:"outline",onClick:()=>{eP.ZP.capture(eH.f8.KTLO_OFFER.CONTINUE_DOWNGRADE_CLICKED,{reason:t.reason}),e(n())},children:"No, thank you"}),(0,i.jsx)(j.z,{onClick:r,disabled:a,className:"bg-foreground text-background hover:bg-foreground/90",children:a?"Switching...":"Switch to Lite"})]})]})]})},n4=()=>{let{currentStep:e}=nQ();switch(e){case l.FEATURES_TO_TRY:return(0,i.jsx)(nY,{});case l.KTLO_OFFER:return(0,i.jsx)(n5,{});case l.FEEDBACK:return(0,i.jsx)(nX,{});case l.FINAL_CONFIRMATION:return(0,i.jsx)(n1,{});default:return null}};n4.displayName="DowngradeContent";let n3=e=>{let{targetPlan:t,onCancel:s,workspace:a}=e;return(0,i.jsx)(nH,{targetPlan:t,onCancel:s,workspace:a,children:(0,i.jsx)(n4,{})})},n6=e=>{let{title:t,description:s}=e;return(0,i.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,i.jsx)(tS.xx,{className:"h-9"}),(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)(tu.$N,{className:"text-2xl font-medium md:text-3xl",children:t}),s&&(0,i.jsx)(tu.Be,{className:"text-base text-muted-foreground",children:s})]})]})},n7=()=>{let e=nQ();return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,i.jsx)(n6,{title:"Why are you canceling?",description:"We use this information to improve our product."}),(0,i.jsx)(t4.E,{value:e.feedback.reason,onValueChange:t=>e.setFeedback({...e.feedback,reason:t}),className:"flex flex-col gap-1",children:nW.map(t=>(0,i.jsxs)("div",{className:(0,q.cn)("flex cursor-pointer items-center gap-3 rounded-lg px-4 py-3 transition-colors",e.feedback.reason===t.value?"bg-primary/5":"hover:bg-muted/50"),onClick:()=>e.setFeedback({...e.feedback,reason:t.value}),children:[(0,i.jsx)(t4.m,{value:t.value,id:t.value}),(0,i.jsx)(t5.Label,{htmlFor:t.value,className:"text-base font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:t.label})]},t.value))}),(0,i.jsx)(tM.I,{placeholder:"Tell us more about your decision...",className:"h-12",maxLength:500,value:e.feedback.additionalNotes,onChange:t=>e.setFeedback({...e.feedback,additionalNotes:t.target.value})}),(0,i.jsxs)("div",{className:"flex flex-col gap-4 pt-2",children:[(0,i.jsxs)(j.z,{variant:"affirmative",className:"w-full",onClick:()=>{eP.ZP.capture(eH.f8.FEEDBACK.KEEP_PLAN_CLICKED),e.onCancel()},children:["Keep Lovable ",(0,e9.Iw)(e.currentPlan||"unknown")]}),(0,i.jsx)(j.z,{variant:"outline",className:"w-full",onClick:()=>{eP.ZP.capture(eH.f8.FEEDBACK.CONTINUE_CLICKED,{reason:e.feedback.reason}),e.setCurrentStep(e.getNextStepAfterFeedback())},children:"Downgrade plan"})]})]})})},n8=e=>{let{children:t,className:s}=e;return(0,i.jsx)("div",{className:(0,q.cn)("rounded-xl border bg-background p-5",s),children:t})},n9=tG.Ry({reason:tG.Z_().optional(),additional_notes:tG.Z_().max(500,"Additional notes must be less than 500 characters").optional()}),re=()=>{let e=nQ(),t=(0,g.SJ)(),s=(0,tn.D)({mutationFn:async()=>{let s=n9.parse({reason:e.feedback.reason,additional_notes:e.feedback.additionalNotes});await t.post("/user/cancellation",s),await e.onConfirm()},onSuccess:()=>{eP.ZP.capture(eH.f8.FINAL_CONFIRMATION.CONFIRM_CLICKED,{from_plan:e.currentPlan,to_plan:e.targetPlan})},onError:e=>{if(eU.logging.error("Error submitting feedback:",e),e instanceof ak.jm){let t=e.errors[0];eT.Am.error("Validation Error",{description:t.message})}else{var t;eT.Am.error("Error",{description:(null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to submit feedback"})}}}),a=n$(e.currentPlan,e.targetPlan);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n6,{title:"Continue downgrading?",description:"Your projects are live. Your team is set up. Don't lose it all."}),(0,i.jsxs)(n8,{children:[(0,i.jsx)("div",{className:"mb-4 text-lg font-medium",children:"You'll lose access to:"}),(0,i.jsxs)("ul",{className:"flex flex-col gap-4",children:[0===a.length&&(0,i.jsxs)("li",{className:"flex items-start gap-3",children:[(0,i.jsx)(b.Z,{name:"close",className:"size-5"}),(0,i.jsx)("span",{children:"Features of your current plan"})]}),a.map((e,t)=>(0,i.jsxs)("li",{className:"flex items-start gap-3",children:[(0,i.jsx)(b.Z,{name:"close",className:"size-5 text-muted-foreground"}),(0,i.jsx)("span",{children:e})]},t))]}),(0,i.jsx)(j.z,{variant:"destructive",className:"mt-4 w-full",onClick:()=>s.mutate(),loading:s.isPending,children:"Confirm cancellation"})]}),(0,i.jsxs)(j.z,{variant:"outline",className:"w-full",onClick:()=>{eP.ZP.capture(eH.f8.FINAL_CONFIRMATION.KEEP_PLAN_CLICKED),e.onCancel()},children:["Keep Lovable ",(0,e9.Iw)(e.currentPlan||"unknown")]})]})},rt=()=>{let e=nQ(),t=async()=>{eP.ZP.capture(eH.f8.KTLO_OFFER.SWITCH_CLICKED),await e.onSwitchToKtlo()};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n6,{title:"Switch to Lite",description:"Try our new Lite plan and retain important features that keep your project going."}),(0,i.jsxs)(n8,{children:[(0,i.jsx)("div",{className:"mb-2 text-lg font-medium",children:"Lite plan"}),(0,i.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-3xl font-medium md:text-4xl",children:"$15"}),(0,i.jsx)("span",{className:"text-base font-medium text-muted-foreground",children:"per month"}),(0,i.jsx)("span",{className:"font-semibold rounded bg-green-900/80 px-2 py-0.5 text-xs text-green-300",children:"40% off"})]}),(0,i.jsx)("ul",{className:"mt-4 flex flex-col gap-3",children:["5 daily credits up to a max of 30/month","Keep custom domains","No Lovable badge","Team settings stay in place","Access to private projects"].map((e,t)=>(0,i.jsxs)("li",{className:"flex items-center gap-2",children:[(0,i.jsx)(b.Z,{name:"check",className:"size-5"}),(0,i.jsx)("span",{children:e})]},t))}),(0,i.jsx)(j.z,{className:"mt-6 w-full",variant:"affirmative",onClick:t,loading:e.isLoading,children:"Switch to Lite"})]}),(0,i.jsx)(j.z,{variant:"outline",className:"w-full",onClick:()=>{eP.ZP.capture(eH.f8.KTLO_OFFER.CONTINUE_DOWNGRADE_CLICKED),e.setCurrentStep(e.getNextStepAfterKtlo())},children:"Downgrade plan"})]})},rs=()=>{let e=nQ();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n6,{title:"Have you tried these features?"}),(0,i.jsxs)(n8,{children:[(0,i.jsx)("div",{className:"flex flex-col gap-1.5 md:gap-2",children:nJ.map(e=>(0,i.jsxs)("div",{className:"flex items-start gap-3 rounded-lg px-2 py-2 transition-colors md:gap-4 md:px-3",children:[(0,i.jsx)("span",{className:"mt-1.5 select-none text-base md:mt-2 md:text-lg",children:"•"}),(0,i.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,i.jsx)(t5.Label,{htmlFor:e.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.id))}),(0,i.jsxs)(j.z,{variant:"affirmative",className:"mt-4 w-full",onClick:()=>{eP.ZP.capture(eH.f8.FEATURE_USAGE.KEEP_PLAN_CLICKED),e.onCancel()},children:["Keep Lovable ",(0,e9.Iw)(e.currentPlan||"unknown")]})]}),(0,i.jsx)(j.z,{variant:"outline",onClick:()=>{eP.ZP.capture(eH.f8.FEATURE_USAGE.CONTINUE_CLICKED),e.setCurrentStep(e.getNextStepAfterFeatures())},children:"Downgrade plan"})]})};var ra=s(72403);let rn=()=>{let e=nQ(),t=(0,nT.tS)(),s=(0,u.aS)(e=>e.currentWorkspace),a=t.allPlanOptions.find(t=>t.id===e.currentPlan),n=a?t.getDisplayPrice(a):0,r=(0,o.useMemo)(()=>t.allPlanOptions.filter(s=>"string"==typeof s.id&&s.id.includes(e.currentPlan.startsWith(e9.$k)?e9.$k:e9.Rq)&&t.getDisplayPrice(s)<n).sort((e,s)=>t.getDisplayPrice(s)-t.getDisplayPrice(e)),[t.allPlanOptions,t.getDisplayPrice,n]),l=(0,o.useMemo)(()=>(null==s?void 0:s.plan)&&r.length>0&&!r.some(e=>e.id===(null==s?void 0:s.plan))?r[0]:null,[r,null==s?void 0:s.plan,t.setPlanType]),[c,d]=(0,o.useState)(l);(0,o.useEffect)(()=>{t.setPlanType("monthly")},[t.setPlanType]),(0,o.useEffect)(()=>{(null==s?void 0:s.plan)&&!c&&e.setCurrentStep(e.getNextStepAfterSuggestLowerPlan())},[null==s?void 0:s.plan,c,e]);let m=async()=>{c&&(eP.ZP.capture(eH.f8.SUGGEST_LOWER_PLAN.DOWNGRADE_CREDITS_CLICKED,{current_plan_id:e.currentPlan,target_plan_id:c.id,target_plan_type:t.planType,plan_price:t.getDisplayPrice(c)}),await e.onConfirm(c))};return c?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n6,{title:"Downgrade now",description:"Do you want to downgrade by changing your monthly credits?"}),(0,i.jsxs)(n8,{children:[(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)("div",{className:"text-lg font-medium",children:"Reduce monthly credits"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)("span",{className:"text-3xl font-medium md:text-4xl",children:["$",t.getDisplayPrice(c)]}),(0,i.jsx)("span",{className:"text-base font-medium text-muted-foreground",children:t.getPriceSuffix()})]}),(0,i.jsx)(ra.z,{options:r,selectedOption:c,disabled:t.shouldDisableWorkspaceAdminActions,onSelect:d})]}),(0,i.jsx)(j.z,{className:"mt-4 w-full",variant:"affirmative",disabled:(null==c?void 0:c.id)===e.currentPlan||t.isEnterprisePlan||t.shouldDisableWorkspaceAdminActions,onClick:m,loading:e.isLoading,children:"Downgrade credits"})]}),(0,i.jsx)(j.z,{variant:"outline",onClick:()=>{eP.ZP.capture(eH.f8.SUGGEST_LOWER_PLAN.CONTINUE_CLICKED),e.setCurrentStep(e.getNextStepAfterSuggestLowerPlan())},children:"Downgrade plan"})]}):(0,i.jsx)("div",{className:"p-6",children:(0,i.jsx)(X.O,{className:"h-16 w-full"})})},rr=()=>{let e=nQ();return(0,i.jsx)(i.Fragment,{children:(()=>{switch(e.currentStep){case l.SUGGEST_LOWER_PLAN:return(0,i.jsx)(rn,{});case l.FEATURES_TO_TRY:return(0,i.jsx)(rs,{});case l.KTLO_OFFER:return(0,i.jsx)(rt,{});case l.FEEDBACK:return(0,i.jsx)(n7,{});case l.FINAL_CONFIRMATION:return(0,i.jsx)(re,{});default:return null}})()})};var rl=s(55596),ri=s(3714),ro=s(79392);let rc=e=>{let{workspace:t}=e,s=(0,e9.Iw)(t.plan),a=t.billing_period_end_date?(0,z.WU)(t.billing_period_end_date.toDate(),"MMM d, yyyy"):"";return(0,i.jsxs)("div",{className:"flex items-center justify-start gap-4",children:[(0,i.jsx)(n2.default,{src:"/img/logo/lovable-logo-icon.svg",alt:"Lovable",width:36,height:36,className:"h-9 w-9"}),(0,i.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,i.jsxs)("p",{className:"text-base font-medium text-foreground",children:["You're on ",s," Plan"]}),(0,i.jsxs)("p",{className:"text-base text-muted-foreground",children:[t.plan_scheduled?"Cancels":"Renews"," ",a]})]})]})},rd=e=>{let{workspace:t,open:s,onOpenChange:a}=e,{createPortalSession:n,isCreatePortalSessionLoading:r,setFreePlanAsTarget:l,onDowngradeClick:o}=(0,nT.tS)(),c=async()=>{await n()},d=async()=>{await n()},u="free"===t.plan_scheduled;return(0,i.jsx)(tu.Vq,{open:s,onOpenChange:()=>{a(!1)},children:(0,i.jsxs)(tu.cZ,{className:"sm:max-w-[500px]",children:[(0,i.jsxs)(tu.fK,{children:[(0,i.jsx)(tu.$N,{children:"Manage Plan"}),(0,i.jsx)(tu.Be,{children:"Subscription & Billing Settings"})]}),(0,i.jsx)("div",{className:"flex flex-col gap-4 border-y py-4",children:(0,i.jsxs)("div",{className:"flex items-center justify-between gap-4 rounded-xl bg-muted p-4",children:[(0,i.jsx)(rc,{workspace:t}),u?(0,i.jsx)(j.z,{onClick:d,disabled:r,variant:"outline",className:"w-full",children:r?"Opening...":"Cancel Downgrade"}):(0,i.jsx)(j.z,{variant:"outline",onClick:()=>{l(),null==o||o(),a(!1)},children:"Downgrade to Free"})]})}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(j.z,{variant:"secondary",onClick:c,disabled:r,className:"w-5/6",children:r?"Opening...":"View Invoices"}),(0,i.jsx)(j.z,{onClick:c,disabled:r,className:"w-full",children:r?"Opening...":"Payment Preferences"})]})]})})},ru=e=>{let{workspace:t,shouldDisableWorkspaceAdminActions:s}=e,{createPortalSession:a,isCreatePortalSessionLoading:n}=(0,nT.tS)();if(!t.plan_scheduled)return null;let r=(0,e9.Iw)(t.plan),l=(0,e9.Iw)(t.plan_scheduled),o=t.billing_period_end_date?(0,z.WU)(t.billing_period_end_date.toDate(),"MMM d, yyyy"):"";return(0,i.jsx)("div",{className:"space-y-3",children:(0,i.jsx)("div",{className:"space-y-3 rounded-md bg-warning p-3",children:(0,i.jsxs)("div",{className:"flex items-start gap-2",children:[(0,i.jsx)(b.Z,{name:"info",size:"small",className:"mt-0.5 flex-shrink-0 text-warning-primary"}),(0,i.jsxs)("div",{className:"flex w-full flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"text-sm font-medium text-warning-primary",children:["Pending changes scheduled for ",o]}),(0,i.jsxs)("p",{className:"text-sm text-warning-primary",children:[r," → ",l]})]}),(0,i.jsx)("div",{children:(0,i.jsx)(j.z,{variant:"warning",size:"default",disabled:n||s,onClick:()=>{a()},children:n?"Opening...":"Cancel changes"})})]})]})})})},rm=e=>{let{workspace:t,myWorkspaceRole:s}=e,[a,n]=(0,o.useState)(!1),r=(0,ri.t)(t),{currentPlan:l,shouldDisableWorkspaceAdminActions:c}=(0,nT.tS)(),d=(0,e9.Iw)(l.id),u=t.plan,m=(0,e9.XB)(u),p=()=>{let e=(0,e9.fA)(t.plan),s="ambassador"===t.plan;return(!e&&!s||(null==t?void 0:t.billing_period_credits_limit)!==0&&(null==t?void 0:t.billing_period_credits_limit)!==void 0)&&"free"!==t.plan&&!!t.billing_period_credits_limit&&!(t.billing_period_credits_limit<=0)},x=(()=>{if(!p())return null;let e="annual"===t.plan_type,s=t.billing_period_credits_limit;return"Up to ".concat((0,ro.H)(e?12*s:s)," credits rollover")})(),h=(()=>{if(!r.billingPeriodEndDate||!p())return null;let e=(0,z.WU)(r.billingPeriodEndDate,"do MMMM"),s=null==t?void 0:t.billing_period_credits_limit;return s?"".concat((0,ro.H)(s)," monthly credits reset on ").concat(e):"Monthly credits reset on ".concat(e)})();return m?(0,i.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,i.jsx)(ru,{workspace:t,shouldDisableWorkspaceAdminActions:c}),(0,i.jsxs)("div",{className:"flex flex-col gap-6 lg:grid lg:grid-cols-3",children:[(0,i.jsx)(a4.Zb,{className:"rounded-xl bg-muted p-4 shadow-sm",children:(0,i.jsxs)("div",{className:"flex h-full flex-col justify-between gap-4",children:[(0,i.jsx)(rc,{workspace:t}),(0,i.jsx)("div",{className:"flex justify-start",children:(0,i.jsx)(j.z,{variant:"outline",size:"default",disabled:c,onClick:()=>n(!0),children:"Manage"})})]})}),(0,i.jsx)(a4.Zb,{className:"col-span-2 rounded-xl bg-muted p-4 shadow-sm outline outline-1 outline-offset-[-1px] outline-border",children:(0,i.jsxs)("div",{className:"flex h-full flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("p",{className:"text-base font-medium text-foreground",children:"Credits"}),(0,i.jsxs)("p",{className:"text-sm font-normal text-muted-foreground",children:[(0,ro.H)(r.totalRemaining)," of"," ",(0,ro.H)(r.totalAllocation)," left"]})]}),(0,i.jsx)(rl.j,{progressData:r}),(r.currentlyConsuming||0===r.totalRemaining)&&(0,i.jsx)("div",{className:"flex flex-col gap-2",children:(0,i.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 sm:order-2",children:[(0,i.jsx)("div",{className:"ml-1 mr-0.5 h-2 w-2 rounded-full ".concat(r.currentlyConsuming?r.currentlyConsumingColorClass:"bg-muted-foreground")}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:(e=>{switch(e){case"daily":return"Daily credits used first";case"rollover":return"Using rollover credits";case"billing":return"Using monthly credits";case"granted":return"Using bonus credits";case null:return"You are out of credits"}})(r.currentlyConsuming)})]}),(x||h)&&(0,i.jsxs)("div",{className:"flex flex-col gap-2 sm:order-1",children:[x&&(0,i.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,i.jsx)(b.Z,{name:"check",size:"small",className:"mt-0.5 text-foreground"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:x})]}),h&&(0,i.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,i.jsx)(b.Z,{name:"check",size:"small",className:"mt-0.5 text-foreground"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:h})]})]})]})})]})})]}),(0,i.jsx)(rd,{workspace:t,myWorkspaceRole:s,open:a,onOpenChange:n})]}):"inactive"!==u?(0,i.jsx)(a4.Zb,{className:"flex w-full flex-col gap-4 bg-muted p-4",children:(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,i.jsxs)("span",{children:["You're currently on plan:"," ",(0,i.jsx)("span",{className:"font-medium capitalize",children:d}),". "]})," ",(0,i.jsx)(rp,{workspace:t,children:"Manage your payment preferences and view past invoices"}),", or change your plan below."]})}):void 0},rp=e=>{let{workspace:t,children:s}=e,{createPortalSession:a,isCreatePortalSessionLoading:n}=(0,nR.m)();return(0,i.jsx)("span",{role:"button",tabIndex:0,onClick:()=>{n||a({workspaceId:t.id})},onKeyDown:e=>{n||"Enter"!==e.key&&" "!==e.key||a({workspaceId:t.id})},className:"inline cursor-pointer underline disabled:opacity-50","aria-disabled":n,children:s})},rx=e=>{var t,s;let{workspace:a,showDowngradeConfirmation:n,setShowDowngradeConfirmation:r}=e,l=(0,nT.tS)(),o=(0,t_.$d)(),c=()=>{l.setTargetDowngradePlan(null),r(!1)};return o?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tu.Vq,{open:n,onOpenChange:e=>{e||c()},children:(0,i.jsx)(tu.cZ,{className:"pointer-events-auto flex max-h-[95vh] flex-col gap-4 overflow-y-auto outline-none",children:(0,i.jsx)(nH,{targetPlan:null!==(s=l.targetDowngradePlan)&&void 0!==s?s:void 0,onCancel:c,workspace:a,children:(0,i.jsx)(rr,{})})})}),(0,i.jsx)(nL.S,{className:"w-full",showEnterprise:!0})]}):n?(0,i.jsx)(n3,{workspace:a,targetPlan:null!==(t=l.targetDowngradePlan)&&void 0!==t?t:void 0,onCancel:c}):(0,i.jsx)(nL.S,{className:"w-full",showEnterprise:!0})},rh=e=>{let{workspace:t,myWorkspaceRole:s}=e,a="inactive"===t.plan,[n,r]=(0,o.useState)(!1),[l,c]=(0,o.useState)(!1),[d,u]=(0,o.useState)(null),m=(0,tO.useSearchParams)();(0,o.useEffect)(()=>{let e=m.get("planChanged"),t=m.get("planName");if("true"===e&&t){u({planName:t}),c(!0);let e=new URL(window.location.href);e.searchParams.delete("planChanged"),e.searchParams.delete("planName"),window.history.replaceState({},"",e.toString())}},[m]);let x=(0,t_.Kq)();return(0,i.jsxs)(p.tM,{title:"Plans & Billing",value:"billing",docsLink:"https://docs.lovable.dev/user-guides/messaging-limits",children:[(0,i.jsxs)(nP.om,{planCardContext:"billing",workspace:t,myWorkspaceRole:s,onDowngradeClick:()=>r(!0),children:[a?(0,i.jsxs)("span",{children:["Your subscription is currently"," ",(0,i.jsx)("span",{className:"font-medium",children:"inactive"}),". You can select a new plan below to restore full functionality to your workspace."]}):null,!n&&(x?(0,i.jsx)(rm,{workspace:t,myWorkspaceRole:s}):(0,i.jsx)(nK,{workspace:t,myWorkspaceRole:s})),(0,i.jsx)(rx,{workspace:t,showDowngradeConfirmation:n,setShowDowngradeConfirmation:r})]}),(0,i.jsx)(tu.Vq,{open:l,onOpenChange:c,children:(0,i.jsxs)(tu.cZ,{className:"gap-4 outline-none focus:ring-0",size:"md",hideCloseButton:!0,blurOverlay:!0,onInteractOutside:e=>{e.preventDefault(),e.stopPropagation()},children:[(0,i.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,i.jsx)(tS.xx,{className:"h-9"}),(0,i.jsxs)(tu.fK,{children:[(0,i.jsxs)(tu.$N,{className:"text-2xl md:text-3xl",children:["Plan successfully changed to ",null==d?void 0:d.planName,"!"]}),(0,i.jsx)(tu.Be,{children:"Your new plan will be activated at the start of the next billing cycle."})]})]}),(0,i.jsx)(tu.cN,{fullWidthButtons:!0,className:"flex-col gap-2",children:(0,i.jsxs)(j.z,{onClick:e=>{e.preventDefault(),e.stopPropagation(),c(!1),u(null),r(!1)},className:"w-full",children:[(0,i.jsx)(b.Z,{name:"check",size:"small",className:"mr-2"}),"Got it!"]})})]})})]})};var rg=s(29984);let rf=rg.fC;rg.xz;let rj=rg.h_,rv=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(rg.aV,{className:(0,q.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t})});rv.displayName=rg.aV.displayName;let rb=o.forwardRef((e,t)=>{let{className:s,overlayClassName:a,...n}=e;return(0,i.jsxs)(rj,{children:[(0,i.jsx)(rv,{className:a}),(0,i.jsx)(rg.VY,{ref:t,className:(0,q.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...n})]})});rb.displayName=rg.VY.displayName;let ry=e=>{let{className:t,...s}=e;return(0,i.jsx)("div",{className:(0,q.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};ry.displayName="AlertDialogHeader";let rw=e=>{let{className:t,...s}=e;return(0,i.jsx)("div",{className:(0,q.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};rw.displayName="AlertDialogFooter";let rN=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(rg.Dx,{ref:t,className:(0,q.cn)("font-semibold text-lg",s),...a})});rN.displayName=rg.Dx.displayName;let r_=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(rg.dk,{ref:t,className:(0,q.cn)("text-sm text-muted-foreground",s),...a})});r_.displayName=rg.dk.displayName;let rk=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(rg.aU,{ref:t,className:(0,q.cn)((0,j.d)(),s),...a})});rk.displayName=rg.aU.displayName;let rS=o.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(rg.$j,{ref:t,className:(0,q.cn)((0,j.d)({variant:"outline"}),"mt-2 sm:mt-0",s),...a})});rS.displayName=rg.$j.displayName;var rC=s(49360);let rE=e=>{let{workspace:t,onSuccess:s,onCancel:a,initialData:n,domainOnly:r=!1}=e,[l,c]=(0,o.useState)("domain"),[d,u]=(0,o.useState)((null==n?void 0:n.domain)||""),[m,p]=(0,o.useState)(!1),[x,h]=(0,o.useState)(""),{register:f,handleSubmit:v,formState:{errors:y,isSubmitting:w},getValues:N}=(0,tK.cI)({defaultValues:{clientId:(null==n?void 0:n.clientId)||"",clientSecret:(null==n?void 0:n.clientSecret)||"",issuer:(null==n?void 0:n.issuer)||""},mode:"onBlur"}),{mutateAsync:_,isPending:k}=(0,tn.D)({mutationFn:async()=>{let e=(0,g.SJ)();return await e.post("/workspaces/".concat(t.id,"/identity/verify-domain"),{domain:d}),p(!0),h(""),!0},onError:e=>{h(e.message),eT.Am.error(e.message)}}),{mutateAsync:S}=(0,tn.D)({mutationFn:async e=>{let s=(0,g.SJ)(),a=(0,rC.Z)().replace(/-/g,"").slice(0,8);return await s.post("/workspaces/".concat(t.id,"/identity/add-oidc-provider"),{displayName:a,oidc:{clientId:e.clientId,clientSecret:e.clientSecret,issuer:e.issuer}})},onSuccess:()=>{c("complete"),eT.Am.success("SSO provider added successfully!"),null==s||s()},onError:e=>{eT.Am.error(e.message,{description:"Please check your OIDC provider settings and try again."})}}),C=async()=>{if("domain"===l&&m)r?(c("complete"),null==s||s()):c("oidc");else if("oidc"===l){let e=N();await S({clientId:e.clientId,clientSecret:e.clientSecret,issuer:e.issuer}).then(()=>{c("verification")}).catch(()=>{})}};return"complete"===l?(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)(b.Z,{name:"check",className:"mx-auto h-16 w-16 text-success-primary"}),(0,i.jsx)("h3",{className:"mt-4 text-lg font-medium",children:r?"Domain Added Successfully!":"SSO Provider Added Successfully!"}),(0,i.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:r?"Your domain has been verified and is ready to use for SSO authentication.":"Your SSO provider has been configured and is ready to use."})]}),(0,i.jsxs)(a4.Zb,{children:[(0,i.jsx)(a4.Ol,{children:(0,i.jsx)(a4.ll,{className:"text-sm",children:r?"Domain Details":"Provider Details"})}),(0,i.jsxs)(a4.aY,{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-sm text-muted-foreground",children:"Domain:"}),(0,i.jsx)("span",{className:"text-sm font-medium",children:d})]}),!r&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-sm text-muted-foreground",children:"Provider Type:"}),(0,i.jsx)(sS.C,{variant:"outline",children:"OIDC"})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-sm text-muted-foreground",children:"Status:"}),(0,i.jsx)(sS.C,{variant:"default",className:"bg-green-100 text-green-800",children:"Active"})]})]})]})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,i.jsx)(j.z,{variant:"outline",onClick:a,children:"Close"}),!r&&(0,i.jsx)(j.z,{onClick:()=>c("domain"),children:"Add Another Provider"})]})]}):(0,i.jsxs)("div",{className:"space-y-6",children:["domain"===l&&(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(t5.Label,{htmlFor:"domain",children:"Domain"}),(0,i.jsx)(tM.I,{id:"domain",value:d,onChange:e=>u(e.target.value),placeholder:"yourdomain.com",disabled:m,className:"mt-1"})]}),!m&&(0,i.jsxs)(sU.bZ,{children:[(0,i.jsx)(b.Z,{name:"info",size:"small"}),(0,i.jsx)(sU.Cd,{children:"Domain Verification Required"}),(0,i.jsxs)(sU.X,{children:["To verify your domain, add the following TXT record to your DNS provider:",(0,i.jsxs)("div",{className:"mt-2 flex gap-2 rounded bg-muted p-2 font-mono text-sm text-foreground",children:[(0,i.jsx)("div",{children:"TXT"}),(0,i.jsx)("div",{children:"@"}),(0,i.jsxs)("div",{className:"break-all",children:["lovable_verification=",t.id]})]}),(0,i.jsx)("p",{className:"mt-2 text-xs",children:"DNS changes may take a few minutes to propagate."})]})]}),x&&(0,i.jsxs)(sU.bZ,{variant:"destructive",children:[(0,i.jsx)(b.Z,{name:"info",size:"small"}),(0,i.jsx)(sU.Cd,{children:"Verification Failed"}),(0,i.jsx)(sU.X,{children:x})]}),m&&(0,i.jsxs)(sU.bZ,{variant:"success",children:[(0,i.jsx)(b.Z,{name:"check"}),(0,i.jsx)(sU.Cd,{children:"Domain Verified!"}),(0,i.jsx)(sU.X,{children:"Your domain has been successfully verified."})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)(j.z,{variant:"outline",onClick:a,children:"Cancel"}),(0,i.jsxs)("div",{className:"space-x-2",children:[!m&&(0,i.jsx)(j.z,{onClick:()=>_(),disabled:k||!d,loading:k,children:k?"Verifying...":"Verify Domain"}),m&&(0,i.jsx)(j.z,{onClick:C,children:"Continue"})]})]})]}),"oidc"===l&&(0,i.jsxs)("form",{className:"space-y-4",onSubmit:v(async e=>{await S({clientId:e.clientId,clientSecret:e.clientSecret,issuer:e.issuer}).then(()=>c("verification")).catch(()=>{})}),noValidate:!0,children:[(0,i.jsxs)(sU.bZ,{children:[(0,i.jsx)(b.Z,{name:"info",size:"small"}),(0,i.jsx)(sU.Cd,{children:"OIDC Configuration"}),(0,i.jsx)(sU.X,{children:"Configure your OIDC provider settings. You'll need to obtain these values from your identity provider."})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(t5.Label,{htmlFor:"clientId",children:"Client ID"}),(0,i.jsx)(tM.I,{id:"clientId",...f("clientId",{required:"Client ID is required"}),placeholder:"Enter your OIDC client ID",className:y.clientId?"mt-1 border-destructive-foreground":"mt-1","aria-invalid":!!y.clientId,"aria-describedby":"clientId-error"}),y.clientId&&(0,i.jsx)("p",{className:"mt-1 text-xs text-destructive-foreground",id:"clientId-error",children:y.clientId.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(t5.Label,{htmlFor:"clientSecret",children:"Client Secret"}),(0,i.jsx)(tM.I,{id:"clientSecret",type:"password",...f("clientSecret",{required:"Client Secret is required"}),placeholder:"Enter your OIDC client secret",className:y.clientSecret?"mt-1 border-destructive-foreground":"mt-1","aria-invalid":!!y.clientSecret,"aria-describedby":"clientSecret-error"}),y.clientSecret&&(0,i.jsx)("p",{className:"mt-1 text-xs text-destructive-foreground",id:"clientSecret-error",children:y.clientSecret.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(t5.Label,{htmlFor:"issuer",children:"Issuer URL"}),(0,i.jsx)(tM.I,{id:"issuer",...f("issuer",{required:"Issuer URL is required",pattern:{value:/^https?:\/\/.+/,message:"Must be a valid URL (starting with http(s)://)"},validate:e=>{try{return new URL(e),!0}catch(e){return"Must be a valid URL"}}}),placeholder:"https://your-identity-provider.com",className:y.issuer?"mt-1 border-destructive-foreground":"mt-1","aria-invalid":!!y.issuer,"aria-describedby":"issuer-error"}),y.issuer&&(0,i.jsx)("p",{className:"mt-1 text-xs text-destructive-foreground",id:"issuer-error",children:y.issuer.message})]})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)(j.z,{variant:"outline",onClick:()=>{"oidc"===l?c("domain"):"verification"===l&&c("oidc")},type:"button",children:[(0,i.jsx)(b.Z,{name:"arrow_left_alt",size:"small"}),"Back"]}),(0,i.jsx)(j.z,{type:"submit",disabled:w,children:"Configure Provider"})]})]}),"verification"===l&&(0,i.jsx)("div",{className:"space-y-4",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)(Z.$,{size:"large"}),(0,i.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"Configuring SSO Provider"}),(0,i.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Please wait while we configure your SSO provider..."})]})})]})},rA=e=>{let{workspace:t}=e,[s,a]=(0,o.useState)([{type:"list",title:"Identity & Access"}]),[n,r]=(0,o.useState)(null),[l,c]=(0,o.useState)(null),d=(0,et.NL)(),u=(0,g.SJ)(),{data:m=[],isLoading:x,error:f}=(0,h.a)({queryKey:["sso-providers",t.id],queryFn:async()=>await u.get("/workspaces/".concat(t.id,"/identity/sso-providers"))}),{data:v=[],isLoading:y,error:w}=(0,h.a)({queryKey:["verified-domains",t.id],queryFn:async()=>(await u.get("/workspaces/".concat(t.id,"/identity/verified-domains"))).domains}),N=(0,tn.D)({mutationFn:async e=>{await u.delete("/workspaces/".concat(t.id,"/identity/sso-providers/").concat(e))},onSuccess:()=>{d.invalidateQueries({queryKey:["sso-providers",t.id]}),r(null),eT.Am.success("SSO provider deleted successfully")},onError:e=>{r(null),eT.Am.error(e.message||"Failed to delete SSO provider")}}),_=(0,tn.D)({mutationFn:async e=>{await u.delete("/workspaces/".concat(t.id,"/identity/verified-domains/").concat(e))},onSuccess:()=>{d.invalidateQueries({queryKey:["verified-domains",t.id]}),c(null),eT.Am.success("Domain deleted successfully")},onError:e=>{eT.Am.error(e.message||"Failed to delete domain"),c(null)}}),k=s[s.length-1],S=()=>{if(!R){L();return}r(null),c(null),a(e=>[...e,{type:"add-provider",title:"Add SSO Provider"}])},C=()=>{r(null),c(null),a(e=>e.slice(0,-1))},E=()=>{r(null),c(null),a([{type:"list",title:"Identity & Access"}])},A=e=>(0,i.jsx)(sS.C,{variant:"affirmative",children:"Active"}),D=e=>{switch(e){case"oidc":return(0,i.jsx)(b.Z,{name:"security"});case"saml":return(0,i.jsx)(b.Z,{name:"key"});default:return(0,i.jsx)(b.Z,{name:"settings"})}},z=e=>{r(e)},I=()=>{r(null)},O=e=>{c(e)},P=()=>{c(null)},T=(0,eZ.z)(eL.g),L=()=>{T({childProps:{dialogDescription:"You need to be on a business plan to add SSO providers."}})},R=(0,e9.Qx)(t.plan)||(0,e9.gG)(t.plan);return f?(0,i.jsx)(p.tM,{value:"identity",title:"Identity",description:"Manage your workspace identity and SSO.",children:(0,i.jsx)("div",{className:"space-y-6",children:(0,i.jsx)(a4.Zb,{children:(0,i.jsx)(a4.aY,{className:"p-6",children:(0,i.jsxs)("div",{className:"text-center text-destructive-primary",children:["Error loading SSO providers: ",f.message]})})})})}):(0,i.jsxs)(p.tM,{value:"identity",title:"Identity",description:"Manage your workspace identity and SSO.",customBadge:(0,i.jsx)(e7.y,{workspace:t,requiredPlanId:"biz"}),children:[s.length<=1?null:(0,i.jsx)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:s.map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[t>0&&(0,i.jsx)(b.Z,{name:"chevron_right",size:"small"}),t===s.length-1?(0,i.jsx)("span",{className:"font-medium text-foreground",children:e.title}):(0,i.jsx)("button",{onClick:()=>a(e=>e.slice(0,t+1)),className:"transition-colors hover:text-foreground",children:e.title})]},t))}),"list"===k.type&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between border-b pb-4",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsx)("h2",{className:"text-xl font-medium",children:"SSO Providers"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"Configure single sign-on providers for your workspace"})]}),(0,i.jsx)(e3.b,{showTooltip:m.length>0,tooltipContent:"Only one SSO provider can be configured at a time. Delete the existing provider to add a new one.",children:(0,i.jsxs)(j.z,{onClick:S,variant:"secondary",disabled:m.length>0,children:[(0,i.jsx)(b.Z,{name:"add",size:"small"}),"Add Provider",m.length>0&&(0,i.jsx)(b.Z,{name:"info",size:"small"})]})})]}),x?(0,i.jsxs)("div",{className:"py-8 text-center",children:[(0,i.jsx)(b.Z,{name:"security",className:"mx-auto h-12 w-12 animate-pulse text-muted-foreground"}),(0,i.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"Loading SSO providers..."})]}):0===m.length?(0,i.jsxs)("div",{className:"py-8 text-center",children:[(0,i.jsx)(b.Z,{name:"security",className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,i.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"No SSO providers configured"}),(0,i.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Get started by adding your first SSO provider to enable single sign-on for your workspace."}),(0,i.jsxs)(j.z,{className:"mt-4",onClick:S,disabled:m.length>0,children:[(0,i.jsx)(b.Z,{name:"add",size:"small"}),"Add Provider"]})]}):(0,i.jsx)("div",{className:"space-y-4",children:m.map(e=>{let t="https://lovable.dev/sso-login/"+e.provider_id;return(0,i.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-4 transition-colors hover:bg-muted/50",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted",children:D(e.type)}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("h4",{className:"font-medium",children:[e.provider_id," "]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)("h5",{className:"text-xs text-muted-foreground",children:["Login URL:"," ",(0,i.jsx)("span",{className:"text-xs text-muted-foreground",children:t})]}),(0,i.jsxs)(ep.u,{delayDuration:0,children:[(0,i.jsx)(ep.aJ,{children:(0,i.jsx)(j.z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-muted",onClick:async()=>{await navigator.clipboard.writeText(t),eT.Am.success("Login URL copied to clipboard")},children:(0,i.jsx)(b.Z,{name:"content_copy",size:"small"})})}),(0,i.jsx)(ep._v,{children:"Copy Login URL"})]})]}),(0,i.jsxs)("div",{className:"mt-1 flex items-center space-x-2",children:[A(e),(0,i.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Added"," ",new Date(e.created_at).toLocaleDateString()]})]})]})]}),(0,i.jsx)("div",{className:"flex items-center space-x-2",children:(0,i.jsx)(j.z,{variant:"ghost",size:"sm",className:"hover:bg-destructive-foreground/10 hover:text-destructive-foreground",onClick:()=>z(e.id),children:"Delete"})})]},e.id)})}),(0,i.jsx)(rf,{open:!!n,onOpenChange:e=>{e||I()},children:(0,i.jsxs)(rb,{overlayClassName:"z-[11000]",className:"z-[11000]",children:[(0,i.jsxs)(ry,{children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(b.Z,{name:"delete",className:"text-destructive-foreground"}),(0,i.jsx)(rN,{children:"Delete SSO Provider"})]}),(0,i.jsx)(r_,{children:"Are you sure you want to delete this SSO provider? This action cannot be undone and will disable SSO authentication for this provider."})]}),(0,i.jsxs)(rw,{children:[(0,i.jsx)(rS,{asChild:!0,children:(0,i.jsx)(j.z,{variant:"outline",size:"sm",disabled:N.isPending,children:"Cancel"})}),(0,i.jsx)(rk,{asChild:!0,children:(0,i.jsx)(j.z,{variant:"destructive",size:"sm",onClick:()=>{n&&(N.mutate(n),r(null))},disabled:N.isPending,children:N.isPending?"Deleting...":"Delete"})})]})]})}),(0,i.jsxs)("div",{className:"flex items-center justify-between border-b pb-4",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsx)("h2",{className:"text-xl font-medium",children:"Verified Domains"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"Domains that are verified for SSO authentication"})]}),(0,i.jsxs)(j.z,{onClick:()=>{if(!R){L();return}r(null),c(null),a(e=>[...e,{type:"add-domain",title:"Add Verified Domain"}])},variant:"secondary",children:[(0,i.jsx)(b.Z,{name:"add",size:"small"}),"Add Domain"]})]}),y?(0,i.jsxs)("div",{className:"py-8 text-center",children:[(0,i.jsx)(b.Z,{name:"link",className:"mx-auto h-12 w-12 animate-pulse text-muted-foreground"}),(0,i.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"Loading verified domains..."})]}):w?(0,i.jsxs)("div",{className:"py-8 text-center",children:[(0,i.jsx)(b.Z,{name:"error",className:"mx-auto h-12 w-12 text-destructive"}),(0,i.jsx)("h3",{className:"mt-4 text-lg font-medium text-destructive",children:"Error loading verified domains"}),(0,i.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:w.message})]}):0===v.length?(0,i.jsxs)("div",{className:"py-8 text-center",children:[(0,i.jsx)(b.Z,{name:"link",className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,i.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"No verified domains"}),(0,i.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Add a verified domain to enable SSO authentication for your workspace."})]}):(0,i.jsx)("div",{className:"space-y-4",children:v.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-4 transition-colors hover:bg-muted/50",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted",children:(0,i.jsx)(b.Z,{name:"link"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"font-medium",children:e}),(0,i.jsx)("div",{className:"mt-1 flex items-center space-x-2",children:(0,i.jsx)(sS.C,{variant:"affirmative",children:"Verified"})})]})]}),(0,i.jsx)("div",{className:"flex items-center space-x-2",children:(0,i.jsx)(j.z,{variant:"ghost",size:"sm",className:"hover:bg-destructive-foreground/10 hover:text-destructive-foreground",onClick:()=>O(e),children:"Delete"})})]},e))}),(0,i.jsx)(rf,{open:!!l,onOpenChange:e=>{e||P()},children:(0,i.jsxs)(rb,{overlayClassName:"z-[11000]",className:"z-[11000]",children:[(0,i.jsxs)(ry,{children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(b.Z,{name:"delete",className:"text-destructive-foreground"}),(0,i.jsx)(rN,{children:"Delete Verified Domain"})]}),(0,i.jsx)(r_,{children:"Are you sure you want to delete this verified domain? This action will disable SSO authentication for this domain."})]}),(0,i.jsxs)(rw,{children:[(0,i.jsx)(rS,{asChild:!0,children:(0,i.jsx)(j.z,{variant:"outline",size:"sm",disabled:_.isPending,children:"Cancel"})}),(0,i.jsx)(rk,{asChild:!0,children:(0,i.jsx)(j.z,{variant:"destructive",size:"sm",onClick:()=>{l&&_.mutate(l)},disabled:_.isPending,children:_.isPending?"Deleting...":"Delete"})})]})]})}),(0,i.jsxs)("div",{className:"flex flex-col gap-1 border-b pb-4",children:[(0,i.jsx)("h2",{className:"text-xl font-medium",children:"Security & Access Control"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"Features that help you secure your workspace and control access to your projects"})]}),(0,i.jsx)(eM.P,{label:"Just-in-Time Provisioning",description:"Automatically creates user accounts when they sign in via SSO",justify:"end"}),(0,i.jsx)(eM.P,{label:"Enforce SSO",description:"Require all workspace members to use SSO for authentication",justify:"end",children:(0,i.jsx)(sS.C,{variant:"outline",children:"Coming Soon"})})]}),"add-provider"===k.type&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1 border-b pb-4",children:[(0,i.jsx)("h2",{className:"text-xl font-medium",children:"Add SSO Provider"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"Configure a new single sign-on provider for your workspace"})]}),(0,i.jsx)(rE,{workspace:t,onSuccess:()=>{d.invalidateQueries({queryKey:["sso-providers",t.id]}),E()},onCancel:C})]}),"add-domain"===k.type&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1 border-b pb-4",children:[(0,i.jsx)("h2",{className:"text-xl font-medium",children:"Add Verified Domain"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add a new domain for SSO authentication"})]}),(0,i.jsx)(rE,{workspace:t,onSuccess:()=>{d.invalidateQueries({queryKey:["verified-domains",t.id]}),E()},onCancel:C,domainOnly:!0})]})]})};var rD=s(32800),rz=s(19878);let rI=e=>"owner"===e,rO=e=>"admin"===e,rP=e=>(0,e9.Ll)(e.plan),rT={ADD_EDITOR:"claim.workspace.add_editor",ADD_ADMIN:"claim.workspace.add_admin",SEE_USAGE:"claim.workspace.see_usage",MANAGE_PLAN:"claim.workspace.manage_plan",REMOVE_EDITOR:"claim.workspace.remove_editor",REMOVE_ADMIN:"claim.workspace.remove_admin",PROJECT_MAGIC_LINK:"claim.project.magic_link"};class rL{canEmailInvite(){return this.claims.has(rT.ADD_EDITOR)}canSetInviteRole(){return this.claims.has(rT.ADD_ADMIN)}canEditRole(){let{targetRole:e}=this.context;return rO(e)?this.claims.has(rT.REMOVE_ADMIN):this.claims.has(rT.REMOVE_EDITOR)&&!rI(e)}canSeeUsage(){return this.claims.has(rT.SEE_USAGE)}canCreateSecretLink(){return this.claims.has(rT.PROJECT_MAGIC_LINK)}canManagePlan(){return this.claims.has(rT.MANAGE_PLAN)}canRemoveMember(){let{targetRole:e}=this.context;return rO(e)?this.claims.has(rT.REMOVE_ADMIN):this.claims.has(rT.REMOVE_EDITOR)&&!rI(e)}constructor(e){this.context=e,this.claims=new Set;let{role:t}=e,s=rP(e.workspace);"free"===s?rI(t)&&(this.claims.add(rT.ADD_EDITOR),this.claims.add(rT.SEE_USAGE),this.claims.add(rT.MANAGE_PLAN),this.claims.add(rT.REMOVE_EDITOR),this.claims.add(rT.PROJECT_MAGIC_LINK)):(rI(t)?(this.claims.add(rT.ADD_EDITOR),this.claims.add(rT.ADD_ADMIN),this.claims.add(rT.SEE_USAGE),this.claims.add(rT.MANAGE_PLAN),this.claims.add(rT.REMOVE_EDITOR),this.claims.add(rT.REMOVE_ADMIN),this.claims.add(rT.PROJECT_MAGIC_LINK)):rO(t)&&(this.claims.add(rT.ADD_EDITOR),this.claims.add(rT.SEE_USAGE),this.claims.add(rT.REMOVE_EDITOR),this.claims.add(rT.PROJECT_MAGIC_LINK)),"pro"!==s&&"ktlo"!==s||rI(t)||this.claims.delete(rT.PROJECT_MAGIC_LINK))}}let rR=e=>new rL(e),rF=e=>{let{workspace:t,authUserId:s,role:a,targetRole:n}=e;return(0,o.useMemo)(()=>{let e={workspace:t,isWorkspaceOwner:s===t.owner_id,role:a,targetRole:n},r=rR(e);return{canEmailInvite:()=>r.canEmailInvite(),canSetInviteRole:()=>r.canSetInviteRole(),canEditRole:()=>r.canEditRole(),canSeeUsage:()=>r.canSeeUsage(),canCreateSecretLink:()=>r.canCreateSecretLink(),canManagePlan:()=>r.canManagePlan(),canRemoveMember:()=>r.canRemoveMember(),isWorkspaceOwner:e.isWorkspaceOwner}},[t,s,a,n])};var rZ=s(40782),rM=s(70335);let rq=e=>{let{workspace:t,memberships:s}=e,a=new Date().getMonth()+1,n=new Date().getFullYear(),{data:r}=(0,h.a)(ss.t.workspaceUsage({workspaceId:null==t?void 0:t.id,month:a,year:n})),{data:l}=(0,h.a)(ss.t.workspaceUserTotalUsage({workspaceId:null==t?void 0:t.id})),c=(0,o.useMemo)(()=>null==l?void 0:l.map(e=>{let t=s.find(t=>t.user_id===e.user_id);return t?{...e,membership:t}:null}).filter(e=>null!==e).sort((e,t)=>t.count-e.count),[l,s]),d=(0,o.useMemo)(()=>null==r?void 0:r.user_usages.map(e=>{let t=s.find(t=>t.user_id===e.user_id);return t?{...e,membership:t}:null}).filter(e=>null!==e).sort((e,t)=>t.count-e.count),[r,s]);return(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("p",{className:"pb-2 text-sm text-muted-foreground",children:["Showing usage for"," ",(0,z.WU)(new Date(n,a-1),"MMMM yyyy"),"."]}),(0,i.jsx)("div",{className:"flex flex-col gap-2",children:(null==d?void 0:d.length)===0?(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:"No usage data for this period. Usage will appear here once members begin using the workspace."}):null==d?void 0:d.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(rM.Y,{user:{id:e.user_id,username:e.membership.display_name||e.membership.email},photoURL:e.membership.photo_url}),(0,i.jsx)("p",{className:"text-sm font-medium",children:e.membership.display_name})]}),(0,i.jsxs)("div",{className:"text-muted-foreground",children:[(0,nU.H)(e.count)," credit",1===e.count?"":"s"," used"]})]},e.user_id))}),c&&c.length>0&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"border-t pt-4",children:[(0,i.jsx)("p",{className:"pb-2 text-sm text-muted-foreground",children:"Total usage across all months."}),(0,i.jsx)("div",{className:"flex flex-col gap-2",children:c.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(rM.Y,{user:{id:e.user_id,username:e.membership.display_name||e.membership.email},photoURL:e.membership.photo_url}),(0,i.jsx)("p",{className:"text-sm font-medium",children:e.membership.display_name})]}),(0,i.jsxs)("div",{className:"font-medium text-muted-foreground",children:[(0,nU.H)(e.count)," credit",1===e.count?"":"s"," total"]})]},e.user_id))})]})})]})};var rU=s(45659),rK=s(61011),rG=e=>{let{memberName:t,onConfirm:s,onCancel:a}=e;return(0,i.jsx)(rK.Z,{title:"Remove workspace member",targetName:t,descriptionTemplate:"Are you sure you want to remove ".concat(t," from this workspace? They will no longer have access to any workspace projects or resources."),onConfirm:s,onCancel:a})},rW=s(82157);let rJ={owner:"Owner",admin:"Admin",member:"Editor"},rV={owner:"Owners can manage all collaborators, projects, and integrations.",admin:"Admins can manage editors, projects, and integrations.",member:"Editors can only create and edit projects."},rB=e=>{var t,s;let{currentMembership:a,workspaceId:n,memberships:r,workspace:l}=e,[c,u]=(0,o.useState)(null!==(s=a.credit_limit)&&void 0!==s?s:void 0),[m,p]=(0,o.useState)(!1),x=(0,o.useRef)(null),{authUser:h}=(0,d.Eu)(),f=a.user_id===(null==h?void 0:h.uid),y=(0,eZ.z)(rG),w=null===(t=r.find(e=>e.user_id===(null==h?void 0:h.uid)))||void 0===t?void 0:t.role,N=!a.joined_at,_=rF({workspace:l,authUserId:null==h?void 0:h.uid,role:w,targetRole:a.role}),k=_.canEditRole()&&!f&&!N,{updateWorkspaceMemberRole:S}=function(e){let{workspaceId:t}=e,s=(0,et.NL)(),{authUser:a}=(0,d.Eu)(),{mutateAsync:n}=(0,tn.D)({mutationFn:async e=>{let{userId:s,role:a}=e,n=(0,g.SJ)();await n.put("/user/workspaces/".concat(t,"/memberships/").concat(s),{role:a})},onMutate:async e=>{let n=ss.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid});await s.cancelQueries({queryKey:n.queryKey});let r=s.getQueryData(n.queryKey);return r&&s.setQueryData(n.queryKey,{...r,memberships:(0,rZ.q)(r.memberships.map(t=>t.user_id===e.userId?{...t,role:e.role}:t))}),{previousData:r}},onError:(e,n,r)=>{if((0,tr.Eo)(e),null==r?void 0:r.previousData){let e=ss.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid});s.setQueryData(e.queryKey,r.previousData)}},onSettled:()=>{s.invalidateQueries({queryKey:ss.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid}).queryKey})}});return{updateWorkspaceMemberRole:n}}({workspaceId:n}),{updateWorkspaceMemberCreditLimit:C}=function(e){let{workspaceId:t}=e,s=(0,et.NL)(),{authUser:a}=(0,d.Eu)(),{mutateAsync:n}=(0,tn.D)({mutationFn:async e=>{let{userId:s,creditLimit:a}=e,n=(0,g.SJ)();await n.put("/user/workspaces/".concat(t,"/memberships/").concat(s),{credit_limit:null!=a?a:-1})},onMutate:async e=>{let n=ss.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid});await s.cancelQueries({queryKey:n.queryKey});let r=s.getQueryData(n.queryKey);return r&&s.setQueryData(n.queryKey,{...r,memberships:(0,rZ.q)(r.memberships.map(t=>t.user_id===e.userId?{...t,credit_limit:-1===e.creditLimit?null:e.creditLimit}:t))}),{previousData:r}},onError:(e,n,r)=>{if((0,tr.Eo)(e),null==r?void 0:r.previousData){let e=ss.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid});s.setQueryData(e.queryKey,r.previousData)}},onSettled:()=>{s.invalidateQueries({queryKey:ss.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid}).queryKey})}});return{updateWorkspaceMemberCreditLimit:n}}({workspaceId:n}),{removeWorkspaceMember:E}=function(e){let{workspaceId:t}=e,s=(0,et.NL)(),{authUser:a}=(0,d.Eu)(),{mutateAsync:n}=(0,tn.D)({mutationFn:async e=>{let{userId:s}=e,a=(0,g.SJ)();await a.delete("/workspaces/".concat(t,"/memberships/").concat(s))},onMutate:async e=>{let n=ss.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid});await s.cancelQueries({queryKey:n.queryKey});let r=s.getQueryData(n.queryKey);return r&&s.setQueryData(n.queryKey,{...r,memberships:r.memberships.filter(t=>t.user_id!==e.userId)}),{previousData:r}},onError:(e,n,r)=>{if((0,tr.Eo)(e),null==r?void 0:r.previousData){let e=ss.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid});s.setQueryData(e.queryKey,r.previousData)}},onSettled:()=>{s.invalidateQueries({queryKey:ss.t.workspaceMemberships({workspaceId:t,userId:null==a?void 0:a.uid}).queryKey})}});return{removeWorkspaceMember:n}}({workspaceId:n}),A=(0,o.useCallback)(async e=>{N||await C({userId:a.user_id,creditLimit:isNaN(null!=e?e:0)?-1:e})},[a.user_id,N,C]);(0,o.useEffect)(()=>{let e=e=>{m&&x.current&&!x.current.contains(e.target)&&A(c).then(()=>{p(!1)})};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[m,c,C,A]);let D=async e=>{N||await S({userId:a.user_id,role:e})},z=()=>{y({childProps:{memberName:a.display_name||a.username,onConfirm:async()=>{await E({userId:a.user_id}),y(!1)},onCancel:()=>y(!1)}})},I=(0,t_.Tj)(),O=(0,i.jsxs)(i.Fragment,{children:[["owner","admin"].includes(null!=w?w:"")&&I&&(0,i.jsxs)(ep.u,{delayDuration:600,children:[(0,i.jsx)(ep.aJ,{children:(0,i.jsx)(i.Fragment,{children:m?(0,i.jsxs)("div",{ref:x,className:"relative flex items-center",children:[(0,i.jsx)(tM.I,{placeholder:"Limit / month",value:c||"",className:"max-w-32 pr-8 text-xs",onChange:e=>u(parseInt(e.target.value)),onKeyDown:e=>{if("Enter"===e.key)A(c).then(()=>{p(!1)});else if("Escape"===e.key){var t;u(null!==(t=a.credit_limit)&&void 0!==t?t:void 0),p(!1)}},autoFocus:!0}),(0,i.jsx)(j.z,{variant:"ghost",size:"icon",className:"absolute right-0.5 h-8 w-8 shadow-none hover:bg-accent hover:shadow-none",onClick:()=>{A(c).then(()=>{p(!1)})},children:(0,i.jsx)(b.Z,{name:"check",size:"small"})})]}):(0,i.jsx)(j.z,{variant:"ghost",size:"sm",className:"text-xs shadow-none hover:bg-accent hover:shadow-none",onClick:()=>p(!0),children:(null==a?void 0:a.credit_limit)?"".concat(a.credit_limit," credits/mo"):"No limit"})})}),(0,i.jsx)(ep._v,{className:"max-w-[30ch]",children:"Update credit limits for this member"})]}),(0,i.jsxs)(v.h_,{children:[(0,i.jsxs)(ep.u,{children:[(0,i.jsx)(ep.aJ,{children:(0,i.jsx)(v.$F,{asChild:!0,disabled:f||!_.canRemoveMember(),children:(0,i.jsxs)(j.z,{"aria-haspopup":"true",variant:"ghost",children:[N?"Pending":rJ[a.role]," ",(0,i.jsx)(b.Z,{name:"keyboard_arrow_down",size:"small",className:"opacity-50"})]})})}),(0,i.jsx)(ep._v,{className:"max-w-[30ch]",children:N?"This user has been invited to join as ".concat(rJ[a.role]):rV[a.role]})]}),(0,i.jsx)(v.AW,{align:"end",children:N?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(rW.w,{label:"Pending",isSelected:!0,onClick:()=>{},disabled:!0}),(0,i.jsx)(rW.w,{label:"Remove",destructive:!0,onClick:z})]}):(0,i.jsxs)(i.Fragment,{children:[_.canSetInviteRole()&&(0,i.jsx)(rW.w,{label:"Admin",isSelected:"admin"===a.role,onClick:()=>D("admin"),disabled:!k,tooltip:rV.admin}),(0,i.jsx)(rW.w,{label:"Editor",isSelected:"member"===a.role,onClick:()=>D("member"),disabled:!k,tooltip:rV.member}),(0,i.jsx)(rW.w,{label:f?"Leave":"Remove",destructive:!0,onClick:z})]})})]})]});return(0,i.jsx)(rU.Q,{id:a.user_id,username:a.username,displayName:a.display_name,photoURL:a.photo_url,avatarClassName:"h-8 w-8",actionComponent:O,isCurrentUser:f,email:a.email,isInvited:N})},rH=[{value:"admin",label:"Admin"},{value:"member",label:"Editor"}],rQ=e=>{var t;let{memberships:s,workspace:a}=e,{authUser:n}=(0,d.Eu)(),[r,l]=(0,o.useState)(""),c=null===(t=s.find(e=>e.user_id===(null==n?void 0:n.uid)))||void 0===t?void 0:t.role,u=rF({workspace:a,authUserId:null==n?void 0:n.uid,role:c}),m="free"===(0,e9.Ll)(a.plan),p=s?(0,rZ.q)(s):[],x=p.filter(e=>{var t;return null===(t=e.email)||void 0===t?void 0:t.toLowerCase().includes(r.toLowerCase())}),{inviteWorkspaceMember:h,isInvitingMember:g}=(0,rz.B)({workspaceId:a.id}),f=async e=>{let{emails:t,role:s}=e;if(0===t.length)return{success:!1};let a=0,n=m?"member":s;for(let e of t)await h({email:e,role:n}),a++;return{success:a>0}};return(0,i.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,i.jsx)(rD.s,{onInvite:e=>{let{emails:t,role:s}=e;return f({emails:t,role:s})},isInviting:g,roleOptions:rH,canSelectRoles:u.canSetInviteRole(),defaultRole:"member",placeholder:"Add emails",completelyDisabled:!u.canEmailInvite(),onInputChange:e=>l(e)}),(0,i.jsxs)("div",{className:"flex flex-col gap-2 border-b pb-3",children:[(0,i.jsx)("h4",{children:"Members"}),(0,i.jsx)("ul",{className:"flex flex-col gap-2",children:x.length>0?x.map((e,t)=>(0,i.jsx)(rB,{currentMembership:e,workspaceId:a.id,memberships:p,workspace:a},"".concat(e.user_id,"-").concat(t))):(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:r?"No users found for '".concat(r,"'"):"No members found"})})]}),u.canSeeUsage()&&p&&(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)("h4",{children:"Usage"}),(0,i.jsx)(rq,{workspace:a,memberships:p})]})]})},rY=e=>{let{workspace:t}=e;return(0,eJ.MD)()?(0,i.jsx)(r$,{workspace:t}):(0,i.jsx)(rX,{workspace:t})};function rX(e){let{workspace:t}=e,s=(0,u.aS)(e=>e.memberships),a=t.num_seats||20,n=s.length,r=t.name||"Workspace",l=(0,i.jsxs)(i.Fragment,{children:["Inviting people to ",(0,i.jsx)("strong",{children:r})," gives access to workspace shared projects and credits. You're using ",n,"/",a," seats. Need more?"," ",(0,i.jsx)(eO.default,{className:"underline",target:"_blank",href:"https://enterpriseform.lovable.app/",children:"Contact us"}),"."]});return(0,i.jsx)(p.tM,{title:"People",value:"people",description:l,docsLink:"https://docs.lovable.dev/user-guides/teams",children:(0,i.jsx)(rQ,{memberships:s,workspace:t})})}function r$(e){let{workspace:t}=e,s=(0,eJ.hO)(e=>e.memberships),a=t.num_seats||20,n=s.length,r=t.name||"Workspace",l=(0,i.jsxs)(i.Fragment,{children:["Inviting people to ",(0,i.jsxs)("strong",{children:[r,"'s workspace"]})," gives access to workspace shared projects and credits. You're using"," ",n,"/",a," seats. Need more?"," ",(0,i.jsx)(eO.default,{className:"underline",target:"_blank",href:"https://enterpriseform.lovable.app/",children:"Contact us"}),"."]});return(0,i.jsx)(p.tM,{title:"People",value:"people",description:l,children:(0,i.jsx)(rQ,{memberships:s,workspace:t})})}var r0=s(62395),r1=s(63210);let r2=e=>{let{workspace:t}=e,{data:s,isLoading:a}=(0,h.a)(ss.t.templates({workspaceId:t.id})),n=(0,e9.Qx)(t.plan)||(0,e9.gG)(t.plan),{openSettings:r}=(0,te.r)();return n?(0,i.jsx)(p.tM,{title:"Templates",value:"templates",description:"Browse and manage team templates, used to start new projects. Publish new templates from settings.",badge:"business",children:(0,i.jsxs)("div",{className:"grid flex-1 grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:[a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r0.R,{mainSkeletonClassName:"h-auto"}),(0,i.jsx)(r0.R,{mainSkeletonClassName:"h-auto"}),(0,i.jsx)(r0.R,{mainSkeletonClassName:"h-auto"}),(0,i.jsx)(r0.R,{mainSkeletonClassName:"h-auto"}),(0,i.jsx)(r0.R,{mainSkeletonClassName:"h-auto"}),(0,i.jsx)(r0.R,{mainSkeletonClassName:"h-auto"})]}),!a&&(s&&s.length>0?s.map(e=>(0,i.jsx)(r1.t,{project:e,subtitleType:"created-by",isCommunityProject:!1,positionIndex:0,isTemplate:!0},e.id)):(0,i.jsxs)("div",{className:"col-span-full flex h-full flex-col items-center justify-center gap-2 text-muted-foreground",children:[(0,i.jsx)(b.Z,{name:"file_export",size:"large"}),(0,i.jsx)("p",{className:"text-center text-sm",children:"No templates found. Mark projects as templates to get started."})]}))]})}):(0,i.jsx)(p.tM,{title:"Templates",value:"templates",description:"Browse and manage team templates, used to start new projects. Publish new templates from settings.",customBadge:t&&(0,i.jsx)(e7.y,{workspace:t,requiredPlanId:"biz"}),children:(0,i.jsxs)("div",{className:"flex h-full flex-col items-center justify-center gap-2 text-muted-foreground",children:[(0,i.jsx)(b.Z,{name:"file_export",size:"large"}),(0,i.jsx)("p",{className:"text-center text-sm",children:"To start using templates, upgrade to a Business or Enterprise plan."}),(0,i.jsx)(j.z,{onClick:()=>r("billing"),variant:"twilight",className:"mt-2",children:"Upgrade"})]})})};var r5=s(56141);let r4=()=>{var e;let{authUser:t}=(0,d.Eu)(),s=(0,er.iZ)(e=>e.project),{projectWorkspace:a,isMemberOfWorkspace:n,workspaceMemberships:r}=(0,tw.f)(),l=null===(e=r.find(e=>e.user_id===(null==t?void 0:t.uid)))||void 0===e?void 0:e.role;return(0,i.jsx)(r3,{project:s,workspace:null!=a?a:void 0,isMemberOfWorkspace:n,myWorkspaceRole:l})},r3=e=>{var t,s;let{project:a,workspace:n,myWorkspaceRole:r,isMemberOfWorkspace:l}=e,[u,x]=(0,o.useState)(!0),h=(0,o.useRef)(null),g=(0,tN.v)(),f=g?"admin":r,{activeTab:j,openSettings:v,closeSettings:y}=(0,te.r)();(0,o.useEffect)(()=>{null!==j?x(!0):x(!1)},[j]),(0,c.y1)("mod+.",()=>{null===j?v(a?"project":"account"):y()});let{authUser:w}=(0,d.Eu)(),N=(null==w?void 0:w.displayName)||"Your Account",_=g||l,k=g||"admin"===r||"owner"===r,S=null==n?void 0:n.name,C=(0,e9.Qx)(null==n?void 0:n.plan)||(0,e9.gG)(null==n?void 0:n.plan),E=(0,t_.Hj)(),A=(0,t_.wf)(),D=(0,m.dl)(eK.P.IntegrationConnection);return(0,i.jsx)(tv,{open:u,onOpenChange:e=>{e?v():y()},children:(0,i.jsxs)(p.v_,{value:j||"settings",onValueChange:e=>v(e,!0),children:[(0,i.jsxs)(p.eD,{hasActiveTab:!!j,children:[a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.yf,{title:"Project"}),(0,i.jsxs)(p.QK,{value:"project",children:[(0,i.jsx)(b.Z,{name:"settings"}),(0,i.jsx)("p",{children:"Project Settings"})]}),(0,i.jsxs)(p.QK,{value:"domains",children:[(0,i.jsx)(b.Z,{name:"language"}),(0,i.jsx)("p",{children:"Domains"})]}),(0,i.jsxs)(p.QK,{value:"analytics",children:[(0,i.jsx)(b.Z,{name:"bid_landscape"}),(0,i.jsx)("p",{children:"Analytics"})]}),(0,i.jsxs)(p.QK,{value:"knowledge",children:[(0,i.jsx)(b.Z,{name:"school"}),(0,i.jsx)("p",{children:"Knowledge"})]}),E&&(0,i.jsxs)(p.QK,{value:"memory",children:[(0,i.jsx)(b.Z,{name:"database"}),(0,i.jsx)("p",{children:"Memory"})]}),A&&(0,i.jsxs)(p.QK,{value:"ai_gateway",children:[(0,i.jsx)(b.Z,{name:"smart_toy"}),(0,i.jsx)("p",{children:"AI Gateway"})]}),(null==a?void 0:null===(t=a.enabled_integrations)||void 0===t?void 0:t.includes("supabase_exp"))&&(0,i.jsxs)(p.QK,{value:"supabase",onClick:()=>{h.current&&h.current()},children:[(0,i.jsx)(b.Z,{name:"database",className:"h-4 w-4"}),(0,i.jsx)("p",{children:"Backend"})]})]}),n&&_&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.yf,{title:"Workspace"}),(0,i.jsxs)(p.QK,{value:"workspace",className:"-ml-0.5",children:[(0,i.jsx)(tk.z,{className:(0,q.cn)("h-6 w-6 !rounded-[6px] md:h-5 md:w-5"),workspace:n}),(0,i.jsx)("p",{className:"-ml-0.5",children:S})]}),(0,i.jsxs)(p.QK,{value:"people",children:[(0,i.jsx)(b.Z,{name:"group"}),(0,i.jsx)("p",{children:"People"})]}),C&&(0,i.jsxs)(p.QK,{value:"templates",children:[(0,i.jsx)(b.Z,{name:"browse"}),(0,i.jsx)("p",{children:"Templates"})]}),(0,i.jsxs)(p.QK,{value:"billing",children:[(0,i.jsx)(b.Z,{name:"credit_card"}),(0,i.jsx)("p",{children:"Plans & Billing"})]}),!!(0,e9.Qx)(null==n?void 0:n.plan)&&k&&(0,i.jsxs)(p.QK,{value:"identity",children:[(0,i.jsx)(b.Z,{name:"security"}),(0,i.jsx)("p",{children:"Identity"})]})]}),(0,i.jsx)(p.yf,{title:"Account"}),(0,i.jsxs)(p.QK,{value:"account",children:[(0,i.jsx)(b.Z,{name:"account_circle"}),(0,i.jsx)("p",{children:N})]}),(0,i.jsxs)(p.QK,{value:"labs",children:[(0,i.jsx)(b.Z,{name:"science"}),(0,i.jsx)("p",{children:"Labs"})]}),_&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.yf,{title:"Integrations"}),!(null==a?void 0:null===(s=a.enabled_integrations)||void 0===s?void 0:s.includes("supabase_exp"))&&(0,i.jsxs)(p.QK,{value:"supabase",children:[(0,i.jsx)(tS.xR.Supabase,{className:"h-4 w-4"}),(0,i.jsx)("p",{children:"Supabase"})]}),(a||n)&&(0,i.jsxs)(p.QK,{value:"github",children:[(0,i.jsx)(tS.xR.GitHub,{className:"h-4 w-4"}),(0,i.jsx)("p",{children:"GitHub"})]}),D&&n&&(0,i.jsxs)(p.QK,{value:"mcp",children:[(0,i.jsx)(b.Z,{name:"cloud"}),(0,i.jsx)("p",{children:"MCP"})]})]})]}),(0,i.jsxs)("div",{className:(0,q.cn)("relative h-full w-full flex-1 overflow-x-auto scrollbar-thin scrollbar-track-transparent scrollbar-thumb-muted-foreground md:w-auto",j?"flex":"hidden md:flex"),children:[a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.tM,{value:"project",title:"Project Settings",description:"Manage your project details, visibility, and preferences.",children:(0,i.jsx)(to,{projectId:a.id})}),(0,i.jsx)(p.tM,{value:"knowledge",title:"Knowledge",description:"Add custom knowledge to your project.",docsLink:"https://docs.lovable.dev/features/knowledge",children:(0,i.jsx)(eQ,{})}),(0,i.jsx)(p.tM,{value:"domains",title:"Domains",description:"Publish your project to custom domains.",docsLink:"https://docs.lovable.dev/tips-tricks/custom-domain",children:(0,i.jsx)(eV,{project:a})}),"analytics"===j&&(0,i.jsx)(eA,{project:a}),E&&(0,i.jsx)(sJ,{workspace:n,isInsideEditor:!!a,myWorkspaceRole:f,project:a}),A&&(0,i.jsx)(ee,{project:a})]}),n&&l&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r5.r,{workspace:n}),(0,i.jsx)(rY,{workspace:n}),(0,i.jsx)(rh,{workspace:n,myWorkspaceRole:r}),C&&(0,i.jsx)(r2,{workspace:n}),!!(0,e9.Qx)(null==n?void 0:n.plan)&&k&&(0,i.jsx)(rA,{workspace:n})]}),(0,i.jsx)(t9,{}),(0,i.jsx)(tI,{}),_&&n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(sF,{workspace:n,isInsideEditor:!!a,myWorkspaceRole:f}),(0,i.jsx)(nE,{workspace:n,isInsideEditor:!!a,project:a,myWorkspaceRole:f,resetCallbackRef:h}),D&&(0,i.jsx)(sW,{workspace:n,isInsideEditor:!!a,myWorkspaceRole:f})]})]})]})})};var r6=()=>{var e;let{authUser:t}=(0,d.Eu)(),s=(0,eJ.MD)(),a=(0,u.aS)(e=>e.currentWorkspace),n=(0,u.aS)(e=>e.memberships),r=n.some(e=>e.user_id===(null==t?void 0:t.uid));if(s)return(0,i.jsx)(r4,{});let l=null===(e=n.find(e=>e.user_id===(null==t?void 0:t.uid)))||void 0===e?void 0:e.role;return(0,i.jsx)(r3,{workspace:null!=a?a:void 0,isMemberOfWorkspace:r,myWorkspaceRole:l})}},19878:function(e,t,s){s.d(t,{B:function(){return d}});var a=s(29827),n=s(21770),r=s(52558),l=s(64040),i=s(49131),o=s(89668),c=s(40782);function d(e){let{workspaceId:t}=e,s=(0,a.NL)(),{authUser:d}=(0,r.Eu)(),{mutateAsync:u,isPending:m}=(0,n.D)({mutationFn:async e=>{let{email:s,role:a="member"}=e;return(0,i.SJ)().post("/workspaces/".concat(t,"/memberships"),{email:s,role:a})},onSuccess:async e=>{if(e){let a=o.t.workspaceMemberships({workspaceId:t,userId:null==d?void 0:d.uid}),n=s.getQueryData(a.queryKey);n&&!n.memberships.some(t=>t.user_id===e.user_id)&&s.setQueryData(a.queryKey,{...n,memberships:(0,c.q)([...n.memberships,e])})}s.invalidateQueries({queryKey:o.t.workspaceMemberships({workspaceId:t,userId:null==d?void 0:d.uid}).queryKey})},onError:e=>{(0,l.Eo)(e)}});return{inviteWorkspaceMember:u,isInvitingMember:m}}},40782:function(e,t,s){s.d(t,{q:function(){return n}});let a={owner:3,admin:2,member:1};function n(e){return[...e].sort((e,t)=>{let s=!!e.joined_at,n=!!t.joined_at;if(s&&!n)return -1;if(!s&&n)return 1;let r=a[t.role]-a[e.role];return 0!==r?r:e.joined_at&&t.joined_at?new Date(t.joined_at).getTime()-new Date(e.joined_at).getTime():0})}},56141:function(e,t,s){s.d(t,{r:function(){return F},Y:function(){return Z}});var a=s(57437),n=s(13590),r=s(92850),l=s(29827),i=s(21770),o=s(29501),c=s(14438),d=s(91351),u=s(52558),m=s(6812),p=s(69084),x=s(32165),h=s(66870),g=s(62869),f=s(78276),j=s(26110),v=s(15681),b=s(95186),y=s(1828),w=s(76818),N=s(64040),_=s(49131),k=s(89668),S=s(46170),C=s(99376),E=s(61922),A=s(2265),D=s(57346),z=s(26034),I=s(97318),O=s(94508),P=s(94949);let T=["image/png","image/jpeg","image/jpg","image/webp"],L=e=>{let{workspace:t,className:s}=e,{authUser:n}=(0,u.Eu)(),r=(0,_.SJ)(),{upload:o}=(0,P.F)(),d=(0,l.NL)(),m=(0,A.useRef)(null),p=()=>{m.current&&(m.current.value="")},{mutateAsync:x,isPending:h}=(0,i.D)({mutationFn:async e=>{let{file:s,workspaceId:a}=e;if(!n)throw Error("You must be logged in to upload files");await o({fileName:s.name,file:s,options:{maxFileSize:10240,maxDimension:200},continueOnError:!1});let{url:l}=await (0,z._c)({dir_name:n.uid,file_name:s.name});return await r.put("/user/workspaces/".concat(t.id),{image_url:l})},onSuccess:(e,t)=>{c.Am.success("Updated workspace avatar",{description:"Succesfully uploaded new workspace avatar"}),d.invalidateQueries({queryKey:I.E.all}),p()},onError:()=>{c.Am.error("Failed to update workspace avatar",{description:"Please try again"}),p()}}),f=async e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];a&&await x({file:a,workspaceId:t.id})};return(0,a.jsxs)(g.z,{variant:"secondary",size:"icon-sm",className:(0,O.cn)("absolute -bottom-1 -right-2 h-5 w-5 rounded-sm border disabled:opacity-100",s),type:"button",disabled:h,onClick:()=>{var e;null===(e=m.current)||void 0===e||e.click()},children:[(0,a.jsx)("input",{type:"file",className:"hidden",accept:T.join(","),onChange:f,disabled:h,ref:m}),(0,a.jsx)(D.Z,{name:h?"progress_activity":"edit_square",size:"xsmall",className:h?"animate-spin":""})]})},R=d.Ry({name:d.Z_().min(1,"Workspace name is required"),description:d.Z_().optional(),dataOptOut:d.O7().optional()}),F=e=>{var t,s,l,c;let{workspace:d}=e,m=(0,o.cI)({defaultValues:{name:null!==(s=d.name)&&void 0!==s?s:"",description:null!==(l=d.description)&&void 0!==l?l:"",dataOptOut:null!==(c=d.data_opt_out)&&void 0!==c?c:void 0},resolver:(0,n.F)(R)}),{authUser:N}=(0,u.Eu)(),{data:A}=(0,r.a)(k.t.workspaceMemberships({userId:null==N?void 0:N.uid,workspaceId:d.id})),D=null==A?void 0:null===(t=A.memberships.find(e=>e.user_id===(null==N?void 0:N.uid)))||void 0===t?void 0:t.role,z="owner"===D,I="member"===D,{leaveWorkspace:O,isLeavingWorkspace:P}=function(){let{setCurrentWorkspaceId:e}=(0,E.J1)(),t=(0,C.useRouter)(),{mutateAsync:s,isPending:a}=(0,i.D)({mutationFn:async e=>(0,_.SJ)().post("/user/workspaces/".concat(e,"/leave")),onSuccess:async()=>{e(null),t.push("/")}});return{leaveWorkspace:s,isLeavingWorkspace:a}}(),{updateWorkspace:T,isUpdatingWorkspace:F}=Z({form:m,workspaceId:d.id}),M=(0,S.Qx)(d.plan);return(0,a.jsx)(h.tM,{title:"Workspace Settings",value:"workspace",description:"Workspaces allow you to collaborate on projects in real time.",docsLink:"https://docs.lovable.dev/user-guides/teams",children:(0,a.jsx)(v.l0,{...m,children:(0,a.jsxs)("form",{className:"flex w-full flex-col gap-6",onSubmit:m.handleSubmit(e=>{T(e)}),children:[(0,a.jsx)(x.P,{label:"Workspace Avatar",description:"Set an avatar for your workspace.",mobileLayout:"horizontal",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(p.z,{className:"h-10 w-10",workspace:d}),("admin"===D||z)&&(0,a.jsx)(L,{workspace:d})]})}),(0,a.jsx)(x.P,{label:"Workspace Name",description:"Your full workspace name, as visible to others.",children:(0,a.jsx)(v.Wi,{control:m.control,name:"name",render:e=>{let{field:t}=e;return(0,a.jsxs)(v.xJ,{className:"w-full",children:[(0,a.jsx)(v.NI,{children:(0,a.jsx)(f.b,{showTooltip:I,tooltipContent:"You need to be a workspace admin to modify this field",children:(0,a.jsx)(b.I,{...t,placeholder:"Enter workspace name",disabled:I})})}),(0,a.jsx)(v.zG,{})]})}})}),(0,a.jsx)(x.P,{label:"Workspace Description",description:"A short description about your workspace or team.",children:(0,a.jsx)(v.Wi,{control:m.control,name:"description",render:e=>{let{field:t}=e;return(0,a.jsxs)(v.xJ,{className:"w-full",children:[(0,a.jsx)(v.NI,{children:(0,a.jsx)(f.b,{showTooltip:I,tooltipContent:"You need to be a workspace admin to modify this field",children:(0,a.jsx)(w.g,{rows:3,className:"border bg-background",placeholder:"Description",disabled:I,...t})})}),(0,a.jsx)(v.zG,{})]})}})}),!!M&&(0,a.jsx)(x.P,{label:"Data Collection Opt Out",description:"Opt out of data collection for this workspace.",isLast:z,children:(0,a.jsx)(v.Wi,{control:m.control,name:"dataOptOut",render:e=>{var t;let{field:s}=e;return(0,a.jsx)(v.xJ,{className:"w-full",children:(0,a.jsx)(v.NI,{children:(0,a.jsx)(y.r,{disabled:!z,checked:null!==(t=s.value)&&void 0!==t&&t,onCheckedChange:s.onChange})})})}})}),!z&&(0,a.jsx)(x.P,{label:"Leave Workspace",description:"Leave the workspace (you will lose all access to projects inside this workspace).",isLast:!0,children:(0,a.jsx)("div",{className:"flex items-center justify-end gap-2",children:(0,a.jsxs)(j.Vq,{children:[(0,a.jsx)(j.hg,{asChild:!0,children:(0,a.jsx)(g.z,{variant:"destructive",type:"button",loading:P,children:"Leave Workspace"})}),(0,a.jsxs)(j.cZ,{size:"sm",children:[(0,a.jsxs)(j.fK,{children:[(0,a.jsx)(j.$N,{children:"Leave Workspace"}),(0,a.jsx)(j.Be,{children:"Are you sure you want to leave this workspace?"})]}),(0,a.jsxs)(j.cN,{children:[(0,a.jsx)(j.GG,{asChild:!0,children:(0,a.jsx)(g.z,{variant:"outline",children:"Cancel"})}),(0,a.jsx)(g.z,{variant:"destructive",type:"button",loading:P,onClick:()=>O(d.id),children:"Leave Workspace"})]})]})]})})}),m.formState.isDirty&&(0,a.jsx)(x.j,{children:(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,a.jsx)(g.z,{variant:"secondary",type:"button",onClick:()=>{m.reset()},children:"Cancel"}),(0,a.jsx)(g.z,{variant:"affirmative",type:"submit",loading:F,children:"Update"})]})})]})})})};function Z(e){let{form:t,workspaceId:s}=e,a=(0,l.NL)(),{authUser:n}=(0,u.Eu)(),{store:r}=(0,m.bm)(),{mutate:o,isPending:d}=(0,i.D)({mutationFn:async e=>{var t;return(0,_.SJ)().put("/user/workspaces/".concat(s),{name:e.name,description:null!==(t=e.description)&&void 0!==t?t:"",...void 0!==e.dataOptOut&&{data_opt_out:e.dataOptOut}})},onSuccess:e=>{var l,i,o,d;c.Am.success("Success",{description:"Workspace settings updated successfully"});let u=k.t.detail({workspaceId:s}).queryKey;a.setQueryData(u,t=>t?{...t,workspace:e}:{workspace:e,projects:[]});let m=k.t.workspaces({userId:null==n?void 0:n.uid}).queryKey;a.setQueryData(m,t=>t?{workspaces:t.workspaces.map(t=>t.id===e.id?e:t)}:{workspaces:[e]});let p=(null!==(l=null==r?void 0:r.getState().workspaces)&&void 0!==l?l:[]).map(t=>t.id===e.id?e:t);null==r||r.setState({workspaces:p}),t.reset({name:null!==(i=e.name)&&void 0!==i?i:"",description:null!==(o=e.description)&&void 0!==o?o:"",dataOptOut:null!==(d=e.data_opt_out)&&void 0!==d?d:void 0})},onError:e=>{(0,N.Eo)(e)}});return{updateWorkspace:o,isUpdatingWorkspace:d}}},74751:function(e,t,s){s.d(t,{p:function(){return i}});var a=s(57437),n=s(35974),r=s(94508);let l={pro:"brand-twilight",business:"brand-twilight",admin:"brand-saffron",labs:"brand-twilight",internal:"secondary"},i=e=>{let{badge:t,className:s}=e;return(0,a.jsx)(n.C,{variant:l[t],className:(0,r.cn)("capitalize",s),children:t})}},32165:function(e,t,s){s.d(t,{P:function(){return l},j:function(){return i}});var a=s(57437),n=s(94508),r=s(74751);let l=e=>{let{children:t,label:s,className:l,isLast:i=!1,description:o,badges:c,customBadge:d,mobileLayout:u="vertical",justify:m="start",...p}=e;return(0,a.jsxs)("div",{className:(0,n.cn)("relative grid gap-4 pb-4 last:border-b-0 md:grid md:grid-cols-2",{"border-b-0":i,"border-b":!i,"flex justify-between":"horizontal"===u,"grid-cols-1":"vertical"===u},l),...p,children:[(s||o)&&(0,a.jsxs)("div",{className:"flex-col gap-1 md:flex",children:[(0,a.jsxs)("p",{className:"flex flex-wrap items-center gap-x-1.5 text-base font-medium",children:[s,null==c?void 0:c.map(e=>(0,a.jsx)(r.p,{badge:e},e)),d]}),o&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:o})]}),t&&(0,a.jsx)("div",{className:(0,n.cn)("flex items-center","end"===m&&"md:justify-end"),children:t})]})},i=e=>{let{children:t,className:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)("absolute inset-x-0 bottom-0 z-10 flex min-h-8 items-center rounded-b-lg border-t bg-background px-6 py-3 md:px-10",s),...r,children:t})}},66870:function(e,t,s){s.d(t,{QK:function(){return m},eD:function(){return u},tM:function(){return p},v_:function(){return d},yf:function(){return x}});var a=s(57437),n=s(20271),r=s(55157),l=s(57346),i=s(27132),o=s(94508),c=s(74751);let d=e=>{let{children:t,className:s,...r}=e;return(0,a.jsx)(n.mQ,{className:(0,o.cn)("mt-0 flex w-full flex-1 flex-col items-start overflow-hidden md:flex-row",s),orientation:"vertical",...r,children:t})},u=e=>{let{children:t,className:s,hasActiveTab:r,...l}=e;return(0,a.jsxs)(n.dr,{className:(0,o.cn)("mt-[22px] flex h-full w-full flex-col gap-0.5 overflow-y-auto px-4 py-6 md:mt-0 md:w-[240px] md:flex-nowrap md:border-r",s,r?"hidden md:flex":"flex"),...l,children:[(0,a.jsx)(h,{hideBackButton:!0,className:"mt-[22px]",children:"Settings"}),t]})},m=e=>{let{children:t,className:s,...r}=e;return(0,a.jsx)(n.SP,{className:(0,o.cn)("flex min-h-10 w-full items-center justify-start gap-3 rounded-md px-2.5 py-2 text-start text-base data-[state=active]:bg-muted hover:bg-muted-hover md:min-h-8 md:w-auto md:gap-2 md:text-sm [&>svg]:size-5 md:[&>svg]:size-4",s),...r,children:t})},p=e=>{let{children:t,className:s,title:r,description:i,docsLink:d,descriptionAction:u,badge:m,customBadge:p,...x}=e;return(0,a.jsxs)(n.nU,{className:(0,o.cn)("flex max-h-full w-full flex-1 flex-col gap-6 overflow-y-auto px-6 pb-6 pt-20 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-muted-foreground data-[state=inactive]:hidden focus:outline-none md:px-10 md:pt-6",s),...x,children:[r&&(0,a.jsxs)("div",{className:"hidden w-full flex-col gap-2 border-b pb-3 md:flex",children:[(0,a.jsxs)("h4",{className:"flex items-center gap-2 text-lg font-medium",children:[(0,a.jsx)("span",{children:r}),m&&(0,a.jsx)(c.p,{badge:m}),p]}),i&&(0,a.jsxs)("p",{className:(0,o.cn)("flex items-start justify-between gap-2 text-sm text-muted-foreground"),children:[(0,a.jsx)("div",{className:"",children:i}),d&&(0,a.jsxs)("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-muted-foreground duration-150 ease-in-out hover:text-muted-foreground/80",children:[(0,a.jsx)(l.Z,{name:"help",size:"small"}),"Docs"]}),u&&u]})]}),(0,a.jsx)(h,{descriptionAction:u,children:r}),t]})},x=e=>{let{title:t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("mb-1 mt-6 px-3 text-sm font-medium text-muted-foreground first:mt-0 md:text-xs"),children:t})},h=e=>{let{children:t,className:s,hideBackButton:n=!1,descriptionAction:c,...d}=e,{openSettings:u}=(0,r.r)();return(0,i.Z)("md")?(0,a.jsxs)("div",{className:(0,o.cn)("absolute inset-x-0 top-0 z-20 flex min-h-8 items-center justify-between border-b bg-background px-2 py-3 md:hidden",s),...d,children:[(0,a.jsx)("div",{className:"flex items-baseline",children:!n&&(0,a.jsxs)("button",{className:(0,o.cn)("flex items-center gap-1 text-base md:text-sm"),onClick:()=>u(),children:[(0,a.jsx)(l.Z,{name:"chevron_left",size:"default"})," Settings"]})}),(0,a.jsx)("div",{className:"absolute left-1/2 flex -translate-x-1/2 items-baseline justify-center text-center text-lg font-medium",children:t}),(0,a.jsx)("div",{className:"flex min-h-7 items-baseline pr-0.5",children:c})]}):null}},56922:function(e,t,s){s.d(t,{D:function(){return i},e:function(){return l}});var a=s(57437),n=s(2265);let r=(0,n.createContext)({setSelectedProject:()=>{},setOpen:()=>{}}),l=()=>{let e=(0,n.useContext)(r);if(!e)throw Error("useSupabaseConnectMenuContext must be used within a SupabaseConnectMenuContext");return e},i=e=>{let{children:t,setSelectedProject:s,setOpen:n}=e;return(0,a.jsx)(r.Provider,{value:{setSelectedProject:s,setOpen:n},children:t})}},22876:function(e,t,s){s.d(t,{K:function(){return m}});var a=s(57437),n=s(27648),r=s(2265),l=s(23518),i=s(78276),o=s(55721),c=s(57346),d=s(56922),u=s(27559);let m=e=>{var t;let{organization:s}=e;return(0,a.jsxs)(o.Ph,{children:[(0,a.jsx)(o.kt,{className:"text-sm",children:(0,a.jsx)("span",{className:"truncate",children:s.name})}),(0,a.jsxs)(o.TG,{className:"w-56 p-0",children:[(0,a.jsxs)(l.mY,{children:[(0,a.jsx)(l.sZ,{placeholder:"Search projects...",autoFocus:!0}),(0,a.jsxs)(l.e8,{className:"max-h-60 scrollbar-thin scrollbar-thumb-muted-foreground/20",children:[(0,a.jsx)(l.rb,{children:"No projects found."}),(0,a.jsx)(l.fu,{children:null===(t=s.projects)||void 0===t?void 0:t.map(e=>(0,a.jsx)(p,{project:e},e.id))})]})]}),(0,a.jsx)(o.VD,{className:"mt-0"}),(0,a.jsx)("div",{className:"px-1 pb-1",children:(0,a.jsx)(o.Xi,{asChild:!0,children:(0,a.jsxs)(n.default,{href:"https://supabase.com/dashboard/new/".concat(s.id),target:"_blank",rel:"noopener noreferrer",className:"flex w-full items-center gap-2",children:[(0,a.jsx)(c.Z,{name:"add",size:"small"}),"Create project",(0,a.jsx)(c.Z,{name:"arrow_outward",size:"small",className:"ml-auto"})]})})})]})]},s.id)},p=e=>{let{project:t}=e,s=(0,u.u)(t),{setSelectedProject:n,setOpen:o}=(0,d.e)(),m=(0,r.useCallback)(()=>{n(t),o(!1)},[t,n,o]);return(0,a.jsx)(i.b,{showTooltip:!s,side:"left",tooltipContent:"Check project status in Supabase.",children:(0,a.jsxs)(l.di,{onSelect:m,disabled:!s,className:"group flex w-full items-center",value:t.name,children:[(0,a.jsx)("span",{className:"truncate",children:t.name}),!s&&(0,a.jsx)(c.Z,{name:"warning_fill",size:"small",className:"ml-auto text-destructive-primary"})]},t.id)})}},27559:function(e,t,s){s.d(t,{u:function(){return n}});var a=s(22853);let n=e=>e.status===a.k.ACTIVE_HEALTHY},30811:function(e,t,s){s.d(t,{B:function(){return m}});var a=s(57437),n=s(35974),r=s(94508),l=s(54616),i=s(78276),o=s(57346);let c=/[,;\n\t]+/g,d=/\s+/g,u=e=>e.replace(c," ").replace(d," ").trim().split(" ").map(e=>e.trim()).filter(e=>""!==e),m=e=>{let{tags:t,setTags:s,inputValue:c,setInputValue:d,placeholder:m="Type and press Enter...",className:p="",...x}=e,h=e=>{t.includes(e)||""===e.trim()||s([...t,e]),d("")},g=e=>{s(t.filter((t,s)=>s!==e))};return(0,a.jsxs)("div",{className:(0,r.cn)("flex min-h-9 w-full min-w-0 flex-wrap items-center gap-1.5 overflow-hidden rounded-md border border-input bg-transparent p-2 py-1.5 text-sm shadow-sm transition-colors focus-within:ring-1 focus-within:ring-ring",p),children:[t.map((e,t)=>{let s=(0,l.Jh)(e);return(0,a.jsx)(i.b,{showTooltip:!s,tooltipContent:"This is not a valid email.",instant:!0,className:"min-w-0",children:(0,a.jsxs)(n.C,{variant:"secondary",className:"flex min-w-0 cursor-default items-center gap-1 rounded-sm px-1 py-0 text-xs font-medium",children:[!s&&(0,a.jsx)(o.Z,{name:"warning_fill",className:"text-destructive-primary",size:"small"}),(0,a.jsx)("span",{className:"min-w-0 max-w-[160px] overflow-hidden truncate md:whitespace-nowrap",children:e}),(0,a.jsx)("button",{type:"button",className:"flex-shrink-0 rounded-sm duration-100 ease-out hover:bg-muted-hover",onClick:()=>g(t),children:(0,a.jsx)(o.Z,{name:"close_small"})})]})},t)}),(0,a.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"!==e.key&&","!==e.key&&" "!==e.key||e.metaKey||""===c.trim()?"Backspace"===e.key&&""===c&&t.length>0&&g(t.length-1):(e.preventDefault(),h(c.trim()))},onPaste:e=>{e.preventDefault();let a=u(e.clipboardData.getData("text")),n=new Set(t),r=[...t];a.forEach(e=>{let t=""!==e.trim();!n.has(e)&&t&&(r.push(e),n.add(e))}),s(r)},placeholder:m,className:"min-w-[80px] flex-1 bg-transparent text-sm outline-none placeholder:text-muted-foreground",...x})]})};m.displayName="TagsInput"},99153:function(e,t,s){s.d(t,{O:function(){return o}});var a=s(57437),n=s(78298),r=s(55721),l=s(57346),i=s(27132);let o=()=>{let e=(0,i.Z)("md"),{theme:t,setTheme:s}=(0,n.F)();return e?null:(0,a.jsxs)(r.Ph,{children:[(0,a.jsxs)(r.kt,{children:[(0,a.jsx)(l.Z,{name:"contrast"}),(0,a.jsx)("p",{children:"Appearance"})]}),(0,a.jsx)(r.cq,{children:(0,a.jsx)(r.TG,{children:(0,a.jsxs)(r._x,{value:t,onValueChange:e=>{("light"===e||"dark"===e||"system"===e)&&s(e)},children:[(0,a.jsx)(r.qB,{value:"light",children:"Light"}),(0,a.jsx)(r.qB,{value:"dark",children:"Dark"}),(0,a.jsx)(r.qB,{value:"system",children:"System theme"})]})})})]})}},56272:function(e,t,s){s.d(t,{y:function(){return o}});var a=s(57437);s(2265);var n=s(94508),r=s(46170),l=s(57346),i=s(81103);let o=e=>{let{workspace:t,requiredPlanId:s,className:o,...c}=e,d=(0,r.Cc)(s),u=(0,r.Ll)(t.plan),m=(0,r.Cc)(u),p="legacy"===u,x=(0,r.ZN)(t.plan),h=!(0,r.Aj)(u,s);return(0,a.jsxs)(i.u,{children:[(0,a.jsx)(i.aJ,{asChild:!0,children:(0,a.jsxs)("div",{className:(0,n.cn)("flex h-5 cursor-pointer items-center gap-1 rounded-sm bg-brand-twilight px-2 py-px text-xs font-medium text-brand-twilight-foreground hover:bg-brand-twilight/80",o),...c,children:[(0,a.jsx)(l.Z,{name:"lovable_icon",size:"xsmall"}),(0,a.jsx)("p",{className:(0,n.cn)("flex",{hidden:!h}),children:d})]})}),(0,a.jsx)(i._v,{children:h?(0,a.jsxs)("p",{children:["Upgrade to ",d," to access this feature."]}):(0,a.jsx)("p",{children:p?"Included in ".concat(x):"Included in ".concat(m)})})]})}},32129:function(e,t,s){var a=s(57437),n=s(61994),r=s(27648),l=s(99376);s(2265);var i=s(30438),o=s(46170),c=s(62869),d=s(57346);t.Z=e=>{let{plan:t,withWrapper:s=!1,className:u,...m}=e,p=(0,l.usePathname)(),x=(0,i.c)();return(0,o.XB)(t)||!x?null:s?(0,a.jsxs)("div",{className:"flex w-full items-center justify-between rounded-md bg-muted px-3 py-2 text-foreground",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1 text-sm",children:[(0,a.jsx)(d.Z,{name:"crown",size:"small"}),"Turn Pro"]}),(0,a.jsx)(c.z,{size:"sm",className:(0,n.Z)("bg-brand-twilight text-brand-twilight-foreground hover:bg-brand-twilight/80",u),asChild:!0,...m,children:(0,a.jsx)(r.default,{href:"".concat(p,"?settings=billing"),children:"Upgrade"})})]}):(0,a.jsx)(c.z,{size:"sm",className:(0,n.Z)("bg-brand-twilight text-brand-twilight-foreground hover:bg-brand-twilight/80",u),asChild:!0,...m,children:(0,a.jsxs)(r.default,{href:"".concat(p,"?settings=billing"),children:[(0,a.jsx)(d.Z,{name:"crown",size:"small"}),"Upgrade"]})})}},2124:function(e,t,s){s.d(t,{F:function(){return p}});var a=s(57437),n=s(38706),r=s(76678),l=s(60256),i=s(88391),o=s(94508),c=s(55157),d=s(26815),u=s(74991),m=s(56272);let p=e=>{let{visibility:t,setVisibility:s,onClick:p,disabled:x,className:h,customPrivateDescription:g,customPublicDescription:f,redirectToSubscription:j=!1,workspacePlan:v,workspace:b}=e,y=(0,n.T_)("VisibilitySelection"),w=(0,l.dF)({workspacePlan:v}),N=(0,l.DM)({workspacePlan:v}),_=(0,i.z)(r.g),{openSettings:k}=(0,c.r)();return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(u.E,{className:h,disabled:x,defaultValue:"public",value:t,onValueChange:e=>{s(e)},children:[(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(u.m,{value:"public",id:"public",onClick:()=>{null==p||p()}}),(0,a.jsxs)(d.Label,{htmlFor:"public",className:(0,o.cn)("flex w-full cursor-pointer flex-col gap-0.5"),children:[(0,a.jsx)("div",{className:"flex items-center gap-1 text-sm font-medium leading-tight",children:y("public.title")}),f||(0,a.jsx)("span",{className:"font-normal leading-normal text-muted-foreground",children:y("public.description")})]})]}),(0,a.jsxs)("div",{className:"flex w-full items-start gap-2",children:[(0,a.jsx)(u.m,{value:"private",id:"private",onClick:e=>{w?null==p||p():(e.preventDefault(),j?k("billing"):_({childProps:{dialogDescription:y("upgradeMessages.proRequired")}}))}}),(0,a.jsxs)(d.Label,{htmlFor:"private",className:"flex w-full cursor-pointer flex-col gap-0.5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm font-medium leading-tight",children:[y("workspace.title"),b&&(0,a.jsx)(m.y,{workspace:b,requiredPlanId:"pro"})]}),g||(0,a.jsx)("span",{className:"font-normal leading-normal text-muted-foreground",children:y("workspace.description")})]})]}),(0,a.jsxs)("div",{className:"flex w-full items-start gap-2",children:[(0,a.jsx)(u.m,{value:"draft",id:"draft",onClick:e=>{N?null==p||p():(e.preventDefault(),j?k("billing"):_({childProps:{dialogDescription:y("upgradeMessages.businessRequired")}}))}}),(0,a.jsxs)(d.Label,{htmlFor:"draft",className:"flex w-full cursor-pointer flex-col gap-0.5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm font-medium leading-tight",children:[y("draft.title"),b&&(0,a.jsx)(m.y,{workspace:b,requiredPlanId:"biz"})]}),g||(0,a.jsx)("p",{className:"flex items-center gap-1",children:(0,a.jsx)("span",{className:"font-normal leading-normal text-muted-foreground",children:y("draft.description")})})]})]})]})})}},35194:function(e,t,s){s.d(t,{CreateWorkspaceDialog:function(){return S}});var a=s(57437),n=s(2265),r=s(14438),l=s(6812),i=s(62869),o=s(95186),c=s(26815),d=s(65269),u=s(3813),m=s(94508),p=s(77755),x=s(67118),h=s(48581),g=s(29827),f=s(21770),j=s(52558),v=s(61922),b=s(108),y=s(64040),w=s(49131),N=s(89668);let _=e=>{let{closeDialog:t}=e,s=(0,g.NL)(),{setCurrentWorkspaceId:a}=(0,v.J1)(),{store:n}=(0,l.bm)(),{authUser:i}=(0,j.Eu)(),{toCheckout:o}=(0,b.m)(),{mutate:c,isPending:d}=(0,f.D)({mutationFn:async e=>{let{name:t}=e;return(0,w.SJ)().post("/user/workspaces",{name:t})},onSuccess:async(e,l)=>{var c;let{plan:d,planType:u}=l,m=N.t.workspaces({userId:null==i?void 0:i.uid}).queryKey;s.setQueryData(m,t=>({workspaces:[...(null==t?void 0:t.workspaces)||[],e]}));let p=N.t.detail({workspaceId:e.id}).queryKey;s.setQueryData(p,{workspace:e,projects:[]}),null==n||n.setState({workspaces:[...null!==(c=null==n?void 0:n.getState().workspaces)&&void 0!==c?c:[],e]}),a(e.id);try{if(!e.id)throw Error("Workspace ID is required");await o({plan:d,workspaceId:e.id,changeType:"upgrade",planType:u}),r.Am.success("Workspace created successfully",{description:e.name})}finally{t()}},onSettled:e=>{e&&(s.invalidateQueries({queryKey:N.t.workspaces({userId:null==i?void 0:i.uid}).queryKey}),s.invalidateQueries({queryKey:N.t.detail({workspaceId:e.id}).queryKey}))},onError:e=>{(0,y.Eo)(e)}});return{createWorkspace:c,isCreatingWorkspace:d}},k={name:{title:"Create a Workspace",description:"Create a new place to make projects or collaborate with others."},plan:{title:"Select a Plan",description:"Select a plan for your new workspace."}},S=()=>{let e=(0,l.Q)(e=>e.showCreateWorkspaceDialog),t=(0,l.Q)(e=>e.setShowCreateWorkspaceDialog);(0,u.Kq)();let[s,r]=(0,n.useState)("name"),{title:i,description:o}=k[s];return(0,a.jsx)(d.v,{title:i,description:o,open:e,onOpenChange:e=>{e||r("name"),t(e)},className:"plan"===s?"max-w-[600px] md:px-6":"",children:(0,a.jsx)(p.om,{planCardContext:"newWorkspace",children:(0,a.jsx)(C,{closeDialog:()=>{r("name"),t(!1)},step:s,setStep:r})})})},C=e=>{let{closeDialog:t,step:s,setStep:l}=e,[i,o]=(0,n.useState)(""),{createWorkspace:c,isCreatingWorkspace:d}=_({closeDialog:t}),u=(0,h.tS)();return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)(E,{step:s,workspaceName:i,setWorkspaceName:o,closeDialog:t,setStep:l}),(0,a.jsx)(A,{step:s,handleSubmit:()=>{if("name"===s){if(""===i){r.Am.error("Workspace name is required");return}l("plan");return}null!==u.newWorkspaceSelectedPlan&&c({name:i,plan:u.newWorkspaceSelectedPlan,planType:u.planType})},setStep:l,workspaceName:i,isCreatingWorkspace:d})]})},E=e=>{let{step:t,workspaceName:s,setWorkspaceName:n,closeDialog:r,setStep:l}=e;return(0,a.jsxs)("div",{className:(0,m.cn)("hidden flex-col gap-4","name"===t&&"flex"),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2 px-1",children:[(0,a.jsx)(c.Label,{children:"Workspace Name"}),(0,a.jsx)(o.I,{id:"workspaceName",value:s,onChange:e=>n(e.target.value),placeholder:"Enter workspace name",required:!0})]}),(0,a.jsxs)("div",{className:"mt-2 flex w-full gap-6 px-1 pb-1",children:[(0,a.jsx)(i.z,{type:"button",className:"flex-1",variant:"secondary",onClick:r,children:"Go Back"}),(0,a.jsx)(i.z,{className:"flex-1",disabled:!s,type:"button",onClick:()=>l("plan"),children:"Continue to Plan"})]})]})},A=e=>{let{step:t,setStep:s,workspaceName:n,isCreatingWorkspace:r,handleSubmit:l}=e,o=(0,u.Kq)();return(0,a.jsxs)("div",{className:(0,m.cn)("hidden flex-col gap-4","plan"===t&&"flex"),children:[(0,a.jsxs)("div",{className:(0,m.cn)("grid grid-cols-1 gap-4",2==(o?2:1)?"md:grid-cols-2":"md:grid-cols-2 lg:grid-cols-3"),children:[(0,a.jsx)(x.h.Pro,{}),(0,a.jsx)(x.h.Biz,{})]}),(0,a.jsxs)("div",{className:"sticky bottom-0 mt-2 flex w-full gap-6 border-t bg-background px-1 py-3",children:[(0,a.jsx)(i.z,{type:"button",className:"flex-1",variant:"secondary",onClick:()=>s("name"),children:"Go Back"}),(0,a.jsx)(i.z,{className:"flex-1",onClick:l,disabled:!n||r,loading:r,children:r?"Creating...":"Create Workspace"})]})]})}},65269:function(e,t,s){s.d(t,{v:function(){return u}});var a=s(57437),n=s(49027),r=s(95098),l=s(2265),i=s(62869),o=s(57346),c=s(41135),d=s(94508);let u=e=>{let{title:t,description:s,children:u,open:m,onOpenChange:p,className:x}=e;return(0,l.useEffect)(()=>(m?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[m]),(0,a.jsx)(n.Vq,{open:m,onOpenChange:p,children:(0,a.jsx)(n.PK,{children:(0,a.jsxs)(n.cZ,{className:"fixed inset-0 z-[10000] flex items-center justify-center overflow-y-auto bg-background",onCloseAutoFocus:e=>{e.preventDefault(),document.body.style.pointerEvents=""},children:[(0,a.jsxs)(r.TX,{children:[(0,a.jsx)(n.$N,{children:t}),(0,a.jsx)(n.Be,{children:s})]}),(0,a.jsxs)("div",{className:(0,d.cn)("flex max-h-full w-full max-w-96 flex-col gap-6 px-4 py-4 md:px-1",x),children:[(0,a.jsx)(c.xx,{className:"size-9 shrink-0"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h2",{className:"mr-auto text-2xl md:text-3xl",children:t}),(0,a.jsx)("p",{className:"w-full",children:s})]}),u]}),(0,a.jsx)("div",{className:"absolute right-2 top-2 md:right-8 md:top-8",children:(0,a.jsx)(n.GG,{asChild:!0,children:(0,a.jsx)(i.z,{className:"hover:bg-transparent hover:opacity-75",variant:"ghost",children:(0,a.jsx)(o.Z,{name:"close",size:"small"})})})})]})})})}},82157:function(e,t,s){s.d(t,{w:function(){return c}});var a=s(57437),n=s(2265),r=s(55721),l=s(57346),i=s(94508),o=s(81103);let c=e=>{let{label:t,isSelected:s,onClick:c,disabled:d,className:u,destructive:m,tooltip:p}=e,[x,h]=(0,n.useState)(!1);return(0,a.jsxs)(o.u,{open:void 0!==p&&x,onOpenChange:h,children:[(0,a.jsx)(o.aJ,{asChild:!0,children:(0,a.jsxs)(r.Xi,{onClick:c,disabled:d,className:(0,i.cn)("flex items-center justify-between",{"bg-muted":s,"cursor-default":d,"text-destructive-primary focus:bg-destructive focus:text-destructive-foreground":m},u),children:[t,s&&(0,a.jsx)(l.Z,{name:"check",size:"small"})]})}),(0,a.jsx)(o._v,{side:"right",className:"max-w-[30ch]",children:p})]})}},65613:function(e,t,s){s.d(t,{Cd:function(){return c},X:function(){return d},bZ:function(){return o}});var a=s(57437),n=s(90535),r=s(2265),l=s(94508);let i=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg]:absolute [&>svg]:text-foreground [&>svg]:left-4 [&>svg]:top-4 [&>svg+div]:translate-y-[-3px] [&>svg~*]:pl-7",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [&>svg]:text-primary-foreground",secondary:"border-transparent bg-secondary text-secondary-foreground [&>svg]:text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground [&>svg]:text-destructive-foreground",warning:"border-transparent bg-warning text-warning-foreground [&>svg]:text-warning-foreground",success:"border-transparent bg-success text-success-foreground [&>svg]:text-success-foreground",accent:"border-transparent bg-accent text-accent-foreground [&>svg]:text-accent-foreground",affirmative:"border-transparent bg-affirmative text-affirmative-foreground [&>svg]:text-affirmative-foreground",outline:"text-foreground border border-border","brand-bubblegum":"bg-brand-bubblegum text-brand-bubblegum-foreground","brand-tiger":"bg-brand-tiger text-brand-tiger-foreground","brand-saffron":"bg-brand-saffron text-brand-saffron-foreground","brand-sapphire":"bg-brand-sapphire text-brand-sapphire-foreground","brand-twilight":"bg-brand-twilight text-brand-twilight-foreground","brand-flamingo":"bg-brand-flamingo text-brand-flamingo-foreground"}},defaultVariants:{variant:"default"}}),o=r.forwardRef((e,t)=>{let{className:s,variant:n,...r}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,l.cn)(i({variant:n}),s),...r})});o.displayName="Alert";let c=r.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("h5",{ref:t,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",s),...n})});c.displayName="AlertTitle";let d=r.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",s),...n})});d.displayName="AlertDescription"},19060:function(e,t,s){s.d(t,{X:function(){return o}});var a=s(57437),n=s(9270),r=s(2265),l=s(94508),i=s(57346);let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.fC,{ref:t,className:(0,l.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),...r,children:(0,a.jsx)(n.z$,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(i.Z,{name:"check",className:"h-4 w-4"})})})});o.displayName=n.fC.displayName},23518:function(e,t,s){s.d(t,{di:function(){return m},e8:function(){return c},fu:function(){return u},mY:function(){return i},rb:function(){return d},sZ:function(){return o}});var a=s(57437),n=s(46343);s(2265),s(26110);var r=s(94508),l=s(57346);function i(e){let{className:t,...s}=e;return(0,a.jsx)(n.mY,{"data-slot":"command",className:(0,r.cn)("flex h-full w-full flex-col overflow-hidden rounded-xl bg-popover text-popover-foreground",t),...s})}function o(e){let{className:t,...s}=e;return(0,a.jsxs)("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[(0,a.jsx)(l.Z,{name:"search",className:"size-4 shrink-0 opacity-50"}),(0,a.jsx)(n.mY.Input,{"data-slot":"command-input",className:(0,r.cn)("flex h-10 w-full rounded-xl bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),...s})]})}function c(e){let{className:t,...s}=e;return(0,a.jsx)(n.mY.List,{"data-slot":"command-list",className:(0,r.cn)("max-h-[300px] scroll-py-1 overflow-y-auto overflow-x-hidden",t),...s})}function d(e){let{...t}=e;return(0,a.jsx)(n.mY.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...t})}function u(e){let{className:t,...s}=e;return(0,a.jsx)(n.mY.Group,{"data-slot":"command-group",className:(0,r.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...s})}function m(e){let{className:t,...s}=e;return(0,a.jsx)(n.mY.Item,{"data-slot":"command-item",className:(0,r.cn)("relative flex cursor-default select-none items-center gap-2 rounded-lg px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg:not([class*='size-'])]:size-4 [&_svg:not([class*='text-'])]:text-muted-foreground [&_svg]:pointer-events-none [&_svg]:shrink-0",t),...s})}},5073:function(e,t,s){s.d(t,{Yi:function(){return o},bZ:function(){return c},zs:function(){return i}});var a=s(57437),n=s(2265),r=s(16605),l=s(94508);let i=r.fC,o=r.xz,c=n.forwardRef((e,t)=>{let{className:s,align:n="center",sideOffset:i=4,...o}=e;return(0,a.jsx)(r.VY,{ref:t,align:n,sideOffset:i,className:(0,l.cn)("z-50 w-64 origin-[--radix-hover-card-content-transform-origin] rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...o})});c.displayName=r.VY.displayName},74991:function(e,t,s){s.d(t,{E:function(){return i},m:function(){return o}});var a=s(57437),n=s(42325),r=s(2265),l=s(94508);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.fC,{className:(0,l.cn)("grid gap-2",s),...r,ref:t})});i.displayName=n.fC.displayName;let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.ck,{ref:t,className:(0,l.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),...r,children:(0,a.jsx)(n.z$,{className:"flex items-center justify-center",children:(0,a.jsx)("div",{className:"aspect-square h-2.5 w-2.5 shrink-0 rounded-full bg-primary"})})})});o.displayName=n.ck.displayName},6512:function(e,t,s){s.d(t,{Separator:function(){return i}});var a=s(57437),n=s(55156),r=s(2265),l=s(94508);let i=r.forwardRef((e,t)=>{let{className:s,orientation:r="horizontal",decorative:i=!0,...o}=e;return(0,a.jsx)(n.f,{ref:t,decorative:i,orientation:r,className:(0,l.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",s),...o})});i.displayName=n.f.displayName},12339:function(e,t,s){s.d(t,{SP:function(){return c},dr:function(){return o},mQ:function(){return i},nU:function(){return d}});var a=s(57437),n=s(20271),r=s(2265),l=s(94508);let i=n.fC,o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.aV,{ref:t,className:(0,l.cn)("inline-flex h-9 items-center justify-center rounded-lg p-1 text-muted-foreground",s),...r})});o.displayName=n.aV.displayName;let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.xz,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",s),...r})});c.displayName=n.xz.displayName;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.VY,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});d.displayName=n.VY.displayName},61563:function(e,t,s){s.d(t,{G:function(){return d},t:function(){return c}});var a=s(57437),n=s(90175),r=s(2265),l=s(63611),i=s(94508);let o=r.createContext({size:"default",variant:"default"}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,children:c,...d}=e;return(0,a.jsx)(n.fC,{ref:t,className:(0,i.cn)("flex items-center justify-center gap-1",s),...d,children:(0,a.jsx)(o.Provider,{value:{variant:r,size:l},children:c})})});c.displayName=n.fC.displayName;let d=r.forwardRef((e,t)=>{let{className:s,children:c,variant:d,size:u,...m}=e,p=r.useContext(o);return(0,a.jsx)(n.ck,{ref:t,className:(0,i.cn)((0,l.E)({variant:p.variant||d,size:p.size||u}),s),...m,children:c})});d.displayName=n.ck.displayName},63611:function(e,t,s){s.d(t,{E:function(){return o},Z:function(){return c}});var a=s(57437),n=s(9987),r=s(90535),l=s(2265),i=s(94508);let o=(0,r.j)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-accent focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),c=l.forwardRef((e,t)=>{let{className:s,variant:r,size:l,...c}=e;return(0,a.jsx)(n.f,{ref:t,className:(0,i.cn)(o({variant:r,size:l,className:s})),...c})});c.displayName=n.f.displayName},30438:function(e,t,s){s.d(t,{c:function(){return o}});var a=s(52558),n=s(61922),r=s(71759);let l=(e,t)=>!!e&&!!t&&t.owner_id===e,i=()=>{let e=(0,r.MD)(),t=(0,r.q$)(t=>e?t.projectWorkspace:null),s=(0,n.i7)(t=>e?null:t.currentWorkspace);return t||s},o=()=>{let{authUser:e}=(0,a.Eu)(),t=i();return l(null==e?void 0:e.uid,t)}},6478:function(e,t,s){s.d(t,{F:function(){return l}});var a=s(57437),n=s(81103),r=s(2265);let l=e=>{let[t,s]=(0,r.useState)(!1),l=(0,r.useRef)(),i=(0,r.useCallback)(e=>{e&&(clearTimeout(l.current),navigator.clipboard.writeText(e),s(!0),l.current=setTimeout(()=>{s(!1)},1e3))},[]);return s=>{let{TriggerComponent:r,textToCopy:l,copiedFeedbackText:o="Copied!"}=s;return(0,a.jsx)(n.pn,{children:(0,a.jsxs)(n.u,{open:t,children:[(0,a.jsx)(n.aJ,{onClick:t=>{(null==e||!e.altKey||t.altKey)&&l&&i(l)},asChild:!0,className:"hello",children:(0,a.jsx)(r,{})}),(0,a.jsx)(n._v,{children:(0,a.jsx)("p",{children:o})})]})})}}},3714:function(e,t,s){s.d(t,{t:function(){return i}});var a=s(59053),n=s(79392),r=s(46170);let l=["bg-blue-800","bg-blue-600","bg-blue-400","bg-blue-200","bg-blue-50"],i=e=>{var t,s;let{billingPeriodCreditLimit:i,billingPeriodCreditsUsed:o,dailyCreditLimit:c,dailyCreditsUsed:d,bonusCredits:u,billingPeriodEndDate:m,totalCreditsUsedInBillingPeriod:p}=(0,a.O)({projectWorkspace:e}),x=(null==e?void 0:e.plan)==="free",h={granted:u||0,billing:i||0,rollover:(null==e?void 0:e.rollover_credits_limit)||0,daily:x?Math.max(0,Math.min(30-(p||0),c||0)):c||0},g={granted:0,billing:o||0,rollover:(null==e?void 0:e.rollover_credits_used)||0,daily:d||0},f={granted:Math.min(g.granted,h.granted),billing:Math.min(g.billing,h.billing),rollover:Math.min(g.rollover,h.rollover),daily:Math.min(g.daily,h.daily)},j={granted:(0,n.G)(h.granted),billing:(0,n.G)(h.billing),rollover:(0,n.G)(h.rollover),daily:(0,n.G)(h.daily)},v={granted:(0,n.G)(f.granted),billing:(0,n.G)(f.billing),rollover:(0,n.G)(f.rollover),daily:(0,n.G)(f.daily)},b=null==e?void 0:e.plan,y=!!b&&(0,r.fA)(b),w="ambassador"===b,N=(y||w)&&((null==e?void 0:e.billing_period_credits_limit)===0||(null==e?void 0:e.billing_period_credits_limit)===void 0),_={granted:j.granted-v.granted,billing:N?0:(0,n.G)(j.billing-v.billing),rollover:j.rollover-v.rollover,daily:(0,n.G)(j.daily-v.daily)},k=(0,n.G)(_.granted+_.billing+_.rollover+_.daily),S=(0,n.G)(v.billing+v.rollover+v.daily),C=(0,n.G)(N?j.granted+j.rollover+j.daily:j.granted+j.billing+j.rollover+j.daily),E=[{name:"granted",remaining:_.granted,limit:j.granted},{name:"billing",remaining:_.billing,limit:j.billing},{name:"rollover",remaining:_.rollover,limit:j.rollover},{name:"daily",remaining:_.daily,limit:j.daily}].filter(e=>e.remaining>0).map((e,t)=>({...e,colorClass:l[Math.min(t,l.length-1)]})),A=_.daily>0?"daily":_.rollover>0?"rollover":_.billing>0?"billing":_.granted>0?"granted":null,D=A&&null!==(s=null===(t=E.find(e=>e.name===A))||void 0===t?void 0:t.colorClass)&&void 0!==s?s:l[0];return{totalRemaining:k,totalAllocation:C,totalUsed:S,sources:E,hasCredits:C>0,currentlyConsuming:A,currentlyConsumingColorClass:D,billingPeriodEndDate:m}}},81677:function(e,t,s){s.d(t,{GD:function(){return o},Zl:function(){return c},Hp:function(){return p},Mn:function(){return m}});var a=s(14438),n=s(91351),r=s(21288);let l="https://github.com/login/oauth/authorize?client_id=".concat("Iv1.365d6a195dbca85b"),i="https://github.com/apps/".concat("lovable-dev","/installations/new"),o="githubOAuthNonce",c=n.Ry({nonce:n.Z_(),workspaceId:n.Z_().optional()}),d=e=>(null==e?void 0:e.id)?"".concat(i,"/permissions?target_id=").concat(e.id,"&target_type=").concat(e.type):i,u=(e,t)=>{let s=crypto.randomUUID();try{localStorage.setItem(o,s)}catch(e){r.logging.error("Failed to set state in GitHub OAuth popup"),a.Am.error("Failed to initiate GitHub OAuth flow",{description:"Try clearing browser local storage and try again."});return}let n=(null==t?void 0:t.workspaceId)?{nonce:s,workspaceId:t.workspaceId}:{nonce:s,workspaceId:void 0},l=new URL(e);l.searchParams.set("state",btoa(JSON.stringify(n))),e=l.toString();let i=window.open(e,"_blank","width=600,height=700,left=100,top=100");if(!i){r.logging.error("Failed to open GitHub OAuth popup");return}i.focus()},m=e=>{let{githubOwner:t,workspaceId:s}=e;u(d(t),{workspaceId:s})},p=()=>{u(l)}},33910:function(e,t,s){s.d(t,{D:function(){return i}});var a=s(92850),n=s(2265),r=s(60256),l=s(79804);let i=e=>{var t,s,i,o,c;let{enabled:d}=e,{userData:u}=(0,r.SE)(),m=(0,a.a)(l.V.installations({enabled:d})),p=null==u?void 0:null===(t=u.github)||void 0===t?void 0:t.encrypted_access_token,x=null==u?void 0:null===(s=u.github)||void 0===s?void 0:s.encrypted_access_token_v3,h=(0,n.useRef)({v2:p,v3:x});return(0,n.useEffect)(()=>{(h.current.v2!==p||h.current.v3!==x)&&(m.refetch(),h.current={v2:p,v3:x})},[p,x,m]),{isLoading:m.isLoading,installations:null===(i=m.data)||void 0===i?void 0:i.installations,hasAccessToken:null===(o=m.data)||void 0===o?void 0:o.has_access_token,hasValidAccessToken:null===(c=m.data)||void 0===c?void 0:c.has_valid_access_token}}},59709:function(e,t,s){s.d(t,{G:function(){return i},d:function(){return c}});var a=s(29827),n=s(2265),r=s(14438),l=s(91351);let i="mcp_oauth_data",o=l.Ry({type:l.i0("mcpAuth"),success:l.O7(),error:l.Z_().optional()}),c=e=>{let{workspaceId:t,onConnectSuccess:s,onConnectError:l,enabled:i=!0}=e,c=(0,a.NL)();(0,n.useEffect)(()=>{if(!i)return;let e=async e=>{if(e.origin!==window.location.origin)return;let a=o.safeParse(e.data);a.success&&(a.data.success?(r.Am.success("Authorization successful!"),await c.invalidateQueries({queryKey:["mcp-servers",t]}),s&&s()):(r.Am.error(a.data.error||"OAuth authorization failed"),l&&l()))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[c,t,s,l,i])}},59053:function(e,t,s){s.d(t,{O:function(){return i}});var a=s(2265),n=s(52558),r=s(79358),l=s(61922);let i=e=>{var t,s;let{isAuthenticated:i}=(0,n.Eu)(),c=(0,l.aS)(e=>e.currentWorkspace),d=null!==(t=null==e?void 0:e.projectWorkspace)&&void 0!==t?t:c,u=(0,a.useMemo)(()=>{var e;if(d&&i)return(null!==(e=d.credits_granted)&&void 0!==e?e:0)-d.credits_used>0||d.daily_credits_used<d.daily_credits_limit||(d.billing_period_credits_used||0)<d.billing_period_credits_limit},[d,i]),m=null==d?void 0:d.daily_credits_limit,p=null==d?void 0:d.daily_credits_used,x=null==d?void 0:d.billing_period_credits_limit,h=null==d?void 0:d.billing_period_credits_used,g=void 0!==x&&void 0!==h&&x>0,f=void 0!==m&&void 0!==p&&m>0,j=g?(0,r.u)(x-h,x):"",v=f?(0,r.u)(m-p,m):"";return{dailyCreditLimit:m,dailyCreditsUsed:p,billingPeriodCreditLimit:x,billingPeriodCreditsUsed:h,hasBillingPeriodCredits:g,hasDailyCreditsLimit:f,billingPeriodCreditsFormatted:j,totalCreditsUsedInBillingPeriod:null==d?void 0:d.total_credits_used_in_billing_period,dailyCreditsFormatted:v,rolloverCredits:(null==d?void 0:d.rollover_credits_limit)!==void 0&&(null==d?void 0:d.rollover_credits_used)!==void 0?d.rollover_credits_limit-d.rollover_credits_used:void 0,bonusCredits:(null==d?void 0:d.credits_granted)!==void 0?d.credits_granted-(null!==(s=d.credits_used)&&void 0!==s?s:0):void 0,areCreditsAvailable:u,billingPeriodEndDate:o(null==d?void 0:d.billing_period_end_date)}},o=e=>e?"string"==typeof e?new Date(e):e.toDate():null},78844:function(e,t,s){s.d(t,{Ef:function(){return u},YP:function(){return c},hb:function(){return m},i6:function(){return d}});var a=s(2265),n=s(14438),r=s(91351),l=s(60256),i=s(21288),o=s(25566);let c="supabaseOAuthNonce",d="supabaseOAuthCodeVerifier",u=r.Ry({workspaceId:r.Z_(),userId:r.Z_().optional(),nonce:r.Z_()}),m=e=>{let[t,s]=(0,a.useState)(!1),{userData:r}=(0,l.SE)();return{handleConnect:(0,a.useCallback)(async()=>{s(!0);try{let t=window.location.origin,a=crypto.randomUUID();try{localStorage.setItem(c,a)}catch(e){i.logging.error("Error storing nonce in localStorage:",{error:e}),n.Am.error("Failed to initiate Supabase OAuth flow",{description:"Try clearing browser local storage and try again."}),s(!1);return}let l=btoa(JSON.stringify({workspaceId:e,userId:null==r?void 0:r.id,nonce:a})),u=o.env.NEXT_PUBLIC_SUPABASE_OAUTH_CLIENT_ID||"dbd565fc-4637-4cb6-ab68-0af4b5708417",m=function(){let e=new Uint8Array(32);return crypto.getRandomValues(e),btoa(String.fromCharCode.apply(null,Array.from(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}(),x=await p(m);localStorage.setItem(d,m);let h="https://api.supabase.com/v1/oauth/authorize?response_type=code"+"&client_id=".concat(u)+"&redirect_uri=".concat(encodeURIComponent("".concat(t,"/supabase/callback")))+"&state=".concat(encodeURIComponent(l))+"&code_challenge=".concat(encodeURIComponent(x))+"&code_challenge_method=S256",g=window.open(h,"_blank","width=600,height=700,left=100,top=100");g?g.focus():window.location.href=h}catch(e){i.logging.error("Error initiating Supabase connection:",{error:e}),n.Am.error("Connection Error",{description:"An error occurred while connecting to Supabase. Please try again."})}finally{s(!1)}},[e,null==r?void 0:r.id]),isConnecting:t}};async function p(e){let t=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",t);return btoa(String.fromCharCode.apply(null,Array.from(new Uint8Array(s)))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}},10441:function(e,t,s){s.d(t,{c:function(){return l}});var a=s(52274),n=s(49131),r=s(97318);let l={domains:e=>{let{projectId:t,enabled:s=!0}=e;return(0,a.C)({queryKey:r.iZ.domains(t),queryFn:async()=>(0,n.SJ)().get("/projects/".concat(t,"/domains")),refetchOnMount:!1,refetchOnWindowFocus:!1,enabled:s&&!!t,staleTime:3e5,retry:!1})}}},51408:function(e,t,s){s.d(t,{V:function(){return i}});var a=s(52274),n=s(49131),r=s(21288),l=s(97318);let i={workspace:e=>{let{workspaceId:t,userData:s}=e;return(0,a.C)({queryKey:l.TZ.workspace(t),queryFn:async()=>{let e=(0,n.SJ)();return(await e.get("/user/workspaces/".concat(t))).workspace},enabled:!!s&&!!t})},workspaces:e=>{let{userData:t}=e;return(0,a.C)({queryKey:l.TZ.workspaces(),queryFn:async()=>{let e=(0,n.SJ)();return await e.get("/user/workspaces")},enabled:!!t})},experimentalFeatures:e=>{let{user:t}=e;return(0,a.C)({queryKey:l.TZ.experimentalFeatures(),enabled:!!t&&!!t.idToken,refetchOnWindowFocus:!1,queryFn:async()=>{let e=(0,n.SJ)();try{return await e.get("/users/".concat(null==t?void 0:t.uid,"/experimental-features"))}catch(e){return r.logging.error("Failed to fetch experimental features",{error:e}),null}}})},contributions:e=>{let{userData:t}=e;return(0,a.C)({queryKey:l.TZ.contributions(null==t?void 0:t.id),queryFn:async()=>(null==t?void 0:t.id)?(0,n.SJ)().get("/users/".concat(t.id,"/contributions")):{},enabled:!!(null==t?void 0:t.username)})},publicProfile:e=>{let{username:t}=e;return(0,a.C)({queryKey:l.TZ.profile(t),queryFn:()=>(0,n.Tb)().get("/profile/".concat(t)),enabled:!!t,retry:!1})}}},74225:function(e,t,s){s.d(t,{P:function(){return a}});let a=e=>e.replace(/(^\w+:|^)\/\//,"")},72384:function(e,t,s){var a,n;s.d(t,{S:function(){return a}}),(n=a||(a={})).AGENT="agent",n.INSTANT="instant"},22853:function(e,t,s){var a,n;s.d(t,{k:function(){return a}}),(n=a||(a={})).ACTIVE_HEALTHY="ACTIVE_HEALTHY",n.ACTIVE_UNHEALTHY="ACTIVE_UNHEALTHY",n.COMING_UP="COMING_UP",n.GOING_DOWN="GOING_DOWN",n.INACTIVE="INACTIVE",n.INIT_FAILED="INIT_FAILED",n.REMOVED="REMOVED",n.RESTARTING="RESTARTING",n.UNKNOWN="UNKNOWN",n.UPGRADING="UPGRADING",n.PAUSING="PAUSING",n.RESTORING="RESTORING",n.RESTORE_FAILED="RESTORE_FAILED",n.PAUSE_FAILED="PAUSE_FAILED"},79358:function(e,t,s){function a(e){return Number.isInteger(e)?e.toString():e.toFixed(2)}function n(e,t){return"".concat(a(e),"/").concat(a(t))}s.d(t,{H:function(){return a},u:function(){return n}})},79392:function(e,t,s){s.d(t,{G:function(){return a},H:function(){return n}});let a=e=>Number.isFinite(e)?Math.round(100*e)/100:0,n=e=>{if(!Number.isFinite(e)||e<0)return"0";let t=Math.round(10*e)/10;return t===Math.floor(t)?t.toLocaleString():t.toLocaleString(void 0,{minimumFractionDigits:1,maximumFractionDigits:1})}},54616:function(e,t,s){s.d(t,{Jh:function(){return l},UM:function(){return o},hO:function(){return i}});var a=s(91351);let n=a.Z_().min(1,"Email is required").email("Please enter a valid email address"),r=a.IX(n).max(3,"You can invite up to 3 team members").refine(e=>new Set(e.map(e=>e.toLowerCase())).size===e.length,{message:"Duplicate email addresses are not allowed"});function l(e){return n.safeParse(e).success}function i(e){let t=e.filter(e=>""!==e.trim());return r.safeParse(t)}function o(e,t){let s=e.filter(e=>""!==e.trim()),a=r.safeParse(s),l=[null,null,null];for(let t=0;t<3;t++){let s=e[t];if(s&&s.trim()){let e=n.safeParse(s);if(!e.success){var i;l[t]=(null===(i=e.error.errors[0])||void 0===i?void 0:i.message)||"Invalid email address"}}}let o=[];return a.success||(o=a.error.errors.filter(e=>0===e.path.length).map(e=>e.message)),t&&s.some(e=>e.trim().toLowerCase()===t.trim().toLowerCase())&&o.push("You cannot invite yourself"),{globalErrors:o,fieldErrors:l}}}}]);