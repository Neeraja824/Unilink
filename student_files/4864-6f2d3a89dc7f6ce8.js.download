try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="7a0ac897-6035-4474-bd76-3fad77e0f419",e._sentryDebugIdIdentifier="sentry-dbid-7a0ac897-6035-4474-bd76-3fad77e0f419")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4864],{62380:function(e,t,s){"use strict";var r,a,n,i,l=s(94746);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)({}).hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e}).apply(null,arguments)}t.Z=function(e){return l.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:109,height:113,fill:"none"},e),r||(r=l.createElement("path",{fill:"url(#supabase_logo_svg__a)",d:"M63.708 110.284c-2.86 3.601-8.658 1.628-8.727-2.97l-1.007-67.251h45.22c8.19 0 12.758 9.46 7.665 15.874z"})),a||(a=l.createElement("path",{fill:"url(#supabase_logo_svg__b)",fillOpacity:.2,d:"M63.708 110.284c-2.86 3.601-8.658 1.628-8.727-2.97l-1.007-67.251h45.22c8.19 0 12.758 9.46 7.665 15.874z"})),n||(n=l.createElement("path",{fill:"#3ECF8E",d:"M45.317 2.071c2.86-3.601 8.657-1.628 8.726 2.97l.442 67.251H9.83c-8.19 0-12.759-9.46-7.665-15.875z"})),i||(i=l.createElement("defs",null,l.createElement("linearGradient",{id:"supabase_logo_svg__a",x1:53.974,x2:94.163,y1:54.974,y2:71.829,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#249361"}),l.createElement("stop",{offset:1,stopColor:"#3ECF8E"})),l.createElement("linearGradient",{id:"supabase_logo_svg__b",x1:36.156,x2:54.484,y1:30.578,y2:65.081,gradientUnits:"userSpaceOnUse"},l.createElement("stop",null),l.createElement("stop",{offset:1,stopOpacity:0})))))}},89396:function(e,t,s){"use strict";s.d(t,{Y:function(){return j},f:function(){return x}});var r=s(57437),a=s(78298),n=s(2265),i=s(59512),l=s(18735),o=s(57346),d=s(94508),c=s(62380),u=s(50126),m=s(77113),p=s(36512),h=s(63858);let v=new Set(["lov-view","lov-write","lov-search-replace","lov-line-replace","lov-delete","lov-rename"]),g=(e,t,s,r)=>{var a;if(null==t?void 0:null===(a=t.file_path)||void 0===a?void 0:a.startsWith("mem://")){if("lov-view"===e)return s?"Recalled memory":"Recalling memory";if(["lov-write","lov-search-replace","lov-line-replace"].includes(e))return s?"Updated memory":"Updating memory"}switch(e){case"read_file":case"lov-think":return s?r?"Thought for ".concat(r," second").concat(r>1?"s":""):"Finished thinking":"Thinking";case"lov-view":return s?"Read":"Reading";case"lov-rename":return s?"Renamed":"Renaming";case"lov-delete":return s?"Deleted":"Deleting";case"lov-write":case"lov-search-replace":case"lov-line-replace":return s?"Edited":"Editing";case"lov-add-dependency":return s?"Installed":"Installing";case"lov-remove-dependency":return s?"Uninstalled":"Uninstalling";case"lov-supabase-migration":return s?"Wrote Supabase migration":"Writing Supabase migration";case"lov-supabase-linter":return s?"Checked performance and security":"Checking performance and security";case"lov-search-files":return s?"Searched for":"Searching for";case"lov-list-dir":return s?"Listed":"Listing";case"lov-read-console-logs":case"lov-read-network-requests":return s?"Checked":"Checking";case"scrape_website":case"lov-fetch-website":return s?"Fetched":"Fetching";case"url_screenshot":case"lov-url-screenshot":return s?"Took screenshot of":"Taking screenshot of";case"lov-download-to-repo":return s?"Downloaded file":"Downloading";case"generate_image":return s?"Generated image":"Generating image";case"edit_image":return s?"Edited image":"Editing image";case"web_search":return s?"Searched":"Searching";case"supabase_read_query":case"supabase_analytics_query":case"lov-supabase-read-query":case"lov-supabase-analytics-query":return"Supabase";case"lov-experimental-supabase-read-query":return"Supabase Read";case"lov-experimental-supabase-insert":return"Supabase Insert";case"lov-experimental-supabase-migration":return"Supabase Migration";case"lov-experimental-supabase-analytics-query":return"Supabase Analytics";case"lov-experimental-supabase-configure-auth":return"Updating Auth config";case"read_project_analytics":return s?"Checked analytics":"Checking analytics";default:return e}},x=(e,t,s)=>{try{var r;let a=null==t?void 0:null===(r=t.file_path)||void 0===r?void 0:r.startsWith("mem://");if((["lov-write","lov-search-replace","lov-line-replace"].includes(e)||"lov-view"===e)&&a)return"";switch(e){case"read_file":case"scrape_website":case"url_screenshot":return(null==t?void 0:t.arg0)||"";case"lov-view":case"lov-delete":case"lov-write":case"lov-search-replace":case"lov-line-replace":return(null==t?void 0:t.file_path)||"";case"lov-rename":return(null==t?void 0:t.original_file_path)&&(null==t?void 0:t.new_file_path)?"".concat(t.original_file_path," to ").concat(t.new_file_path):"";case"lov-download-to-repo":return(null==t?void 0:t.target_path)||"";case"generate_image":case"edit_image":return(null==t?void 0:t.prompt)||"";case"web_search":case"lov-search-files":return(null==t?void 0:t.query)||"";case"lov-add-dependency":case"lov-remove-dependency":return(null==t?void 0:t.package)||"";case"lov-list-dir":return(null==t?void 0:t.dir_path)||"";case"lov-read-console-logs":return"console logs";case"lov-read-network-requests":return"network logs";case"lov-fetch-website":case"lov-url-screenshot":return(null==t?void 0:t.url)||"";case"supabase_read_query":case"lov-supabase-read-query":return s?"read from database":"reading from database";case"supabase_analytics_query":case"lov-supabase-analytics-query":return s?"retrieved logs":"retrieving logs";default:return""}}catch(e){return""}},f=(e,t)=>{var s;if("lov-view"===e&&(null==t?void 0:null===(s=t.file_path)||void 0===s?void 0:s.startsWith("mem://")))return"lightbulb_2";switch(e){case"lov-download-to-repo":return"download";case"web_search":return"search";case"generate_image":case"edit_image":return"draw";case"lov-view":return"scan";case"lov-search-replace":case"lov-line-replace":case"lov-write":return"edit_document";case"lov-rename":return"draft";case"lov-delete":return"scan_delete";case"lov-add-dependency":return"extension";case"lov-remove-dependency":return"extension_off";case"lov-think":case"read_file":return"emoji_objects";case"lov-search-files":case"lov-list-dir":return"document_search";case"lov-read-console-logs":case"lov-read-network-requests":return"monitor_heart";case"scrape_website":case"lov-fetch-website":return"tv";case"url_screenshot":case"lov-url-screenshot":return"screenshot_monitor";case"supabase_read_query":return"table";case"supabase_analytics_query":return"history";case"read_project_analytics":return"analytics";default:return"code"}},b=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"light",a="dark"===s?h.A:h.g;switch(e){case"lov-experimental-supabase-read-query":case"lov-experimental-supabase-insert":case"lov-experimental-supabase-migration":case"lov-experimental-supabase-analytics-query":if(!t.query)return null;return(0,r.jsx)(i.Z,{language:"sql",customStyle:{fontSize:"12px"},style:a,children:t.query});default:return null}},j=n.memo(e=>{var t;let{name:s,parsedData:i,done:h=!0,isShimmering:j=!1,duration:y,collapsed:_=!0,onHeightChange:w}=e,N=g(s,i,h,y),E=x(s,i,h),C=f(s,i),{resolvedTheme:S}=(0,a.F)(),k=b(s,i,S),{setCurrentFile:I}=(0,p.r)(),{setActiveView:A}=(0,u.pE)(),P=(0,m.iZ)(e=>e.project),[R,M]=(0,n.useState)(!0),T=(0,n.useRef)(null),D=(0,n.useRef)(null),[L,z]=(0,n.useState)(0);(0,n.useEffect)(()=>{_&&M(!0)},[_]);let O=!_&&!!k,Z=(0,n.useCallback)(()=>!(!E||E.startsWith("mem://"))&&v.has(s)&&E&&E.includes("."),[E,s]),F=(0,n.useCallback)(e=>{if(e.stopPropagation(),E&&Z()){let e=E;if("lov-rename"===s&&E.includes(" to ")){let t=E.split(" to ");e=t[1]||t[0]}I(e),A("dev-mode")}},[E,Z,s,I,A]);return(0,n.useEffect)(()=>{if(D.current){let e=new ResizeObserver(()=>{D.current&&(z(D.current.scrollHeight),null==w||w())});return e.observe(D.current),z(D.current.scrollHeight),()=>e.disconnect()}},[w]),(0,r.jsxs)("div",{ref:T,className:"flex flex-col text-muted-foreground",children:[(0,r.jsxs)("div",{className:(0,d.cn)("flex h-6 items-center gap-1.5 whitespace-nowrap text-base font-medium md:text-sm",O&&"cursor-pointer"),onClick:()=>O&&M(!R),children:[O&&(0,r.jsx)(o.Z,{name:"chevron_right",size:"small",className:(0,d.cn)("rotate-90 transition-transform duration-200",R&&"rotate-0")}),(0,r.jsx)("div",{className:"mb-px mr-1 flex shrink-0 items-center",children:s.includes("supabase")?(null==P?void 0:null===(t=P.enabled_integrations)||void 0===t?void 0:t.includes("supabase_exp"))?(0,r.jsx)(o.Z,{name:"database",size:"small"}):(0,r.jsx)(c.Z,{className:"h-4 w-auto",viewBox:"0 0 109 113"}):(0,r.jsx)(o.Z,{name:C,size:"small",className:"text-muted-foreground"})}),(0,r.jsx)(l.N,{className:"flex-shrink-0 font-normal",isShimmering:j,children:N}),E&&(0,r.jsx)("span",{className:(0,d.cn)("relative w-fit max-w-xs truncate rounded-md bg-secondary px-2 py-0 text-start text-xs font-normal text-muted-foreground",Z()&&"cursor-pointer transition-colors hover:bg-secondary/80"),"aria-label":E,title:E,onClick:F,children:(0,r.jsx)(l.N,{isShimmering:j,style:{animationDelay:"1.95s",animationTimingFunction:"ease-out"},className:"truncate",children:E})})]}),(0,r.jsx)("div",{ref:D,className:"overflow-hidden",style:{height:R?0:L,opacity:R?0:1},children:k})]})});j.displayName="ToolUseCard"},50618:function(e,t,s){"use strict";var r=s(57437),a=s(62869),n=s(57346),i=s(81103),l=s(94508);t.Z=e=>{let{onClick:t,isBookmarked:s,className:o}=e;return(0,r.jsxs)(i.u,{children:[(0,r.jsx)(i.aJ,{asChild:!0,children:(0,r.jsx)(a.z,{variant:"ghost",size:"icon",className:(0,l.cn)("group/bookmark h-auto w-auto shrink-0 hover:bg-transparent",o),onClick:t,children:(0,r.jsx)(n.Z,{name:s?"bookmark_fill":"bookmark",size:"small",className:(0,l.cn)("text-muted-foreground transition-colors duration-150 ease-in-out group-hover/bookmark:opacity-75",s?"text-affirmative-primary":"")})})}),(0,r.jsx)(i._v,{children:s?"Remove bookmark from history":"Bookmark in history"})]})}},65810:function(e,t,s){"use strict";s.d(t,{z:function(){return so},Y:function(){return sd}});var r=s(57437),a=s(2265),n=s(21288),i=s(94508),l=s(74746),o=s(72116),d=s(1188),c=s(78298),u=s(40236),m=s(59512),p=s(62809),h=s(57346),v=s(63858),g=s(55214),x=s.n(g);let f=(0,a.memo)(e=>{let{children:t,className:s,components:a}=e;return(0,r.jsx)("div",{className:s,children:(0,r.jsx)(u.UG,{components:a,children:t})})});f.displayName="MemoizedReactMarkdown";let b=e=>{let{match:t,codeContent:s,prismTheme:n}=e,[i,l]=(0,a.useState)(!1),o=async()=>{await navigator.clipboard.writeText(String(s)),l(!0),setTimeout(()=>l(!1),2e3)};return(0,r.jsxs)("div",{className:"relative my-2 rounded-md bg-muted",children:[(0,r.jsx)("button",{className:"absolute right-2 top-2 rounded-md bg-secondary p-1 transition-colors hover:bg-muted-hover",onClick:o,children:(0,r.jsx)(h.Z,{name:i?"check":"content_copy",className:"h-4 w-4 text-primary transition-all duration-300"})}),(0,r.jsx)("div",{className:"max-w-full overflow-x-auto font-mono",children:(0,r.jsx)(m.Z,{children:String(s).replace(/\n$/,""),style:n,language:t[1],wrapLongLines:!0,PreTag:"div",customStyle:{padding:"1em",margin:0}})})]})},j=(0,a.memo)(e=>{let{children:t,displayCursor:s,persisted:n}=e,l=!(0,a.useRef)(n).current,o=(0,p.C)(t),{resolvedTheme:u}=(0,c.F)(),m=(0,a.useMemo)(()=>"dark"===u?v.A:v.g,[u]),h=(0,a.useMemo)(()=>({code(e){let{node:t,className:s,children:a}=e,n=/language-(\w+)/.exec(s||"");return n?(0,r.jsx)(b,{match:n,codeContent:a,prismTheme:m}):(0,r.jsx)("span",{className:"mx-px mb-1 inline-block -translate-y-px rounded-md bg-secondary px-1.5 py-1 font-mono text-[13.5px] leading-[13.5px]",children:a})}}),[m]);return(0,r.jsxs)(d.E.div,{initial:{opacity:l?0:1},animate:{opacity:1},transition:{duration:1,ease:"easeOut"},className:"relative max-w-full",children:[l?(0,r.jsx)(f,{className:(0,i.cn)("prose prose-zinc prose-markdown-mobile absolute inset-x-0 top-0 max-w-full dark:prose-invert md:prose-markdown prose-h1:mb-2 prose-h1:text-xl prose-h1:font-medium prose-h2:text-lg prose-h2:font-medium prose-h3:text-base prose-h3:font-medium prose-pre:my-2 prose-pre:whitespace-pre-wrap prose-pre:break-words prose-pre:bg-background prose-ol:my-2 prose-ul:my-2 prose-li:my-0",x().customProse,s&&x().cursor),components:h,children:o}):null,(0,r.jsx)(f,{className:(0,i.cn)("prose prose-zinc prose-markdown-mobile max-w-full dark:prose-invert md:prose-markdown prose-h1:mb-2 prose-h1:text-xl prose-h1:font-medium prose-h2:text-lg prose-h2:font-medium prose-h3:text-base prose-h3:font-medium prose-pre:my-2 prose-pre:whitespace-pre-wrap prose-pre:break-words prose-pre:bg-background prose-ol:my-2 prose-ul:my-2 prose-li:my-0",x().customProse,s&&x().cursor,l&&"pointer-events-none opacity-0"),components:h,children:t})]})});j.displayName="PromptBox";var y=s(62869),_=s(27132),w=s(52089),N=s(65666),E=s(61062),C=s(50126),S=s(90045),k=s(37675),I=s(40878),A=s(91576);let P=e=>{let{actionProps:t}=e,{setActiveMessageId:s,setActiveEditId:n,setConsoleCodeContent:o,setConsoleErrorContent:d,setShowConsole:c,exitConsole:u}=(0,C.pE)(),m=(0,l.aK)(e=>t.messageId?e.messages[t.messageId]:null),p=(0,l.tV)(t.editId),v=(0,C.Sl)(e=>e.consoleContentType),g=(0,C.Sl)(e=>e.activeMessageId),{setCodeViewType:x}=(0,S.VK)(),f=g===t.messageId&&"code"===v,b=(0,a.useMemo)(()=>{var e;return(null==m?void 0:m.type)==="aiMessage"&&(null===(e=m.errors)||void 0===e?void 0:e.filter(e=>!e.dont_show))||[]},[m]),j=(0,_.Z)("md"),{setView:w}=(0,I.zp)(),N=(0,a.useCallback)(()=>{var e;let r=!!(null==p?void 0:null===(e=p.diff)||void 0===e?void 0:e.length);f?u():(j&&w(I.$.PREVIEW),o(t.code),c("code"),d(b),s(t.messageId),n(null==p?void 0:p.id),x(r?S.es.DIFF:S.es.RAW))},[f,u,s,o,d,c,x,n,p,t.messageId,t.code,m]);return(0,r.jsxs)(y.z,{size:"sm",className:(0,i.cn)("h-6 gap-1 px-1.5 py-0.5 text-sm font-normal transition-all duration-150 ease-in-out hover:bg-muted-hover md:h-5 md:text-xs",f&&"bg-affirmative ring-1 ring-affirmative-primary hover:bg-accent/80"),variant:"ghost",onClick:N,children:[(0,r.jsx)(h.Z,{name:"code",size:"small"}),(0,r.jsx)("span",{children:"Code"})]})};var R=s(81103),M=s(49284),T=s(99376),D=s(46214),L=s(26237),z=s(2925),O=s(79396),Z=s(68640),F=s(77113);let U=e=>{let{editId:t,commitSha:s}=e,n=(0,O.I)(),i=(0,F.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.latest_commit_sha}),o=(0,z.u)(e=>e.setCurrentPage),d=(0,z.u)(e=>e.currentPage),{project_id:c}=(0,T.useParams)(),u=(0,l.tV)(t),m=(0,L.C)(),p=(0,Z.Y)({editId:null==u?void 0:u.id,commitSha:null==u?void 0:u.commit_sha}),{isDisabled:h,disabledReason:v}=(0,a.useMemo)(()=>p?{isDisabled:!0,disabledReason:"Cannot restore to an active edit"}:s?n.isPending?{isDisabled:!0,disabledReason:"Restore is in progress"}:m?{isDisabled:!0,disabledReason:(0,r.jsx)("p",{className:"max-w-sm",children:"Cannot revert while there is an active operation in progress (e.g. chat or revert). Please wait for the operation to complete."})}:{isDisabled:m||n.isPending||!s||p,disabledReason:"Disabled"}:{isDisabled:!0,disabledReason:"Not a valid restore target"},[m,n.isPending,s,p]),g=s===i,x=(0,a.useCallback)(e=>{let{eventName:r}=e;t&&(u&&u.pages&&u.pages.length>0&&!u.pages.find(e=>e.name===d)&&o("index"),D.ZP.capture(r,{edit_id:t,commit_sha:s,disabled:h,disabled_reason:v,is_latest_commit:g,is_active_edit:p,project_id:c}),n.mutateAsync({edit:{id:t}}))},[s,d,v,u,t,h,p,c,n,o]);return{onRevert:t?x:void 0,isLatestCommit:g,isDisabled:h,isPending:n.isPending,disabledReason:v}},H=e=>{let{actionProps:t}=e,{onRevert:s,isDisabled:a,isPending:n,disabledReason:l}=U({editId:t.editId,commitSha:t.commitSha}),o=(0,r.jsxs)(y.z,{size:"sm",className:(0,i.cn)("h-6 gap-1 px-1.5 py-0.5 text-sm font-normal transition-colors duration-150 ease-in-out hover:bg-muted-hover md:h-5 md:text-xs"),variant:"ghost",onClick:()=>{s&&s({eventName:M.SL.CODE_CARD.RESTORE_CLICKED})},disabled:a||n,children:[(0,r.jsx)(h.Z,{name:"restart_alt",size:"small",className:n?"animate-spin-reverse":""}),(0,r.jsx)("span",{children:"Restore"})]});return a&&l?(0,r.jsxs)(R.u,{children:[(0,r.jsx)(R.aJ,{asChild:!0,children:(0,r.jsx)("span",{className:"flex items-center rounded",tabIndex:0,children:o})}),(0,r.jsx)(R._v,{children:(0,r.jsx)("p",{children:l})})]}):o},V=(0,a.memo)(e=>{let{children:t,...s}=e;return(0,r.jsx)(y.z,{size:"sm",variant:"ghost",className:"h-5 gap-1 px-1.5 py-0.5 text-xs font-normal transition-colors duration-150 ease-in-out hover:bg-muted-hover",...s,children:t})});V.displayName="CodeCardActionButton";let W=(0,a.memo)(e=>{let{children:t,className:s}=e;return(0,r.jsx)("div",{className:(0,i.cn)("absolute -right-2 bottom-0 translate-y-1/2",s),children:(0,r.jsx)("div",{className:"flex items-center gap-1 rounded-lg border border-muted-border bg-muted p-0.5",children:t})})});W.displayName="BaseCodeCardActions";let K=(0,a.memo)(e=>(0,r.jsxs)(W,{children:[(0,r.jsx)(H,{actionProps:e}),(0,r.jsx)(P,{actionProps:e})]}));K.displayName="CodeCardActions";let q=e=>"parts"in e&&"done"in e,G={[E.N.CODE_DIFF]:"I couldn't apply your changes because the edit strategy I chose failed.",[E.N.FILE_EDITED_WITHOUT_PERMISSION]:"I couldn't apply your changes because I tried to edit a file that I don't have permission to edit.",[E.N.EXCLUDED_FILE_EDITED]:"I couldn't apply your changes because it resulted in unwanted changes",[E.N.NO_CODE_CHANGE]:"I couldn't apply your changes because the code changes I suggested were the same as the previous code."},B=e=>{var t,s;let{errors:n,messageParts:l,edit:o,projectId:c}=e,{setActiveMessageId:u,setActiveEditId:m,exitConsole:p,setShowConsole:v,setConsoleErrorContent:g,setConsoleCodeContent:x}=(0,C.pE)(),{setCodeViewType:f}=(0,S.VK)(),b=(0,C.Sl)(e=>e.activeMessageId),j=(0,C.Sl)(e=>e.consoleContentType),N=(0,_.Z)("md"),{setView:E}=(0,I.zp)(),P=(0,w.qV)({projectId:c,errorIds:(null==n?void 0:n.map(e=>e.id))||[],setErrors:e=>{}}),R=null==n?void 0:null===(t=n[0])||void 0===t?void 0:t.type,M=(0,a.useMemo)(()=>{let e=G[R];return e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:e}),(0,r.jsx)("p",{children:"Please rephrase your request or provide more details."})]}):null},[R]),{onClick:T,isPending:D}=(0,A.hw)({projectId:c,errors:n}),L=n[0].message_id||void 0,z="error"===j&&L===b,O=(0,a.useCallback)(()=>{if(z)p();else{var e;let t=null==l?void 0:l.parts.find(q),s=!!(null==o?void 0:null===(e=o.diff)||void 0===e?void 0:e.length);u(L),m(null==o?void 0:o.id),g(n),v("error"),x(t),f(s?S.es.DIFF:S.es.RAW),N&&E(I.$.PREVIEW)}},[z,null==o?void 0:null===(s=o.diff)||void 0===s?void 0:s.length,null==o?void 0:o.id,n,p,N,L,null==l?void 0:l.parts,m,u,f,x,g,v,E]),Z=(0,k.bk)(e=>e.isSendChatMessageMutationPending),F=D||Z||0===n.length;return n&&P?(0,r.jsxs)("div",{className:"mt-4 flex flex-col gap-4 pb-4",children:[(0,r.jsxs)(d.E.div,{className:"relative flex w-5/6 max-w-xs pr-9",initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeOut",duration:.5},children:[(0,r.jsx)(W,{className:"pr-9",children:(0,r.jsxs)(V,{onClick:T,loading:D,disabled:F,children:[!D&&(0,r.jsx)(h.Z,{name:"bolt",size:"small"}),(0,r.jsx)("span",{children:"Try to fix"})]})}),(0,r.jsx)("div",{className:"w-full",children:(0,r.jsxs)(y.z,{onClick:O,variant:"outline",className:(0,i.cn)("flex h-auto w-full items-start gap-2 rounded-xl p-3 text-base font-medium shadow-none md:text-sm","border border-warning-primary bg-warning text-warning-foreground","transition-colors duration-150 ease-in-out","hover:border-warning-primary/80 hover:bg-warning/80",{"border-affirmative-primary/50 bg-affirmative text-affirmative-foreground hover:border-affirmative-primary/40 hover:bg-accent/90":z}),children:[(0,r.jsx)("div",{className:"flex h-5 items-center",children:(0,r.jsx)(h.Z,{name:"warning",size:"small"})}),(0,r.jsxs)("div",{className:"flex w-full flex-col gap-0 overflow-hidden text-left",children:[(0,r.jsx)("span",{className:"truncate font-medium",children:"Error"}),(0,r.jsx)("span",{className:(0,i.cn)("truncate text-base font-normal md:text-sm"),children:A.v7[n[0].type]})]}),(0,r.jsx)(h.Z,{name:"chevron_right"})]})})]}),M]}):null},Y=e=>{let{errors:t,messageParts:s,edit:a}=e,n=(0,N.D)(),i=null==t?void 0:t.filter(e=>!e.dont_show);return i&&0!==i.length?(0,r.jsx)(B,{edit:a,errors:i,messageParts:s,projectId:n}):null};var J=s(33145),X=s(27648),$=s(49360),Q=s(26438),ee=s(91846),et=s.n(ee),es=s(82176),er=s(60256),ea=s(10531),en=s(72380);let ei=e=>!e||!e.visual_edits_dismissed_at&&!e.visual_edits_temporarily_closed,el=e=>{let{url:t}=e,[s,n]=(0,a.useState)(!0),i=(0,es.dl)(ea.P.BetaTesters),{snapshot:{getUserMessageCount:o}}=(0,l.mx)(),{userData:d}=(0,er.SE)(),c=(0,en.v)(),u=1>=o(),m=(0,a.useMemo)(()=>ei(null==d?void 0:d.tips),[null==d?void 0:d.tips]);return u&&s&&i&&m?(0,r.jsx)("div",{className:"w-full",children:(0,r.jsxs)("div",{className:"rounded-lg bg-muted p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between pb-4",children:[(0,r.jsxs)("span",{className:"flex items-center gap-2 text-base font-medium text-popover-foreground",children:[(0,r.jsx)(h.Z,{name:"my_location"}),(0,r.jsx)("h1",{className:"text-base font-medium",children:"Visual Edits"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{className:"text-base text-muted-foreground hover:underline",onClick:()=>{D.ZP.capture(M.SL.VIDEO_PLAYER.DONT_SHOW_AGAIN_CLICKED),c.mutate({visual_edits_dismissed_at:new Date().toISOString()}),n(!1)},children:"Don't show again"}),(0,r.jsx)("button",{className:"text-muted-foreground",onClick:()=>{D.ZP.capture(M.SL.VIDEO_PLAYER.CLOSE_CLICKED),c.mutate({visual_edits_temporarily_closed:new Date().toISOString()}),n(!1)},children:(0,r.jsx)(h.Z,{name:"close"})})]})]}),(0,r.jsx)("div",{className:"overflow-hidden rounded-lg",children:(0,r.jsx)(et(),{url:t,controls:!0,width:"100%",height:"100%",playbackRate:2.5,onPlay:()=>{D.ZP.capture(M.SL.VIDEO_PLAYER.PLAY_STARTED)}})})]})}):null};var eo=s(14438),ed=s(26110),ec=s(76818),eu=()=>{let[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(""),i=(0,F.iZ)(e=>e.project),{updateProject:l}=(0,F.d2)();(0,a.useEffect)(()=>{(null==i?void 0:i.custom_instructions)&&n(i.custom_instructions)},[i]);let o=async()=>{try{l({custom_instructions:s},{onSuccess:()=>{D.ZP.capture(M.SL.KNOWLEDGE.SAVED),eo.Am.success("Custom instructions updated",{description:"Your custom instructions have been saved successfully."})}}),t(!1)}catch(e){eo.Am.error("Error",{description:"Failed to update custom instructions. Please try again."})}};return(0,r.jsxs)(ed.Vq,{open:e,onOpenChange:t,children:[(0,r.jsx)(ed.hg,{asChild:!0,children:(0,r.jsxs)(y.z,{className:"gap-2 whitespace-nowrap",variant:"outline",size:"sm",onClick:()=>t(!0),children:[(0,r.jsx)(h.Z,{name:"school",className:"text-muted-foreground"}),"Manage knowledge"]})}),(0,r.jsxs)(ed.cZ,{size:"lg",children:[(0,r.jsx)(ed.fK,{children:(0,r.jsx)(ed.$N,{children:"Manage Knowledge"})}),(0,r.jsxs)(ed.Be,{children:["Add custom context and instructions for your project. Lovable will use it in every edit. Use it to:",(0,r.jsxs)("ul",{className:"mt-2 list-disc pl-5",children:[(0,r.jsx)("li",{children:"Define project-specific rules or guidelines"}),(0,r.jsx)("li",{children:"Set coding style preferences (e.g., indentation, naming conventions)"}),(0,r.jsx)("li",{children:"Include external documentation or style guides"})]})]}),(0,r.jsx)(ec.g,{value:s,onChange:e=>n(e.target.value),placeholder:"Enter your custom instructions and context here...",className:"resize-none",rows:16}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(y.z,{onClick:o,children:"Save"})})]})]})},em=s(78079),ep=s(13590),eh=s(21770),ev=s(29501),eg=s(91351),ex=s(15681),ef=s(95186),eb=s(64040),ej=s(49131),ey=s(10867);let e_=e=>{let t=e.reduce((e,t)=>(e[t.key]=eg.Z_().min(1,{message:"".concat(t.name," is required")}),e),{});return eg.Ry(t)},ew=e=>e.toLowerCase().split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ").replace(/api/i,"API"),eN=(0,a.memo)(e=>{let{secretFormActions:t,isMostRecentMessage:s}=e,[n,i]=(0,a.useState)(!1),l=(0,N.D)(),{mutate:o}=(0,em.mo)({projectId:l}),d=(0,a.useMemo)(()=>t.map(e=>({key:e.name,name:ew(e.name)})),[t]),c=(0,a.useMemo)(()=>e_(d),[d]),u=(0,ev.cI)({resolver:(0,ep.F)(c),defaultValues:t.reduce((e,t)=>(e[t.name]="",e),{})});(0,a.useEffect)(()=>{n&&u.reset()},[n,u]);let m=(0,eh.D)({mutationFn:async e=>{let t={secrets:Object.entries(e).map(e=>{let[t,s]=e;return{name:t,value:s}})},s=(0,ej.SJ)();await s.post("/projects/".concat(l,"/supabase/secrets"),t)},onSuccess:()=>{eo.Am.success("API Keys added successfully"),i(!1),o({body:{id:(0,ey.Fd)(),message:"I have now added the API keys you asked for."}})},onError:e=>{(0,eb.Eo)(e)}}),p=(0,a.useCallback)(async e=>{await m.mutateAsync(e)},[m]);return(0,r.jsxs)(ed.Vq,{open:n,onOpenChange:i,children:[(0,r.jsx)(ed.hg,{children:(0,r.jsxs)(y.z,{disabled:!s,variant:"outline",size:"sm",className:"flex items-center gap-1 overflow-hidden text-ellipsis whitespace-nowrap",children:[(0,r.jsx)(h.Z,{name:"key",size:"small"}),"Add API Key",1===t.length?"":"s"]})}),(0,r.jsxs)(ed.cZ,{className:"sm:max-w-[425px]",children:[(0,r.jsxs)(ed.fK,{children:[(0,r.jsx)(ed.$N,{asChild:!0,children:(0,r.jsxs)("h1",{className:"text-2xl font-medium",children:["Add API Key",1===t.length?"":"s"]})}),(0,r.jsxs)(ed.Be,{className:"text-muted-foreground",children:["Enter your API Key",1===t.length?"":"s"," to continue. Manage this later from the Supabase menu."," ",(0,r.jsx)(X.default,{href:"https://docs.lovable.dev/integrations/supabase#storing-secrets-with-supabase",className:"text-primary underline hover:no-underline",target:"_blank",children:"Learn more"})]})]}),(0,r.jsx)(ex.l0,{...u,children:(0,r.jsxs)("form",{onSubmit:u.handleSubmit(p),className:"space-y-4",children:[d.map(e=>(0,r.jsx)(ex.Wi,{control:u.control,name:e.key,render:t=>{let{field:s}=t;return(0,r.jsxs)(ex.xJ,{children:[(0,r.jsx)(ex.lX,{children:e.name}),(0,r.jsx)(ex.NI,{children:(0,r.jsx)(ef.I,{placeholder:"Enter API Key",type:"password",autoComplete:"off",autoSave:"off",...s})}),(0,r.jsx)(ex.zG,{})]})}},e.key)),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(ed.GG,{asChild:!0,children:(0,r.jsx)(y.z,{type:"button",disabled:m.isPending,variant:"outline",children:"Cancel"})}),(0,r.jsx)(y.z,{loading:m.isPending,type:"submit",children:"Submit"})]})]})})]})]})});eN.displayName="AddApiKeysButton";let eE=e=>{let t=document.createElement("div");return t.innerHTML=e,(t.textContent||t.innerText||"").replace(/\n\s*\n/g,"\n\n").trim()};function eC(e){let{open:t,onOpenChange:s,onFeedbackSubmit:n,messageId:i,projectId:l,onCancel:o,initialContent:d}=e,[c,u]=(0,a.useState)(""),[m,p]=(0,a.useState)([]);(0,a.useEffect)(()=>{t&&u(d||"")},[t,d]);let h=e=>{p(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,r.jsx)(ed.Vq,{open:t,onOpenChange:e=>{!e&&(c.length>0||m.length>0)&&D.ZP.capture("message_feedback:dialog_cancelled",{messageId:i,projectId:l,action:"close",hadContent:c.length>0,hadCategories:m.length>0}),e||(u(""),p([]),null==o||o()),s(e)},children:(0,r.jsx)(ed.cZ,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-foreground",children:"Help us improve"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please tell us why this response wasn't helpful to you."}),(0,r.jsx)("div",{className:"mt-4 grid grid-cols-2 gap-2",children:["Design is off","Unrelated changes made","Functionality is broken","Other"].map(e=>(0,r.jsx)(y.z,{variant:m.includes(e)?"default":"outline",className:"w-full justify-start pl-4 ".concat(m.includes(e)?"border border-primary":""),size:"lg",onClick:()=>h(e),children:e},e))})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm text-muted-foreground",children:"Additional Feedback"}),(0,r.jsx)(ec.g,{placeholder:"This was not helpful because ...",value:c,className:"min-h-24 resize-none",onChange:e=>u(e.target.value)})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(y.z,{onClick:()=>{D.ZP.capture("message_feedback:dialog_cancelled",{messageId:i,projectId:l,action:"cancel",hadContent:c.length>0,hadCategories:m.length>0}),u(""),p([]),s(!1),null==o||o()},size:"sm",variant:"secondary",children:"Cancel"}),(0,r.jsx)(y.z,{onClick:()=>{n({content:c,categories:m}),u(""),p([]),s(!1)},size:"sm",variant:"default",children:"Submit"})]})]})})})}let eS=(0,a.memo)(e=>{let{message:t}=e,s=(0,F.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.id}),n=(0,ej.SJ)(),[i,l]=(0,a.useState)(t.feedbackSentiment||null),[o,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{l(t.feedbackSentiment||null)},[t.feedbackSentiment]);let m=(0,eh.D)({mutationFn:async e=>{let{sentiment:r,content:a,categories:i}=e;if(!s)throw Error("Project ID is required");let l={sentiment:r};a&&(l.content=a),i&&i.length>0&&(l.category=i.join(", ")),await n.post("/projects/".concat(s,"/messages/").concat(t.id,"/feedback"),l)},onSuccess:()=>{eo.Am.success("Thanks for your feedback!")},onError:e=>{eo.Am.error("Failed to save feedback",{description:(null==e?void 0:e.message)||"Please try again"})}}),p=async()=>{try{let e=eE(t.content);await navigator.clipboard.writeText(e),u(!0),setTimeout(()=>u(!1),2e3),D.ZP.capture("message_copy",{messageId:t.id,projectId:s})}catch(e){(0,eb.Eo)(e)}},v=(0,_.Z)("md");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mt-1.5 flex flex-shrink-0 items-center gap-3 pr-1",children:[(0,r.jsx)("button",{onClick:()=>{let e="positive"===i?null:"positive";l(e),e&&(m.mutate({sentiment:e}),D.ZP.capture("message_feedback:thumbs_up"))},className:"flex items-center gap-1 transition-colors focus:outline-none ".concat("positive"===i?"text-white-600 hover:text-white-700":"text-muted-foreground hover:text-foreground"),title:"Helpful",children:(0,r.jsx)(h.Z,{size:v?"default":"small",name:"positive"===i?"thumb_up-fill":"thumb_up"})}),(0,r.jsx)("button",{onClick:()=>{"negative"===i?D.ZP.capture("message_feedback:dialog_opened_for_edit",{messageId:t.id,projectId:s,hadPreviousContent:!!t.feedbackContent}):l("negative"),d(!0)},className:"flex items-center gap-1 transition-colors focus:outline-none ".concat("negative"===i?"text-white-600 hover:text-white-700":"text-muted-foreground hover:text-foreground"),title:"Not helpful",children:(0,r.jsx)(h.Z,{size:v?"default":"small",name:"negative"===i?"thumb_down-fill":"thumb_down"})}),(0,r.jsx)("button",{onClick:p,className:"flex items-center gap-1 text-muted-foreground transition-colors hover:text-foreground focus:outline-none",title:c?"Copied!":"Copy message",children:(0,r.jsx)(h.Z,{size:v?"default":"small",name:c?"check":"content_copy"})})]}),(0,r.jsx)(eC,{open:o,onOpenChange:d,onFeedbackSubmit:e=>{m.mutate({sentiment:"negative",content:e.content,categories:e.categories})},messageId:t.id,projectId:s,onCancel:()=>{t.feedbackContent||l(null)},initialContent:t.feedbackContent})]})});eS.displayName="MessageFeedbackButtons";var ek=s(72384);let eI=e=>{let{messageId:t,runState:s,toolUseId:a}=e,n=(0,N.D)(),{mutateAsync:i,isPending:l}=(0,em.mo)({projectId:n}),o=(0,F.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.enabled_integrations}),d=null==o?void 0:o.includes("supabase_exp"),c=async()=>{await i({body:{message:"I have reviewed the SQL and it looks good. Please run it.",id:(0,ey.Fd)(),mode:ek.S.INSTANT,run_sql_in_message_with_id:t,prev_session_id:a?t:void 0},projectId:n})};return d?null:(0,r.jsx)("div",{children:(0,r.jsx)(y.z,{variant:"default",size:"sm",className:"gap-2 py-2",onClick:c,disabled:void 0!==s&&"not_started"!==s||l,children:"not_started"===s||void 0===s?"Apply changes":"running"===s?"Applying changes...":"failed"===s?"Failed to apply changes":"SQL already executed"})})},eA=e=>e.startsWith("https://supabase.com/dashboard/project/")||e.includes("?settings=supabase")?(0,r.jsx)(J.default,{width:16,height:16,src:"/icons/supabase_logo.svg",alt:"Supabase"}):(0,r.jsx)(h.Z,{name:"arrow_outward"});function eP(e){let{linkActions:t}=e;return t&&0!==t.length?(0,r.jsx)(r.Fragment,{children:null==t?void 0:t.map(e=>{let t=e.url.startsWith("/projects/");return(0,r.jsx)(y.z,{asChild:!0,variant:"outline",size:"sm",className:"flex items-center gap-1 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,r.jsxs)(X.default,{href:e.url,target:t?void 0:"_blank",rel:"noopener noreferrer",children:[eA(e.url),(0,r.jsx)("span",{className:"truncate",children:e.text})]})},e.url)})}):null}function eR(e){let{messagePromptActions:t}=e,s=(0,F.iZ)(e=>e.projectId),a=(0,S.hT)(e=>e.chatMode),{setChatMode:n}=(0,S.VK)(),{isAgentModeDefault:i}=(0,Q.v)(),{mutate:l,isPending:o}=(0,em.OU)({projectId:s});return t&&0!==t.length?(0,r.jsx)(r.Fragment,{children:null==t?void 0:t.map(e=>(0,r.jsx)(y.z,{asChild:!0,variant:"outline",size:"sm",disabled:o,onClick:()=>{a===S.jE.CHAT_ONLY&&n(i?S.jE.AGENT:S.jE.DEFAULT),l({body:{id:(0,$.Z)(),message:e.message}})},className:"flex cursor-pointer items-center gap-1 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[(0,r.jsx)(h.Z,{name:"chat_bubble",size:"small"}),(0,r.jsx)("span",{className:"truncate",children:e.text})]})},e.message))}):null}let eM=e=>{var t,s;let{message:n,messageId:i,lovActions:o,sqlRunState:c,persisted:u}=e,{isMostRecentMessage:m}=(0,l.mx)(),{migrateActions:p,linkActions:h,knowledgeAction:v,messagePromptActions:g,secretFormActions:x}=(0,a.useMemo)(()=>{let e=null==o?void 0:o.filter(e=>"lov_action__migrate"===e.type&&e.done),t=null==o?void 0:o.filter(e=>"lov_action__link"===e.type),s=null==o?void 0:o.filter(e=>"lov_action__message_prompt"===e.type),r=null==o?void 0:o.filter(e=>"lov_action__secret_form"===e.type);return{migrateActions:e,linkActions:t,knowledgeAction:null==o?void 0:o.find(e=>"lov_action__knowledge"===e.type),messagePromptActions:s,secretFormActions:r}},[o]);return(0,r.jsxs)(d.E.div,{className:"flex max-w-full flex-1 flex-col gap-4 overflow-hidden",initial:{opacity:u?1:0},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:[u&&(0,r.jsx)(el,{url:"https://customer-8etxbtq55jiz5gtf.cloudflarestream.com/0989fc00edc27647d46bd169d87b7200/manifest/video.m3u8"}),(0,r.jsxs)("div",{className:"flex items-start justify-between gap-4 overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex min-w-0 flex-1 flex-wrap items-center gap-2",children:[(null!==(s=null==p?void 0:p.length)&&void 0!==s?s:0)>0&&(0,r.jsx)(eI,{messageId:i,runState:c,toolUseId:null==p?void 0:null===(t=p[0])||void 0===t?void 0:t.toolUseId},"migrate"),(0,r.jsx)(eP,{linkActions:h}),(0,r.jsx)(eR,{messagePromptActions:g}),x&&x.length>0&&(0,r.jsx)(eN,{secretFormActions:x,isMostRecentMessage:m(i)}),v&&(0,r.jsx)(eu,{})]}),u&&(0,r.jsx)(eS,{message:n})]})]})};var eT=s(48614),eD=s(39484);let eL=e=>{let t=(0,C.Sl)(e=>e.consoleContentType),s=(0,C.Sl)(e=>e.activeView),r=(0,C.Sl)(e=>e.activeEditId),a=(0,l.aK)(e=>e.edits),n=r?a[r]:null,i=(0,Z.Y)({editId:null==e?void 0:e.id,commitSha:null==e?void 0:e.commit_sha}),o=null==n?void 0:n.revert_target_edit_id,d=(null==n?void 0:n.id)===(null==e?void 0:e.id)||!!o&&o===(null==e?void 0:e.id);return{isActive:d&&"snapshot-preview"===t,isActiveCode:d&&"code"===t,shouldShowCurrentEditHighlight:i&&"error"!==t&&"snapshot-preview"!==t&&"code"!==t&&!!e&&"dev-mode"!==s}};var ez=s(76906);let eO=e=>{var t;let{edit:s,messageId:r,code:n}=e,i=(0,F.iZ)(e=>e.project),{setActiveMessageId:l,setActiveEditId:o,setShowConsole:d,exitConsole:c,setConsolePreviewContent:u,setConsoleCodeContent:m,setConsoleErrorContent:p}=(0,C.pE)(),{setCodeViewType:h}=(0,S.VK)(),v=(0,Z.Y)({editId:null==s?void 0:s.id,commitSha:null==s?void 0:s.commit_sha}),{isActive:g,isActiveCode:x}=eL(s),f=(0,a.useMemo)(()=>{if((null==s?void 0:s.commit_sha)&&i)return(0,ez.t)({projectId:null==i?void 0:i.id,sha:null==s?void 0:s.commit_sha})},[null==s?void 0:s.commit_sha,i]);return{handleOpenPreview:(0,a.useCallback)(e=>{var t;if(e.altKey){window.open(f,"_blank");return}if(g||v){c();return}d("snapshot-preview"),l(r),u(f),o(null!==(t=null==s?void 0:s.id)&&void 0!==t?t:void 0)},[g,v,c,l,d,o,s,r,f,u]),handleOpenCode:(0,a.useCallback)(()=>{var e;let t=!!(null==s?void 0:null===(e=s.diff)||void 0===e?void 0:e.length);x?c():(m(n),d("code"),p(void 0),l(r),o(null==s?void 0:s.id),h(t?S.es.DIFF:S.es.RAW))},[null==s?void 0:null===(t=s.diff)||void 0===t?void 0:t.length,null==s?void 0:s.id,x,m,n,d,p,l,r,o,h,c])}};var eZ=s(36461),eF=s(50618);let eU=e=>{var t,s;let{onClick:n,children:l,edit:o,message:d,code:c,isLoading:u}=e,m=(0,F.iZ)(e=>e.project),{toggleBookmark:p}=(0,eZ.g)((null==m?void 0:m.id)||""),{isActive:h,shouldShowCurrentEditHighlight:v}=eL(o),g=(0,a.useCallback)(e=>{e.stopPropagation(),(null==o?void 0:o.id)&&p(o.id,!!o.bookmarked)},[o,p]);return(0,r.jsxs)("div",{className:"flex w-full items-start gap-1",children:[(0,r.jsxs)("div",{className:"relative w-full",children:[!!o&&(0,r.jsx)(K,{editId:null!==(t=null==o?void 0:o.id)&&void 0!==t?t:void 0,commitSha:null!==(s=null==o?void 0:o.commit_sha)&&void 0!==s?s:void 0,messageId:d.id,code:c}),(0,r.jsx)(y.z,{onClick:n,variant:"outline",className:(0,i.cn)("flex h-auto w-full max-w-56 cursor-pointer gap-2 rounded-xl p-3 text-base font-medium shadow-none sm:max-w-xs md:text-sm",u?"items-center":"items-start","border border-muted-border bg-muted text-foreground","transition-all duration-150 ease-in-out","hover:border-border hover:bg-muted-hover",{"border-affirmative-primary bg-affirmative hover:border-affirmative-primary/80 hover:bg-affirmative/80":v||h,"hover:cursor-auto hover:border-affirmative-primary hover:bg-affirmative":v}),children:l})]}),(null==o?void 0:o.id)&&(0,r.jsx)("div",{className:"flex h-8 w-8 flex-shrink-0 items-center justify-center",children:(0,r.jsx)(eF.Z,{onClick:g,isBookmarked:!!o&&!!o.bookmarked&&(null==o?void 0:o.bookmarked),className:"mt-3"})})]})};var eH=s(89396);let eV=e=>"edit"===e.variant?(0,r.jsx)(eW,{...e}):(0,r.jsx)(eK,{...e}),eW=e=>{let{message:t,edit:s,onClick:a,isActive:n,code:i}=e,l=!0;"aiMessage"===t.type&&(l=i.done||"running"!==t.status);let d=(0,o.zL)(i),c=(0,Z.Y)({editId:null==s?void 0:s.id,commitSha:null==s?void 0:s.commit_sha}),u="aiMessage"===t.type&&!t.stopped&&!l;return(0,r.jsxs)(eU,{edit:s,message:t,code:i,onClick:a,isLoading:u,children:[d>0&&(0,r.jsx)("div",{className:"flex h-5 items-center",children:(0,r.jsx)(h.Z,{name:"language",size:"small"})}),l?(0,r.jsx)(eB,{message:t,isCurrentEdit:c,edit:s,isActive:n,code:i}):i&&(0,r.jsx)(eG,{isActive:n,code:i,messageStopped:"aiMessage"===t.type&&t.stopped}),(0,r.jsx)(h.Z,{name:"chevron_right"})]})},eK=e=>{let{message:t,edit:s,onClick:a,isActive:n}=e,i=(0,Z.Y)({editId:null==s?void 0:s.id,commitSha:null==s?void 0:s.commit_sha});return(0,r.jsxs)(eU,{edit:s,message:t,code:void 0,onClick:a,isLoading:!1,children:[(0,r.jsx)(eB,{message:t,isCurrentEdit:i,edit:s,isActive:n}),(0,r.jsx)(h.Z,{name:"chevron_right"})]})},eq=(0,a.memo)(e=>{let{message:t,edit:s,code:a}=e,{isActive:n}=eL(s),{handleOpenCode:i,handleOpenPreview:l}=eO({edit:s,messageId:t.id,code:a}),o=(0,_.Z)("md"),{setView:c}=(0,I.zp)(),u="aiMessage"===t.type&&t.persisted;return(0,r.jsx)(d.E.div,{className:"relative flex w-5/6 max-w-xs pb-4",initial:{opacity:u?1:0},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:(0,r.jsx)(eV,{variant:"edit",code:a,message:t,edit:null!=s?s:null,onClick:e=>{o&&c(I.$.PREVIEW),s?l(e):i()},isActive:n})})});eq.displayName="CodeCard";let eG=(0,a.memo)(e=>{let{isActive:t,code:s,messageStopped:n}=e,[l,o]=(0,a.useState)(""),c=!n;(0,a.useEffect)(()=>{s.parts.length>0&&o(e=>eJ(s)||e)},[s]);let u=c?l||"...":l;return(0,r.jsx)("div",{className:"min-h-[1.375rem] min-w-0 flex-1",children:(0,r.jsx)(eT.M,{mode:"popLayout",children:(0,r.jsx)(d.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:(0,i.cn)("truncate text-muted-foreground",{"text-foreground":t}),children:u}),c&&(0,r.jsx)(eD.T,{text:"",className:"mt-0"})]})},u)})})});eG.displayName="EditingTitle";let eB=(0,a.memo)(e=>{let{message:t,edit:s,code:n,isActive:l,isCurrentEdit:d}=e,{title:c,body:u}=(0,a.useMemo)(()=>{let e=void 0!==n?(0,o.zL)(n):0;if(s){var r;return{title:"".concat(null!==(r=s.commit_message)&&void 0!==r?r:"no commit message"),body:d?"Preview Latest":"Preview"}}if(0===e&&"aiMessage"===t.type&&void 0!==t.thinkingTimeMs)return{title:"Saving changes...",body:"View more"};let a="aiMessage"===t.type?t.status:"completed",i="Saving changes...";return"stopped"===a&&(i="Generation stopped"),"completed"!==a||t.editId||(i="Failed to save changes"),{title:"Edited ".concat(e," file").concat(1===e?"":"s"),body:i}},[t,d,s,n]);return(0,r.jsxs)("div",{className:"flex w-full flex-col gap-1 overflow-hidden text-left",children:[(0,r.jsx)("span",{className:(0,i.cn)("truncate",{"text-foreground":l}),children:c}),(0,r.jsx)("span",{className:"truncate font-normal",children:u})]})});eB.displayName="FinishedEditingTitle";let eY=e=>{if(!e)return"";let t=e.split(/[\/\\]/);return t[t.length-1]},eJ=e=>{for(let t=e.parts.length-1;t>=0;t--){let s=e.parts[t];if("writing_file"===s.type||"edit"===s.type)return"Writing ".concat(eY(s.file_path));if("delete"===s.type)return"Deleting ".concat(eY(s.file_path));if("rename"===s.type)return"Renaming ".concat(eY(s.original_file_path));else if("add_dependency"===s.type)return"Installing ".concat(s.dependency);else if("remove_dependency"===s.type)return"Uninstalling ".concat(s.removed_dependency);else if("tool_use"===s.type){let e=(0,eH.f)(s.name||"",s.parsedData,!1);if(e)return e;{let e=s.name||"";return e.split("-").pop()||e}}}return"Thinking..."};var eX=s(18735);let e$=e=>{let{name:t,parsedData:s}=e;switch(t){case"lov-view":case"lov-write":case"lov-search-replace":case"lov-line-replace":return(null==s?void 0:s.file_path)||"";default:return""}},eQ=e=>["lov-view","lov-write","lov-search-replace","lov-line-replace"].includes(e),e0=e=>["lov-search-replace","lov-line-replace","lov-write","lov-delete","lov-rename"].includes(e),e1=e=>{if(0===e.length)return[];let t=[],s=[],r="";for(let a of e){let e=eQ(a.name),n=e?e$(a):"";if(e&&n&&n===r&&s.length>0)s.push(a);else{if(s.length>0){let e=s[s.length-1],r=s.every(e=>e.done);t.push({...e,done:r})}e&&n?(s=[a],r=n):e||(s=[],r="",t.push(a))}}if(s.length>0){let e=s[s.length-1],r=s.every(e=>e.done);t.push({...e,done:r})}return t},e2=e=>{let{toolUses:t,isShimmering:s}=e,a=t.some(e=>e0(e.name)),n=t.filter(e=>e0(e.name)).length,i=t.length,l=a?n:i,o=a?"".concat(l," edit").concat(1!==l?"s":""," made"):"".concat(l," tool").concat(1!==l?"s":""," used");return(0,r.jsxs)("div",{className:"flex h-6 items-center gap-1.5 whitespace-nowrap text-base font-medium text-muted-foreground md:text-sm",children:[(0,r.jsx)("div",{className:"mb-px mr-1 flex shrink-0 items-center",children:(0,r.jsx)(h.Z,{name:a?"edit_document":"emoji_objects",size:"small",className:"text-muted-foreground"})}),(0,r.jsx)(eX.N,{className:"flex-shrink-0 font-normal",isShimmering:s,children:o})]})},e5=e=>{let{toolUses:t,isStreaming:s=!1,isLastElement:n=!1,messageCompleted:l=!1}=e,[o,d]=(0,a.useState)(!1),c=(0,a.useMemo)(()=>e1(t),[t]),u=(0,a.useMemo)(()=>0===c.length?"":"".concat(c[0].name,"-").concat(Object.keys(c[0].parsedData).join("-")),[c.length>0?c[0].name:"",c.length>0?Object.keys(c[0].parsedData).join("-"):""]),m=n&&!l,p=t.some(e=>!e.done),h=c.length>1,v=(0,a.useRef)(null),[g,x]=(0,a.useState)(0),f=(0,a.useRef)(null),b=(0,a.useCallback)(()=>{f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{v.current&&x(v.current.scrollHeight)},50)},[]);if((0,a.useEffect)(()=>()=>{f.current&&clearTimeout(f.current)},[]),(0,a.useEffect)(()=>{v.current&&x(v.current.scrollHeight)},[v,o,c]),0===c.length)return null;if(!h)return(0,r.jsx)(eH.Y,{name:c[0].name,parsedData:c[0].parsedData,done:c[0].done,isShimmering:m,duration:c[0].duration,collapsed:!1});let j=c[c.length-1];return(0,r.jsxs)("div",{className:"relative flex w-full flex-col",children:[(0,r.jsx)(y.z,{onClick:()=>d(!o),variant:"outline",className:(0,i.cn)("absolute right-0 top-0 z-10 flex h-6 items-center justify-center px-1.5 py-1 text-base font-normal transition-all duration-300 ease-out md:text-sm"),"aria-label":o?"Collapse tool uses":"Expand tool uses",children:o?"Hide":"Show all"}),(0,r.jsx)("div",{className:"relative overflow-hidden transition-all duration-300 ease-in-out",style:{height:o?"".concat(g,"px"):"24px"},children:o?(0,r.jsx)("div",{ref:v,className:"absolute top-0 flex w-full flex-col gap-2",children:c.map((e,t)=>(0,r.jsx)("div",{className:"transition-all duration-300 ease-out",children:(0,r.jsx)(eH.Y,{collapsed:!1,onHeightChange:b,name:e.name,parsedData:e.parsedData,done:e.done,isShimmering:m&&t===c.length-1&&!e.done,duration:e.duration})},"".concat(u,"-").concat(t)))}):(0,r.jsx)("div",{className:"flex h-full items-end",children:p||!l&&n?(0,r.jsx)("div",{className:"flex h-6 items-center",children:(0,r.jsx)(eH.Y,{name:j.name,parsedData:j.parsedData,done:j.done,isShimmering:m&&!j.done,duration:j.duration,collapsed:!0})}):(0,r.jsx)(e2,{toolUses:c,isShimmering:!1})})})]})},e6=(0,a.memo)(e=>{let{mermaid:t,className:s}=e,{setActiveMermaidContent:a,setShowConsole:n}=(0,C.pE)(),l=e=>{if(!e)return"Diagram";let t=e.trim().toLowerCase();return t.startsWith("graph")?"Flowchart":t.startsWith("sequencediagram")?"Sequence":t.startsWith("classdiagram")?"Class":t.startsWith("erdiagram")?"Entity Relationship":t.startsWith("journey")?"User Journey":t.startsWith("gitgraph")?"Git Graph":t.startsWith("pie")?"Pie Chart":t.startsWith("gantt")?"Gantt Chart":t.startsWith("statediagram")?"State":t.startsWith("mindmap")?"Mind Map":"Diagram"},o=l(t.mermaidCode),c=!t.done;return(0,r.jsx)(d.E.div,{className:"relative flex w-5/6 max-w-xs pb-4",initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:(0,r.jsx)(y.z,{onClick:e=>{var s;e.stopPropagation(),t.done&&(a(t),n("mermaid"),D.ZP.capture(M.SL.MERMAID.DIAGRAM_OPENED,{diagram_type:l(t.mermaidCode),code_length:(null===(s=t.mermaidCode)||void 0===s?void 0:s.length)||0}))},variant:"outline",className:(0,i.cn)("flex h-auto w-full cursor-pointer gap-2 rounded-xl p-3 text-sm font-medium shadow-none",c?"items-center":"items-start","border border-muted-border bg-muted text-foreground","transition-all duration-150 ease-in-out",c?"opacity-60 hover:border-muted-border hover:bg-muted":"hover:border-border hover:bg-muted-hover",s),disabled:c,children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex h-5 items-center",children:(0,r.jsx)(h.Z,{name:"progress_activity",size:"small",className:"animate-spin"})}),(0,r.jsx)("span",{className:"flex-1 text-left",children:"Generating diagram..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex h-5 items-center",children:(0,r.jsx)(h.Z,{name:"auto_stories",size:"small"})}),(0,r.jsx)("span",{className:"flex-1 text-left",children:o}),(0,r.jsx)(h.Z,{name:"chevron_right"})]})})})}),e4=e=>{let{codeContent:t}=e,[s,n]=(0,a.useState)(!1),i=async()=>{await navigator.clipboard.writeText(String(t)),n(!0),setTimeout(()=>n(!1),2e3)},{resolvedTheme:l}=(0,c.F)(),o="dark"===l?v.A:v.g;return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{className:"hover:bg-card-hover absolute right-2 top-2 rounded-md bg-secondary p-1 transition-colors",onClick:i,children:(0,r.jsx)(h.Z,{name:s?"check":"content_copy",className:"h-4 w-4 text-foreground transition-all duration-300"})}),(0,r.jsx)("div",{className:"max-w-full overflow-x-auto",children:(0,r.jsx)(m.Z,{children:String(t).replace(/\n$/,""),style:o,language:"sql",wrapLongLines:!0,PreTag:"div"})})]})};function e7(e){return"input"===e.type||"secret"===e.type}let e3=e=>{var t;let{message:s,disabled:a,userInput:n,onSubmit:i}=e,l=(0,ev.cI)(),o=null!==(t=null==n?void 0:n.filter(e7).map(e=>{let t=e.data;return l.register(t.name,{...t,pattern:t.pattern?new RegExp(t.pattern):void 0})}))&&void 0!==t?t:[];return(0,r.jsx)(ex.l0,{...l,children:(0,r.jsx)("form",{onSubmit:l.handleSubmit(i),children:n.map((e,t)=>{switch(e.type){case"instructions":return(0,r.jsx)(j,{displayCursor:!1,persisted:s.persisted,children:e.data.text},t);case"input":case"secret":let n=o.find(t=>t.name===e.data.name);if(!n)return null;return(0,r.jsx)(ex.Wi,{control:l.control,name:n.name,render:t=>{let{field:s}=t;return(0,r.jsxs)(ex.xJ,{className:"mt-2 flex flex-col gap-0 rounded-2xl bg-secondary p-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(ex.lX,{className:"ml-0.5 flex items-center gap-1 text-base font-normal",children:[(0,r.jsx)("span",{className:"align-text-bottom leading-loose",children:e.data.label}),e.data.helpLink&&(0,r.jsx)(y.z,{variant:"ghost",size:"icon-sm",className:"h-6 hover:bg-transparent",children:(0,r.jsx)(X.default,{href:e.data.helpLink,target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)(h.Z,{name:"help",size:"small"})})})]}),e.data.link&&(0,r.jsx)(y.z,{variant:"ghost",size:"icon-sm",className:"flex h-6 items-center gap-1 font-normal text-muted-foreground hover:bg-transparent",asChild:!0,children:(0,r.jsxs)(X.default,{href:e.data.link,target:"_blank",rel:"noopener noreferrer",children:[e.data.linkTitle||"Learn more",(0,r.jsx)(h.Z,{name:"arrow_outward",size:"small"})]})})]}),(0,r.jsx)(ex.NI,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"mb-2 mt-0 flex items-center gap-2",children:(0,r.jsx)(ef.I,{className:"h-8 bg-background",...s})}),(0,r.jsx)(e8,{disabled:a,type:"submit"})]})}),(0,r.jsx)(ex.zG,{})]})}});default:return null}})})})},e8=e=>{let{disabled:t,type:s,onClick:a}=e;return(0,r.jsx)(y.z,{type:s,variant:"outline",onClick:a,disabled:t,children:"Approve"})},e9=e=>e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),te=e=>{let{onSubmit:t,text:s,disabled:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tool use"}),(0,r.jsxs)("div",{className:"flex flex-row items-center gap-8",children:[(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"m-0 text-base",children:e9(s)})}),(0,r.jsx)(e8,{disabled:a,onClick:()=>t({})})]})]})},tt="Lovable tool use: Approved.\n\ncontext: 6951EAA2-1264-4A1A-A86D-817E462202C7",ts=e=>{let{message:t,toolUse:s}=e,a=(0,N.D)(),n=(0,l.$m)(),i=(null==n?void 0:n.messageId)===t.id,{mutateAsync:o,isPending:d}=(0,em.mo)({projectId:a}),c=async e=>{await o({body:{message:tt,id:(0,ey.Fd)(),mode:ek.S.INSTANT,prev_session_id:t.id,user_input:e},projectId:a})};return(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)("div",{className:"max-w-full",children:s.userInput?(0,r.jsx)(e3,{userInput:s.userInput,disabled:!i||d,message:t,onSubmit:c}):(0,r.jsx)(te,{onSubmit:c,disabled:!i||d,text:s.name})})})},tr=e=>"parts"in e&&"done"in e,ta=e=>"lovSql"in e&&"done"in e,tn=e=>"lov-supabase-migration"===e.name,ti=e=>"mermaidCode"in e&&"done"in e,tl=e=>{var t;let{message:s,edit:a,messageParts:n}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(to,{message:s,messageParts:n,edit:a}),s.stopped&&(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("span",{className:"inline-flex items-center text-muted-foreground",children:"This message was cancelled."})}),s.errors&&(0,r.jsx)(Y,{edit:a,messageParts:n,errors:null!==(t=s.errors)&&void 0!==t?t:null}),(0,r.jsx)(eM,{message:s,messageId:s.id,lovActions:null==n?void 0:n.lovActions,sqlRunState:s.sqlRunState,persisted:s.persisted})]})},to=e=>{let{message:t,messageParts:s,edit:a}=e;if(!s)return t.content.length>0?(0,r.jsx)(j,{displayCursor:!1,persisted:t.persisted,children:t.content||""}):null;let n=[],i=[],l=s.parts.some(e=>(0,o.Cg)(e)&&!e.done),d=e=>{i.length>0&&(n.push((0,r.jsx)(e5,{toolUses:i,isStreaming:l,isLastElement:e,messageCompleted:t.persisted},"tool-group-".concat(n.length))),i=[])},c=e=>"content"in e&&""===e.content.trim();for(let e=0;e<s.parts.length;e++){let l=s.parts[e];if((0,o.Cg)(l)){if(l.failed)continue;if(l.requiresApproval&&!tn(l)){d(!1),n.push((0,r.jsx)(ts,{message:t,toolUse:l},e));continue}if(i.length,i.push({name:l.name,parsedData:l.parsedData,done:l.done,duration:l.duration}),tn(l)&&l.parsedData&&l.parsedData.query){let t=l.parsedData.query.replace(/\\n/g,"\n").replace(/\\t/g,"	").replace(/\\r/g,"\r");n.push((0,r.jsx)(e4,{codeContent:t},e))}}else if(!c(l)){if(d(!1),tr(l))n.push((0,r.jsx)(eq,{message:t,edit:a,code:l},e));else if(ta(l))n.push((0,r.jsx)(e4,{codeContent:l.lovSql},e));else if(ti(l))n.push((0,r.jsx)(e6,{mermaid:l},e));else if("content"in l)n.push((0,r.jsx)(j,{displayCursor:!1,persisted:t.persisted,children:l.content},e));else throw Error("Unknown part type")}}return d(!0),(0,r.jsx)(r.Fragment,{children:n})},td={},tc=e=>{let{message:t,isFirstAIMessage:s}=e,n=(0,l.tV)(t.editId),d=t.timeToFirstTokenMs;void 0===d?td[t.id]=!0:td[t.id]&&(td[t.id]=!1);let c=(0,a.useMemo)(()=>t.content?function(e,t){if((null==e?void 0:e.parts.length)&&e.parts.length>0){let s=e.parts.find(e=>"object"==typeof e&&"type"in e&&"tool_use"===e.type&&"duration"in e);if(s){if(!t)return s.duration=void 0,e;let r=s.duration+Math.floor(t/1e3);s.duration=r}}return e}((0,o.hP)(t.content),d):null,[t.id,t.content,d]);return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-4 overflow-auto pl-8 text-left text-base leading-[22px]"),style:{overflowWrap:"anywhere"},children:(0,r.jsx)(tl,{message:t,edit:n,messageParts:c})})},tu=e=>{let{branchName:t}=e;return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{children:"Switched branch to"}),(0,r.jsx)("div",{className:"flex items-center gap-2 rounded-full border border-muted-border bg-muted px-2 py-0.5",children:(0,r.jsx)("p",{children:t})})]})};var tm=s(25658),tp=s(41135),th=s(3813),tv=s(47902),tg=s(55721),tx=s(79358);let tf=e=>{let{remixedProjectId:t,isLoading:s=!1}=e;return(0,r.jsxs)(ed.cZ,{children:[(0,r.jsxs)(ed.fK,{children:[(0,r.jsx)(ed.$N,{children:s?"Remixing Project Snapshot...":"Project Snapshot Remixed Successfully"}),(0,r.jsx)(ed.Be,{children:s?"Please wait while we remix your project snapshot. This may take a moment.":"Your project snapshot has been remixed to your local development environment."})]}),(0,r.jsx)(ed.cN,{children:s?(0,r.jsxs)(y.z,{disabled:!0,children:[(0,r.jsx)(h.Z,{name:"progress_activity",size:"small",className:"animate-spin"}),"Remixing..."]}):(0,r.jsx)(y.z,{asChild:!0,children:(0,r.jsx)("a",{href:"http://localhost:3000/projects/".concat(t),target:"_blank",rel:"noreferrer",children:"Open Remixed Project"})})})]})};var tb=s(71759),tj=s(49968),ty=s(88391),t_=s(35974),tw=s(67817),tN=s(46170);let tE=e=>"https://us.posthog.com/project/47074/llm-observability/traces/".concat(e),tC=e=>{let{className:t}=e;return(0,r.jsx)(t_.C,{variant:"outline",className:t,children:"ADMIN"})},tS=e=>!!e&&!!(e.data_opt_out||(0,tN.gG)(e.plan)),tk=e=>{let{messageId:t,editId:s}=e,n=(0,N.D)(),i=(0,tw.v)(),{setActiveMessageId:l,setShowConsole:o}=(0,C.pE)(),d=(0,ty.z)(tf),[c,u]=(0,a.useState)(!1),m=tS((0,tb.hO)(e=>e.projectWorkspace)),p=async()=>{d({childProps:{isLoading:!0}}),u(!0);try{let e=(0,ej.SJ)(),s=await e.post("/projects/".concat(n,"/remix/snapshot"),{message_id:t,keep_supabase_connection:!0});d({childProps:{remixedProjectId:s.project_id,isLoading:!1}})}catch(e){eo.Am.error("Failed to remix project snapshot",{description:"An error occurred while remixing the project snapshot to local development."}),d(!1)}finally{u(!1)}};return i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tg.VD,{}),(0,r.jsxs)(tg.Xi,{className:"w-full gap-2",onClick:()=>{l(t),o("debug")},children:[(0,r.jsx)(h.Z,{name:"bug_report",size:"small"}),(0,r.jsx)("span",{children:"Debug"}),(0,r.jsx)(tC,{className:"ml-auto"})]}),!m&&(0,r.jsxs)(tg.Xi,{className:"w-full gap-2",onClick:()=>{l(t),o("annotation")},children:[(0,r.jsx)(h.Z,{name:"edit",size:"small"}),(0,r.jsx)("span",{children:"Annotate"}),(0,r.jsx)(tC,{className:"ml-auto"})]}),!m&&(0,r.jsxs)(tg.Xi,{className:"w-full gap-2",onClick:p,disabled:c,children:[(0,r.jsx)(h.Z,{name:"refresh",size:"small",className:c?"animate-spin":""}),(0,r.jsx)("span",{children:c?"Remixing...":"Remix Snapshot to Local"}),(0,r.jsx)(tC,{className:"ml-auto"})]}),i&&(0,r.jsx)(tg.Xi,{className:"w-full gap-2",asChild:!0,children:(0,r.jsxs)("a",{href:tE(t),target:"_blank",rel:"noreferrer",children:[(0,r.jsx)(h.Z,{name:"arrow_outward",size:"small"}),(0,r.jsx)("span",{children:"Posthog: View LLM Trace"}),(0,r.jsx)(tC,{className:"ml-auto"})]})}),(0,r.jsx)(tg.Xi,{className:"w-full gap-2",asChild:!0,children:(0,r.jsxs)("a",{href:(0,tj.pr)(n,t),target:"_blank",rel:"noreferrer",children:[(0,r.jsx)(h.Z,{name:"arrow_outward",size:"small"}),(0,r.jsx)("span",{children:"Firestore: Message"}),(0,r.jsx)(tC,{className:"ml-auto"})]})}),s&&(0,r.jsx)(tg.Xi,{className:"w-full gap-2",asChild:!0,children:(0,r.jsxs)("a",{href:(0,tj.oo)(n,s),target:"_blank",rel:"noreferrer",children:[(0,r.jsx)(h.Z,{name:"arrow_outward",size:"small"}),(0,r.jsx)("span",{children:"Firestore: Edit"}),(0,r.jsx)(tC,{className:"ml-auto"})]})})]}):null};var tI=s(6478);let tA=e=>{let{messageId:t}=e,s=(0,N.D)(),n=(0,tI.F)(),i=(0,a.forwardRef)((e,t)=>(0,r.jsx)(tg.Xi,{ref:t,...e,children:(0,r.jsxs)("div",{className:"flex w-full justify-between gap-4",onClick:()=>{D.ZP.capture(M.SL.ELLIPSIS.COPY_LINK_CLICKED)},children:[(0,r.jsx)("span",{children:"Copy message link"}),(0,r.jsx)(h.Z,{name:"link",size:"small",className:"ml-auto"})]})}));i.displayName="TriggerComponent";let l=n({TriggerComponent:i,textToCopy:"".concat(window.location.origin,"/projects/").concat(s,"?messageId=").concat(t)});return(0,r.jsxs)(R.u,{children:[(0,r.jsx)(R.aJ,{asChild:!0,children:l}),(0,r.jsx)(R._v,{children:"Copy link to clipboard"})]})},tP=e=>{let{commitSha:t,previewBuildStatus:s}=e,r=(0,F.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.latest_commit_sha}),{project_id:n}=(0,T.useParams)(),i=(0,F.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.name}),l=t===r,o=(0,a.useMemo)(()=>{if(t&&i)return(0,ez.t)({projectName:i,sha:t})},[t,i]),{isDisabled:d,disabledReason:c}=(0,a.useMemo)(()=>"pending"===s?{isDisabled:!0,disabledReason:"Preview is being built..."}:"failed"===s?{isDisabled:!0,disabledReason:"Failed to build preview"}:o?{isDisabled:!1,disabledReason:void 0}:{isDisabled:!0,disabledReason:"There is no preview available for this version"},[o,s]),u=(0,a.useCallback)(e=>{let{eventName:s}=e;D.ZP.capture(s,{commit_sha:t,disabled:d,disabled_reason:c,is_latest_commit:l,preview_url:o,project_id:n})},[t,c,d,l,o,n]);return{previewUrl:o,isLatestCommit:l,isDisabled:d,disabledReason:c,onPreview:u}},tR=e=>{let{commitSha:t,previewBuildStatus:s}=e,{previewUrl:a,isDisabled:n,onPreview:i}=tP({commitSha:t,previewBuildStatus:s});return(0,r.jsx)(tg.Xi,{asChild:!0,disabled:n,children:(0,r.jsxs)("a",{className:"w-full",href:a,target:"_blank",rel:"noreferrer",onClick:()=>i({eventName:M.SL.ELLIPSIS.PREVIEW_CLICKED}),children:["Preview",(0,r.jsx)(h.Z,{name:"arrow_outward",className:"ml-auto",size:"small"})]})})},tM=e=>{let{editId:t,commitSha:s}=e,{onRevert:a,isDisabled:n}=U({editId:t,commitSha:s});return(0,r.jsxs)(tg.Xi,{className:"w-full",onClick:()=>a&&a({eventName:M.SL.ELLIPSIS.RESTORE_CLICKED}),disabled:n,children:["Restore",(0,r.jsx)(h.Z,{name:"restart_alt",className:"ml-auto",size:"small"})]})},tT=e=>{let{messageId:t,editId:s,costCredits:a,className:n,createdAt:i,senderName:o="Lovable"}=e,d=(0,l.tV)(s);return(0,r.jsxs)(tg.h_,{children:[(0,r.jsx)(tg.$F,{asChild:!0,className:n,children:(0,r.jsx)(y.z,{variant:"ghost",size:"icon-sm",children:(0,r.jsx)(h.Z,{name:"more_horiz",size:"small"})})}),(0,r.jsxs)(tg.AW,{align:"end",children:[(0,r.jsx)(tA,{messageId:t}),(0,r.jsx)(tR,{commitSha:null==d?void 0:d.commit_sha}),(0,r.jsx)(tM,{editId:s,commitSha:null==d?void 0:d.commit_sha}),void 0!==a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tg.VD,{}),(0,r.jsxs)(tg.Xi,{className:"cursor-default justify-between focus:bg-transparent focus:text-foreground",onSelect:e=>e.preventDefault(),children:[(0,r.jsx)("span",{children:"Credits used"}),(0,tx.H)(a)]})]}),(0,r.jsx)(tk,{messageId:t,editId:s})]})]})},tD=e=>e<1e3?"1s":e<6e4?"".concat((e/1e3).toFixed(0),"s"):"".concat(Math.floor(e/6e4),"m ").concat(Math.floor(e%6e4/1e3),"s"),tL=e=>"userCommit"!==e.type&&"userMessage"!==e.type,tz=e=>{let{previousMessageId:t}=e,s=(0,l.aK)(e=>t?e.messages[t]:void 0);return s&&"revertSuccess"!==s.type&&!tL(s)?(0,r.jsx)(tZ,{className:"mb-2"}):null},tO=e=>{let{message:t}=e,s=(0,tm.z)(e=>e.showHistory),a=(0,th.zq)();return s?null:(0,r.jsxs)("div",{className:"mb-3 flex shrink-0 items-center gap-1 text-ellipsis text-nowrap text-muted-foreground md:text-sm",children:[(0,r.jsxs)("div",{className:"flex w-full items-center leading-none",children:[(0,r.jsx)(tZ,{className:"shrink-0 leading-none"}),a&&void 0!==t.thinkingTimeMs&&t.thinkingTimeMs>0&&("completed"===t.status||"stopped"===t.status)&&(0,r.jsxs)("span",{className:"ml-2 mt-px whitespace-nowrap opacity-100 transition-opacity duration-150 ease-out group-hover:opacity-100 md:opacity-0",children:["Worked for ",tD(t.thinkingTimeMs)]}),(0,r.jsxs)(R.u,{children:[(0,r.jsx)(R.aJ,{asChild:!0,children:(0,r.jsx)("span",{className:(0,i.cn)("ml-auto mt-px flex-shrink cursor-default overflow-hidden opacity-100 transition-opacity duration-150 ease-out group-hover:opacity-100 md:opacity-0"),children:(0,tv._g)(t.createdAt)})}),(0,r.jsx)(R._v,{children:t.createdAt.toLocaleString()})]})]}),(0,r.jsx)(tT,{className:"ml-auto",messageId:t.id,editId:t.editId,costCredits:t.costCredits,createdAt:t.createdAt})]})},tZ=e=>{let{className:t}=e;return(0,r.jsxs)("div",{className:(0,i.cn)("flex items-center gap-2 pl-2",t),children:[(0,r.jsx)(tp.xx,{className:(0,i.cn)("mr-1.5 h-3.5 md:mr-1")}),(0,r.jsx)("span",{className:(0,i.cn)("whitespace-nowrap text-lg font-medium md:text-base"),children:"Lovable"})]})};var tF=s(52558),tU=s(7455),tH=s(70335);let tV=e=>{let{message:t}=e,{authUser:s}=(0,tF.Eu)(),a=(0,tU.c)(e=>e.collaborators).find(e=>e.id===t.userId),n=(0,tb.hO)(e=>e.memberships).find(e=>e.user_id===t.userId),i=a||n;if((null==a?void 0:a.id)===(null==s?void 0:s.uid)||(null==n?void 0:n.user_id)===(null==s?void 0:s.uid)||!i)return null;let l=i.display_name===t.userId?i.email:i.display_name;return(0,r.jsxs)("div",{className:"mt-4 flex max-w-full items-center gap-1.5 self-start truncate pl-2 text-sm font-medium",children:[(0,r.jsx)(tH.Y,{user:{id:t.userId||"",username:l||""},className:"h-5 w-5 text-xs"}),(0,r.jsx)(X.default,{className:"min-w-0 truncate hover:underline",href:"/@".concat(i.username),children:l})]})},tW=e=>{let{message:t,previousMessageId:s}=e;switch(t.type){case"userCommit":return null;case"userMessage":return(0,r.jsx)(tV,{message:t});case"branchSwitched":case"revertSuccess":return(0,r.jsx)(tz,{message:t,previousMessageId:s});case"aiMessage":return(0,r.jsx)(tO,{message:t})}};var tK=s(22048),tq=s(96771);let tG=e=>{let{shortCommitHash:t,scrollToEdit:s,newUI:i=!1}=e,{loadMessagesFromId:o}=(0,l.mx)(),{setCodeViewType:c}=(0,S.VK)(),{setActiveMessageId:u,setActiveEditId:m,setShowConsole:p,exitConsole:v}=(0,C.pE)(),g=(0,l.uO)(t),x=(0,C.Sl)(e=>e.consoleContentType),f=(0,C.Sl)(e=>e.activeMessageId),b=(0,l.Fm)(null==g?void 0:g.id),j=f===(null==g?void 0:g.id)&&"code"===x,[y,_]=(0,a.useState)("idle");(0,a.useEffect)(()=>{j&&m(null==g?void 0:g.id)},[j,g,m]);let w=(0,a.useCallback)(()=>{g&&(j?(D.ZP.capture(M.SL.CONSOLE.EXITED_VIA_CARD),v()):(D.ZP.capture(M.SL.CODE_CARD.VIEW_CODE_CLICKED),u(g.id),c(S.es.DIFF),m(g.id),p("code")))},[g,j,v,u,c,m,p]);if(!g)return null;let N=async()=>{_("loading");try{g.type===tq.I.type.DEVELOPER_UPDATE?(await o({messageId:g.id,id_type:"edit_id"}),s({type:"shortCommitHash",value:t})):(await o({messageId:g.id,id_type:"edit_id"}),s({type:"editId",value:g.id})),_("success")}catch(e){eo.Am.error("Could not scroll to edit. Try refreshing the page."),_("error"),n.logging.warn("Firestore error - RevertChipV2 - scroll to edit",{error:e,editId:null==g?void 0:g.id,shortCommitHash:t})}},E="loading"===y;return i?b?"aiMessage"!==b.type?(tK.Tb(Error("RevertChip: message is not an AI message"),{level:"error"}),null):(0,r.jsx)("div",{className:"flex flex-col gap-2 leading-[22px]",style:{overflowWrap:"anywhere"},children:(0,r.jsxs)(d.E.div,{className:"relative mb-6 mt-3 flex w-5/6 max-w-sm",initial:{opacity:1},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:[E&&(0,r.jsx)("div",{className:"absolute inset-0 z-10 flex items-center justify-center rounded-md bg-background/80",children:(0,r.jsx)(h.Z,{className:"animate-spin",name:"progress_activity",size:"small"})}),(0,r.jsx)(eV,{variant:"revert",message:b,edit:g,onClick:w,isActive:j})]})}):null:(0,r.jsxs)("button",{className:"flex items-center disabled:opacity-50",onClick:N,disabled:E,children:[(0,r.jsx)("span",{className:"ml-6 mr-2 text-sm text-muted-foreground",children:"Restored"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 rounded-full border border-muted-border bg-muted px-3 py-1.5 transition-colors hover:bg-muted-hover",children:[(0,r.jsx)("span",{className:"max-w-xs truncate text-sm",title:g.commit_message,"aria-label":g.commit_message,children:g.commit_message}),E&&(0,r.jsx)(h.Z,{className:"ml-1 animate-spin",name:"progress_activity",size:"small"})]})]})},tB=e=>{var t,s,a;let{message:n}=e,o=(0,l.uO)(n.shortCommitHash),c={done:!0,parts:null!==(s=null==o?void 0:null===(t=o.diff)||void 0===t?void 0:t.map(e=>({type:"writing_file",file_path:e.file_path,done:!0,content:e.new_content})))&&void 0!==s?s:[]},u=(0,Z.Y)({editId:null==o?void 0:o.id,commitSha:null==o?void 0:o.commit_sha}),{isActive:m}=eL(o),p=eO({edit:o,messageId:n.id,code:c});return o?(0,r.jsx)(d.E.div,{className:"relative ml-6 flex w-5/6 max-w-xs pb-4",initial:{opacity:1},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:(0,r.jsxs)(eU,{edit:o,message:n,code:c,onClick:p.handleOpenPreview,children:[(0,r.jsx)("div",{className:"flex h-5 items-center",children:(0,r.jsx)(tp.xR.GitHub,{className:"mt-px h-4 w-4 text-foreground"})}),(0,r.jsxs)("div",{className:"flex w-full flex-col gap-1 overflow-hidden text-left",children:[(0,r.jsx)("span",{className:(0,i.cn)("truncate",{"text-foreground":m}),children:null!==(a=o.commit_message)&&void 0!==a?a:"No commit message"}),(0,r.jsx)("span",{className:"truncate font-normal",children:u?"Active Edit":"See Preview"})]}),(0,r.jsx)(h.Z,{name:"chevron_right"})]})}):null};var tY=s(42503),tJ=s(66491);let tX=(0,a.memo)(e=>{var t;let{messageId:s,edit:n,simplified:o=!1}=e,{commit_sha:d}=null!=n?n:{},{setActiveEditId:c}=(0,C.pE)(),u=(0,C.Sl)(e=>e.activeEditId),m=(0,l.aK)(e=>e.edits),p=u?m[u]:null,h=(0,F.iZ)(e=>e.project),{setActiveMessageId:v,setShowConsole:g,setConsolePreviewContent:x,exitConsole:f}=(0,C.pE)(),b=(0,C.Sl)(e=>e.consoleContentType),{toggleBookmark:j}=(0,eZ.g)((null==h?void 0:h.id)||""),_=(0,a.useMemo)(()=>{if(d&&h)return(0,ez.t)({projectId:null==h?void 0:h.id,sha:d})},[d,h]),w=(0,Z.Y)({editId:null==n?void 0:n.id,commitSha:null!==(t=null==n?void 0:n.commit_sha)&&void 0!==t?t:void 0}),N=n&&(null==p?void 0:p.id)===(null==n?void 0:n.id)&&"snapshot-preview"===b||w&&!p&&!b,E=(0,a.useMemo)(()=>{if(!(null==n?void 0:n.created_at))return null;let e=new Date(1e3*n.created_at.seconds);return{relative:(0,tY.l)(e,new Date),absolute:(0,tJ.WU)(e,"MMM d, yyyy, h:mm a")}},[n]),S=(0,a.useCallback)(e=>{var t;if(e.altKey){window.open(_,"_blank");return}if(N||w){f();return}g("snapshot-preview"),v(s),x(_),c(null!==(t=null==n?void 0:n.id)&&void 0!==t?t:void 0)},[n,f,N,w,s,_,c,v,x,g]),k=(0,a.useCallback)(e=>{e.stopPropagation(),(null==n?void 0:n.id)&&j(n.id,!!n.bookmarked)},[n,j]),I=(0,a.useMemo)(()=>{if(n){let{commit_message:e,reverted:t}=null!=n?n:{};return(0,r.jsxs)("div",{className:"flex w-full flex-col gap-1 overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-x-2 gap-y-1",children:[(0,r.jsx)("span",{className:"flex items-center gap-1 truncate",children:e}),(w||t)&&!o&&(0,r.jsx)(t_.C,{className:"border-0 py-0",variant:w?"default":"destructive",children:w?"Current":"Reverted"})]}),(0,r.jsx)("span",{className:"text-sm font-normal text-muted-foreground",children:E?(0,r.jsx)(r.Fragment,{children:E.absolute}):N?"Click to Exit Preview":"Click to Preview"})]})}return(0,r.jsxs)("div",{className:"flex w-full flex-col overflow-hidden",children:[(0,r.jsx)("span",{children:"No preview available"}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"\xa0"})]})},[n,N,w,E,o]);return(0,r.jsxs)(y.z,{onClick:S,disabled:!n,className:(0,i.cn)("mb-2 flex h-auto w-full cursor-pointer items-start gap-2 rounded-lg p-3 text-left text-sm font-medium transition-colors duration-150 ease-in-out","border border-muted-border bg-muted text-foreground","hover:border-border hover:bg-muted-hover",{"border-affirmative-primary bg-affirmative hover:border-affirmative-primary hover:bg-affirmative/80":N},{"hover:cursor-auto hover:bg-affirmative":N&&w}),children:[(0,r.jsx)(eF.Z,{onClick:k,isBookmarked:!!n&&!!n.bookmarked&&(null==n?void 0:n.bookmarked),className:"mt-[3px]"}),I]})});tX.displayName="LegacyPreviewCard";let t$=e=>{var t;let{message:s}=e,a=(0,l.tV)(s.editId);return(null==a?void 0:null===(t=a.diff)||void 0===t?void 0:t.length)?(0,r.jsx)(eq,{code:{done:!0,parts:a.diff.map(e=>({type:"writing_file",file_path:e.file_path,done:!0,content:e.new_content}))},message:s,edit:a}):(0,r.jsx)("div",{className:"relative w-5/6 max-w-xs",children:(0,r.jsx)(tX,{edit:a,messageId:s.id})})};var tQ=s(94949),t0=s(24032);let t1=e=>{let{download:t}=(0,tQ.F)(),[s,r]=(0,a.useState)(void 0),{store:n,cacheImageUrl:i}=(0,l.mx)(),o=n.getState().imageUrlCache,d="".concat(e.dir_name,"/").concat(e.file_name),c=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{c.current||(c.current=!0,(async()=>{if(o[d]){r(o[d]);return}let{url:s}=await t({dir_name:e.dir_name,file_name:e.file_name});r(s),i(d,s)})())},[t,e,d,o,i]),s},t2=e=>{var t;let{images:s,optimistImageUrls:a}=e,n=s.length+(null!==(t=null==a?void 0:a.length)&&void 0!==t?t:0)===1;return(0,r.jsxs)("div",{className:(0,i.cn)("mb-2 ml-auto flex max-w-[240px] flex-wrap justify-end gap-2 md:max-w-[240px]"),children:[null==a?void 0:a.map((e,t)=>(0,r.jsx)(t6,{imageUrl:e,singleImage:n},t)),s.map((e,t)=>(0,r.jsx)(t5,{image:e,singleImage:n},t))]})},t5=e=>{let{image:t,singleImage:s}=e,a=t1(t);return(0,r.jsx)(t6,{imageUrl:a,singleImage:s})},t6=e=>{let{imageUrl:t,singleImage:s}=e,{setSelectedImageUrl:n}=(0,l.mx)(),o=(0,t0.Eh)(e=>e.setImages),d=(0,t0.Eh)(e=>e.images),[c,u]=(0,a.useState)(!1),[m,p]=(0,a.useState)(!1),[v,g]=(0,a.useState)(!1),[x,f]=(0,a.useState)(!1),b=(0,_.Z)("md"),j=(0,a.useCallback)(()=>{t&&n(t)},[t,n]),w=(0,a.useCallback)(async e=>{if(e.stopPropagation(),t&&!c){f(!0),setTimeout(()=>f(!1),500);try{let e=await fetch(t),s=await e.blob();await navigator.clipboard.write([new ClipboardItem({[s.type]:s})]),u(!0),D.ZP.capture(M.SL.CHAT.IMAGE_COPIED,{image_type:s.type,image_size:s.size}),setTimeout(()=>{u(!1)},2e3)}catch(e){(0,eb.Eo)("Failed to copy image")}}},[t,c]),N=(0,a.useCallback)(async e=>{if(e.stopPropagation(),t&&!m){if(d.length>=10){eo.Am.error("Image limit reached",{description:"Please limit your message to ".concat(10," images.")});return}f(!0),setTimeout(()=>f(!1),500),p(!0);try{let e=await fetch(t),s=await e.blob(),r="image-".concat(Date.now(),".").concat(s.type.split("/")[1]||"png"),a=new File([s],r,{type:s.type}),n={url:URL.createObjectURL(a),name:r,uploading:!1,uploaded:!1,id:(0,$.Z)()};o(e=>[...e,n]),g(!0),D.ZP.capture(M.SL.CHAT.IMAGE_ADDED_TO_INPUT,{image_type:s.type,image_size:s.size,current_image_count:d.length+1}),setTimeout(()=>{g(!1)},2e3)}catch(e){(0,eb.Eo)("Failed to add image to chat")}finally{p(!1)}}},[t,m,d.length,o]);return(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(y.z,{variant:"ghost",className:(0,i.cn)("relative inline-block p-0 hover:bg-transparent",{"h-[120px] w-[200px] md:h-[90px] md:w-[160px]":s,"h-24 w-24 md:h-16 md:w-16":!s}),type:"button",disabled:!t,onClick:j,children:t?(0,r.jsxs)("div",{className:"group/image-hover relative h-full w-full",children:[(0,r.jsx)("img",{loading:"lazy",src:t,alt:"chat image",className:"h-full w-full rounded-lg border object-cover"}),!b&&(0,r.jsxs)("div",{className:(0,i.cn)("pointer-events-none absolute inset-0 flex items-center justify-center gap-1 rounded-lg bg-black/50 opacity-0 transition-opacity duration-200",{"group-hover/image-hover:opacity-100":!x,"opacity-100":x}),children:[(0,r.jsx)(y.z,{variant:"secondary",size:"icon-sm",onClick:w,disabled:c,className:"pointer-events-auto h-6 w-6 bg-white/90 text-black hover:bg-white disabled:bg-white/90 disabled:text-black disabled:opacity-100",children:(0,r.jsx)(h.Z,{name:c?"check":"content_copy",className:"h-3 w-3"})}),(0,r.jsx)(y.z,{variant:"secondary",size:"icon-sm",onClick:N,disabled:m||v,className:"pointer-events-auto h-6 w-6 bg-white/90 text-black hover:bg-white disabled:bg-white/90 disabled:text-black disabled:opacity-100",children:(0,r.jsx)(h.Z,{name:v?"check":"add_photo_alternate",className:"h-3 w-3"})})]})]}):(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-lg border bg-background/80",children:(0,r.jsx)(h.Z,{name:"progress_activity",size:"small",className:"animate-spin"})})})})};var t4=s(5635),t7=s(74928);let t3=e=>{let{content:t,open:s,onOpenChange:a,openText:n,closedText:l}=e;return(0,r.jsxs)(t7.z,{open:s,onOpenChange:a,className:"mt-4 max-w-[300px] overflow-hidden rounded-lg border border-muted-border",children:[(0,r.jsx)(t7.w,{asChild:!0,children:(0,r.jsxs)(y.z,{variant:"secondary",className:(0,i.cn)("h-10 w-full justify-between pr-2 text-sm font-medium transition-all duration-200 ease-out",s&&"rounded-b-none"),children:[s?n:l,(0,r.jsx)(h.Z,{name:s?"unfold_less":"unfold_more",size:"small",className:"transition-transform duration-200 ease-out"})]})}),(0,r.jsx)(d.E.div,{initial:{height:0},animate:{height:s?"auto":0},exit:{height:0},transition:{type:"spring",bounce:0,duration:.4},style:{overflow:"hidden"},children:(0,r.jsx)("pre",{className:"rounded-b-md border-t border-muted-border bg-secondary p-4 py-2 text-sm",children:(0,r.jsx)("code",{className:"block max-h-[300px] overflow-x-auto overflow-y-auto whitespace-pre-wrap break-words",children:t})})})]})},t8=e=>{let{messageContent:t}=e,{error:s}=t9(t),[n,i]=(0,a.useState)(!1);return(0,r.jsx)(t3,{content:s,open:n,onOpenChange:i,openText:"Error",closedText:"Error"})};function t9(e){let t=e.match(/([\s\S]+)```([\s\S]+)```\n+$/);return t?{error:t[2].trim(),text:t[1].trim()}:(n.logging.error("no_error_message_found_in_input",{input:e}),{error:"",text:e})}let se=()=>(0,r.jsxs)("div",{className:"w-full rounded-lg border border-muted-border",children:[(0,r.jsxs)("div",{className:"flex h-10 w-full items-center justify-between rounded-b-none px-4 pr-2 text-sm font-medium",children:["Security Review",(0,r.jsx)(h.Z,{name:"security",size:"small"})]}),(0,r.jsx)("div",{className:"rounded-b-md border-t border-muted-border p-4 py-2 text-sm",children:(0,r.jsx)("span",{className:"text-muted-foreground",children:"Analyzing codebase for security vulnerabilities"})})]}),st=e=>{let{content:t}=e,[s,n]=(0,a.useState)(!1);return(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Write the code to create a new integration or update the existing integration with Supabase."}),(0,r.jsx)(t3,{content:t,open:s,onOpenChange:n,openText:"Hide detailed instructions",closedText:"Show detailed instructions"})]})},ss=e=>{let{content:t,selectedElements:s,containsError:a,tags:n,isSecurityReview:i}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)(sn,{selectedElements:s}),i?(0,r.jsx)(se,{}):(0,r.jsx)(si,{content:t,containsError:a}),(0,r.jsx)(sr,{content:t,tags:n})]})},sr=e=>{let{content:t,tags:s}=e;return s.includes("supabase-integration-update")?(0,r.jsx)(st,{content:t}):null},sa=e=>{let{elementType:t}=e,s=(0,t4.a)(t);return s?(0,r.jsx)(h.Z,{name:s,className:"size-4 text-black dark:text-white"}):null},sn=e=>{let{selectedElements:t}=e;return 0===t.length?null:(0,r.jsx)("div",{className:"mb-2 flex flex-wrap gap-2",children:t.map((e,t)=>{var s,a;return(0,r.jsxs)(R.u,{children:[(0,r.jsx)(R.aJ,{asChild:!0,children:(0,r.jsxs)("div",{className:(0,i.cn)((0,y.d)({variant:"outline",size:"sm"}),"flex items-center gap-2 text-xs"),children:[(0,r.jsx)(sa,{elementType:e.elementType}),(0,r.jsx)("span",{children:e.elementType})]})}),(0,r.jsxs)(R._v,{side:"top",children:["Line ",e.lineNumber," in ",null===(a=e.filePath)||void 0===a?void 0:null===(s=a.split)||void 0===s?void 0:s.call(a,"/").pop()]})]},t)})})},si=e=>{let{content:t,containsError:s}=e,{text:n,error:i}=(0,a.useMemo)(()=>s?t9(t):{text:t,error:null},[t,s]);return(0,r.jsxs)(r.Fragment,{children:[n,i&&(0,r.jsx)(t8,{messageContent:t})]})},sl=e=>{let{message:t}=e,{authUser:s}=(0,tF.Eu)(),a=(0,tU.c)(e=>e.collaborators).find(e=>e.id===t.userId),n=(0,tb.hO)(e=>e.memberships).find(e=>e.user_id===t.userId);if(t.content.includes(tt))return null;let l=(null==a?void 0:a.id)===(null==s?void 0:s.uid)||(null==n?void 0:n.user_id)===(null==s?void 0:s.uid);return(0,r.jsxs)("div",{className:(0,i.cn)("flex flex-col",l?"items-end":"items-start pl-8"),children:[(0,r.jsx)(t2,{images:t.images,optimistImageUrls:t.optimistImageUrls}),(0,r.jsx)("div",{className:(0,i.cn)("overflow-wrap-anywhere overflow-auto whitespace-pre-wrap rounded-xl bg-transparent px-0 py-1.5 text-lg leading-[22px] md:text-base",{"max-w-[80%] bg-secondary px-3 py-3":l}),children:(0,r.jsx)(ss,{content:t.content,selectedElements:t.selectedElements,containsError:t.containsError,tags:t.tags,isSecurityReview:t.isSecurityReview})})]})},so=(0,a.memo)(e=>{let{messageId:t,previousMessageId:s,isLastMessage:o=!1,newMessageMinHeight:d,scrollToEdit:c}=e,u=(0,l.aK)(e=>e.messages[t]),m=(0,l.aK)(e=>e.sortedMessageIds).indexOf(t),p=(0,a.useMemo)(()=>(null==u?void 0:u.type)==="aiMessage"&&(1===m||m<2),[u,m]),h=(0,a.useMemo)(()=>{if(!u)return null;switch(u.type){case"userMessage":return(0,r.jsx)(sl,{message:u});case"userCommit":return(0,r.jsx)(tB,{message:u});case"aiMessage":return(0,r.jsx)(tc,{message:u,isFirstAIMessage:p});case"branchSwitched":return(0,r.jsx)(tu,{branchName:u.branchName});case"revertSuccess":return(0,r.jsx)(tG,{shortCommitHash:u.shortCommitHash,scrollToEdit:c});case"manualEdit":var e;return(0,r.jsxs)("div",{className:"ml-6",children:[(0,r.jsx)(t$,{message:u}),u.errors&&(0,r.jsx)(Y,{errors:null!==(e=u.errors)&&void 0!==e?e:null})]});default:return n.logging.error("Unknown message role",{message:u}),null}},[u,p,c]);return u?(0,r.jsxs)("div",{className:(0,i.cn)("group flex flex-col pb-4 pr-2",{"pb-20":o&&"aiMessage"===u.type}),"data-message-id":u.id,"data-message-edit-id":sd(u),style:{minHeight:o&&d?d+"px":"auto"},children:[(0,r.jsx)(tW,{message:u,previousMessageId:s}),(0,r.jsx)("div",{className:(0,i.cn)({"pl-2":"userMessage"!==u.type,"pl-1 md:pl-0":"aiMessage"===u.type}),children:h})]}):null});so.displayName="ChatItem";let sd=e=>{if("aiMessage"===e.type)return e.editId}},19777:function(e,t,s){"use strict";s.d(t,{t:function(){return ez}});var r=s(57437),a=s(46214),n=s(2265),i=s(26438),l=s(74026),o=s(38706),d=s(25658),c=s(55157),u=s(23590),m=s(55721),p=s(57346),h=s(35354),v=s(2043),g=s(49284),x=s(94508),f=s(62380),b=s(41135);let j=e=>{let{onFileUpload:t}=e,s=(0,o.T_)("ChatInputActionMenu"),[i,l]=(0,n.useState)(!1),{isMac:j}=(0,h.Z)(),{openSettings:y}=(0,c.r)(),{canEdit:_}=(0,v.t)(),w=(0,u.G)(),N=(0,d.z)(e=>e.showHistory),{setShowHistory:E}=(0,d.VF)();return(0,r.jsxs)(m.h_,{open:i,onOpenChange:l,children:[(0,r.jsx)(m.$F,{asChild:!0,children:(0,r.jsx)("button",{className:(0,x.cn)("flex size-6 items-center justify-center rounded-full border border-muted-border text-muted-foreground outline-none duration-150 ease-out","shrink-0 transition-colors hover:bg-muted-hover",i&&"bg-muted-active"),children:(0,r.jsx)(p.Z,{name:"add",size:"small",className:(0,x.cn)("transition-transform",i&&"rotate-[135deg]")})})}),(0,r.jsxs)(m.AW,{align:"start",className:"min-w-[240px]",children:[w&&(0,r.jsxs)(m.Xi,{onClick:()=>y("github"),children:[(0,r.jsx)(b.xR.GitHub,{className:"h-4 w-4"}),(0,r.jsx)("p",{children:"GitHub"})]}),(0,r.jsxs)(m.Xi,{onClick:()=>{N||a.ZP.capture(g.SL.TABS.HISTORY_OPENED),E(e=>!e)},children:[(0,r.jsx)(p.Z,{name:"history_2"}),(0,r.jsx)("p",{children:s("history")})]}),_&&(0,r.jsxs)(m.Xi,{onClick:()=>y("knowledge"),children:[(0,r.jsx)(p.Z,{name:"school"}),(0,r.jsx)("p",{children:s("knowledge")})]}),_&&(0,r.jsxs)(m.Xi,{onClick:()=>y("project"),children:[(0,r.jsx)(p.Z,{name:"settings"}),(0,r.jsx)("p",{children:s("projectSettings")}),j?(0,r.jsx)(m.KM,{className:"hidden sm:flex",children:"⌘."}):(0,r.jsx)(m.KM,{className:"hidden sm:flex",children:"Ctrl."})]}),w&&(0,r.jsxs)(m.Xi,{onClick:()=>y("supabase"),children:[(0,r.jsx)(f.Z,{className:"h-4 w-auto",viewBox:"0 0 109 113"}),(0,r.jsx)("p",{children:"Supabase"})]}),(0,r.jsx)(m.VD,{}),(0,r.jsxs)(m.Xi,{onClick:t,children:[(0,r.jsx)(p.Z,{name:"add_photo_alternate"}),(0,r.jsx)("p",{children:s("attach")})]})]})]})};var y=s(93681),_=s(97752),w=s(48614),N=s(1188),E=s(50273),C=s(27410),S=s(5635);let k=e=>{let{elementType:t}=e,s=(0,S.a)(t);return s?(0,r.jsx)(p.Z,{name:s,fill:"white",className:"size-4"}):null},I=(0,n.memo)(()=>{let e=(0,E.UC)(e=>e.selectedElements),{removeSelectedElement:t}=(0,E.S9)(),s=e=>{var t,s;return"Line ".concat(e.lineNumber," in ").concat(null===(s=e.filePath)||void 0===s?void 0:null===(t=s.split)||void 0===t?void 0:t.call(s,"/").pop())},[a,i]=(0,n.useState)(null),l=(0,n.useCallback)(()=>{a&&t(a)},[a,t]);return(null==e?void 0:e.length)?(0,r.jsx)("div",{className:"bg-transparent",children:(0,r.jsx)("ul",{className:"flex flex-wrap gap-2",children:(0,r.jsx)(w.M,{mode:"popLayout",children:e.map(e=>(0,r.jsx)(N.E.li,{initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.6,transition:{duration:.15}},transition:{duration:.1,ease:[.5,1,.89,1],opacity:{duration:.1}},layoutId:"".concat(e.filePath,"-").concat(e.lineNumber),children:(0,r.jsx)(C.Z,{label:s(e),side:"top",children:(0,r.jsxs)("button",{className:"flex h-full w-full cursor-pointer items-center gap-0.5 rounded-md p-1 pr-2 hover:bg-background",onMouseEnter:()=>i(e),onMouseLeave:()=>i(null),onClick:l,children:[(0,r.jsx)(w.M,{mode:"wait",children:(0,r.jsx)(N.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex-shrink-0",children:a!==e?(0,r.jsx)(k,{elementType:e.elementType}):(0,r.jsx)(p.Z,{name:"close",size:"small"})},a===e?"close":"element")}),(0,r.jsx)("span",{className:"flex-grow select-none truncate text-left text-xs",children:"".concat(e.elementType)})]})})},"".concat(e.filePath,"-").concat(e.lineNumber)))})})}):null});I.displayName="ChatInputSelectElementsRow",(0,n.memo)(e=>{var t,s;let{element:a,onRemoveElement:i}=e,[l,o]=(0,n.useState)(!1);return(0,r.jsx)(C.Z,{label:"Line ".concat(a.lineNumber," in ").concat(null===(s=a.filePath)||void 0===s?void 0:null===(t=s.split)||void 0===t?void 0:t.call(s,"/").pop()),side:"top",children:(0,r.jsxs)("button",{onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),className:"group/select-element flex h-full w-full cursor-pointer items-center gap-0.5 rounded-md p-1 pr-2 hover:bg-background",onClick:()=>i(a),children:[(0,r.jsx)(w.M,{mode:"wait",children:(0,r.jsx)(N.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex-shrink-0",children:l?(0,r.jsx)(p.Z,{name:"close",size:"small"}):(0,r.jsx)(k,{elementType:a.elementType})},l?"close":"element")}),(0,r.jsx)("span",{className:"flex-grow select-none truncate text-left text-xs",children:"".concat(a.elementType)})]})})}).displayName="ChatInputSelectElement";var A=s(71830),P=s(61160),R=s(74746),M=s(90045),T=s(62869),D=s(57054),L=s(81103);let z="chat-mode-nudge-last-shown",O=()=>{try{let e=localStorage.getItem(z);if(!e)return!0;let t=parseInt(e,10);return Date.now()-t>=12096e5}catch(e){return!0}},Z=()=>{try{localStorage.setItem(z,Date.now().toString())}catch(e){}},F=e=>{let{projectId:t}=e,s=(0,o.T_)("ChatModeToggle"),{isAgentModeDefault:l}=(0,i.v)(),d=(0,M.hT)(e=>e.chatMode===M.jE.CHAT_ONLY),{setChatMode:c}=(0,M.VK)(),u=(0,R.iY)(),[m,h]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{h(!!(null==u?void 0:u.isStuck)&&!d&&!(null==u?void 0:u.chatOnly)&&O())},[u,d]),(0,r.jsxs)(D.J2,{open:m,children:[(0,r.jsx)(D.xo,{asChild:!0,children:(0,r.jsx)("div",{children:(0,r.jsxs)(L.u,{children:[(0,r.jsx)(L.aJ,{asChild:!0,children:(0,r.jsxs)(T.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{a.ZP.capture("chat_mode_toggled",{state:d,project_id:t,stuck_popover_shown:m}),h(!1),m&&Z(),d&&Z(),c(d?l?M.jE.AGENT:M.jE.DEFAULT:M.jE.CHAT_ONLY)},className:(0,x.cn)("flex h-6 gap-1 rounded-full border py-0 pl-1.5 pr-2.5 font-normal text-muted-foreground hover:border-border hover:bg-transparent md:hover:bg-accent md:hover:text-muted-foreground",{"border-affirmative-primary bg-affirmative-primary text-affirmative-primary-foreground hover:border-affirmative-primary hover:bg-affirmative-primary hover:text-affirmative-primary-foreground md:hover:bg-affirmative-primary/90 md:hover:text-affirmative-primary-foreground":d}),children:[(0,r.jsx)(p.Z,{name:"emoji_objects",size:"small"}),s("chat")]})}),(0,r.jsx)(L._v,{className:"hidden max-w-[35ch] md:flex",children:(0,r.jsx)("p",{children:s("chatTooltip")})})]})})}),(0,r.jsxs)(D.yk,{children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)("p",{className:"font-medium text-popover-foreground",children:s("feelingStuck")}),(0,r.jsx)(p.Z,{name:"close",className:"cursor-pointer text-muted-foreground",onClick:()=>{h(!1),c(M.jE.DEFAULT),Z(),a.ZP.capture("stuck_popover_dismissed",{project_id:t,message_id:null==u?void 0:u.id})}})]}),(0,r.jsx)("p",{className:"text-muted-foreground",children:s("useChatMode")})]})]})};var U=s(29991),H=s(33145),V=s(27648),W=s(3813),K=s(5073);let q="legacy-mode-nudge-last-shown",G=[{icon:"code",title:"Smarter Code Edits",description:"90% fewer errors and improved generations."},{icon:"devices",title:"New Capabilities",description:"Web search, image generation and more"},{icon:"trending_up",title:"Adaptive Pricing",description:"Pay based on actions, not messages."}],B=()=>{try{let e=localStorage.getItem(q);if(!e)return!0;let t=parseInt(e,10);return Date.now()-t>=864e5}catch(e){return!0}},Y=()=>{try{localStorage.setItem(q,Date.now().toString())}catch(e){}},J=e=>{let{projectId:t}=e,s=(0,W.zq)(),{agentModeEnabled:l,setAgentMode:o}=(0,i.v)(),d=(0,M.hT)(e=>e.chatMode)===M.jE.CHAT_ONLY,[c,u]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{u(!l&&B())},[l]),s&&!d&&c)?(0,r.jsx)("div",{className:"relative flex w-full flex-col rounded-t-3xl border border-b-0 border-muted-border bg-background",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2 pb-6 pl-4 pr-2 pt-2",children:[(0,r.jsxs)(K.zs,{children:[(0,r.jsxs)(K.Yi,{className:"flex cursor-pointer items-center gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-normal text-foreground",children:"Agent mode produces 90% less errors"}),(0,r.jsx)(p.Z,{name:"info",size:"small",className:"text-muted-foreground"})]}),(0,r.jsxs)(K.bZ,{className:"ml-2 flex w-[560px] max-w-[60vw] gap-0 rounded-2xl p-0",side:"top",sideOffset:20,children:[(0,r.jsx)("div",{className:"relative m-3 hidden w-1/3 md:block",children:(0,r.jsx)(H.default,{src:"/img/announcements/agent-release.png",alt:"Meet Agent Mode",fill:!0,className:"rounded-lg object-cover"})}),(0,r.jsxs)("div",{className:"flex w-2/3 flex-1 flex-col gap-3 p-4 pl-2",children:[(0,r.jsx)("p",{className:"w-full text-2xl font-medium text-card-foreground",children:"Meet Agent Mode"}),(0,r.jsx)("p",{className:"w-full text-base text-muted-foreground",children:"Here is what's new:"}),(0,r.jsx)("div",{className:"flex flex-col gap-4",children:G.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"mt-0.5 flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-secondary",children:(0,r.jsx)(p.Z,{name:e.icon,size:"small",className:"text-secondary-foreground"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium leading-tight text-card-foreground",children:e.title}),(0,r.jsx)("p",{className:"text-sm leading-tight text-muted-foreground",children:e.description})]})]},e.title))}),(0,r.jsx)(T.z,{variant:"secondary",size:"sm",asChild:!0,className:"ml-auto mt-3 w-fit",children:(0,r.jsxs)(V.default,{href:"https://lovable.dev/blog/agent-mode-beta",target:"_blank",rel:"noopener noreferrer",children:["Read more ",(0,r.jsx)(p.Z,{name:"arrow_outward",size:"small"})]})})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(T.z,{onClick:()=>{o(!0),u(!1),Y(),a.ZP.capture("legacy_mode_nudge_activated",{project_id:t})},size:"sm",variant:"affirmative",children:"Try Now"}),(0,r.jsx)("button",{type:"button",className:"group flex h-7 w-7 items-center justify-center hover:bg-transparent",onClick:()=>{u(!1),Y(),a.ZP.capture("legacy_mode_nudge_dismissed",{project_id:t})},children:(0,r.jsx)(p.Z,{name:"close",size:"small",className:"text-muted-foreground"})})]})]})}):null};var X=s(27466),$=s(96279),Q=s(65666);let ee=e=>{let{className:t,disabled:s=!1,isSendingDisabled:a=!1}=e,i=(0,Q.v)(),{showStopAction:l,mutation:o}=(0,$.q)({projectId:null!=i?i:void 0}),d=(0,n.useCallback)(async()=>{await o.mutateAsync()},[o]);return i&&(l||o.isPending)?(0,r.jsx)("button",{type:"button",className:(0,x.cn)("flex size-6 items-center justify-center rounded-full bg-foreground text-background transition-opacity duration-150 ease-out disabled:cursor-not-allowed disabled:opacity-50",t),disabled:o.isPending,onClick:d,children:(0,r.jsx)(p.Z,{name:"stop_fill",size:"small"})}):(0,r.jsx)("button",{id:"chatinput-send-message-button",type:"submit",className:(0,x.cn)("flex size-6 items-center justify-center rounded-full bg-foreground text-background transition-opacity duration-150 ease-out disabled:cursor-not-allowed disabled:opacity-50",t),disabled:a||s,children:(0,r.jsx)(p.Z,{name:"arrow_upward_alt_600",size:"default"})})};var et=s(58292),es=s(77113),er=s(35974),ea=s(78276),en=s(9144);let ei="supabase-security-nudge-last-shown",el=()=>{try{let e=localStorage.getItem(ei);if(!e)return!0;let t=parseInt(e,10);return Date.now()-t>=864e5}catch(e){return!0}},eo=()=>{try{localStorage.setItem(ei,Date.now().toString())}catch(e){}},ed=e=>{var t,s,i,l,o;let{projectId:d}=e,c=(0,es.iZ)(e=>e.project),[u,m]=(0,n.useState)(!1),h=!!(null==c?void 0:null===(t=c.supabase_project_config)||void 0===t?void 0:t.supabase_project_id),{securityWarnings:v,isLoadingWarnings:g,hasSupabaseErrors:x,handleSecurityReview:f,isSendingSecurityReview:b,isSecurityReviewDisabled:j,securityReviewDisabledReason:y}=(0,et.N)({projectId:null==c?void 0:c.id,supabaseProjectId:null==c?void 0:null===(s=c.supabase_project_config)||void 0===s?void 0:s.supabase_project_id,setShowPublishConfirmDialog:e=>{},shouldFetchSecurityWarnings:h});(0,n.useEffect)(()=>{m(h&&!0===x&&!g&&el())},[h,x,g]);let _=()=>{var e,t;f(),m(!1),a.ZP.capture("supabase_security_nudge_reviewed",{project_id:d,error_count:(null==v?void 0:null===(e=v.supabase)||void 0===e?void 0:e.errors)||0,warning_count:(null==v?void 0:null===(t=v.supabase)||void 0===t?void 0:t.warnings)||0})};if(!u)return null;let w=(null==v?void 0:null===(i=v.supabase)||void 0===i?void 0:i.errors)||0,N=(null==v?void 0:null===(l=v.supabase)||void 0===l?void 0:l.warnings)||0,E=(null==v?void 0:null===(o=v.supabase)||void 0===o?void 0:o.details)||[],C=E.filter(e=>"ERROR"===e.level),S=E.filter(e=>"WARN"===e.level),k=x?C:S,I=x?"".concat(w," Error").concat(w>1?"s":""):"".concat(N," Warning").concat(N>1?"s":"");return(0,r.jsx)("div",{className:"relative flex w-full flex-col rounded-t-3xl border border-b-0 border-muted-border bg-background",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2 pb-6 pl-4 pr-2 pt-2",children:[(0,r.jsxs)(K.zs,{children:[(0,r.jsxs)(K.Yi,{className:"flex cursor-pointer items-center gap-2",children:[(0,r.jsx)(p.Z,{name:"error",size:"small"}),(0,r.jsx)("span",{className:"text-sm font-normal text-foreground",children:"Supabase security"}),(0,r.jsx)(er.C,{variant:x?"destructive":"warning",className:"flex-shrink-0 gap-1",children:I})]}),(0,r.jsx)(K.bZ,{className:"ml-2 flex w-[400px] max-w-[70vw] gap-0 rounded-2xl border-muted-border p-0",side:"top",sideOffset:20,children:(0,r.jsxs)("div",{className:"flex w-full flex-col gap-4 p-4",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("p",{className:"w-full text-xl font-medium text-card-foreground",children:[w+N," Security Issues Detected"]}),(0,r.jsxs)("p",{className:"w-full text-base text-muted-foreground",children:[x?"Critical errors":"Warnings"," found in your Supabase project:"]})]}),(0,r.jsxs)("div",{className:"max-h-64 overflow-y-auto",children:[k.slice(0,3).map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between py-1.5",children:[(0,r.jsxs)(L.u,{children:[(0,r.jsx)(L.aJ,{asChild:!0,children:(0,r.jsxs)("div",{className:"flex cursor-default items-center gap-1.5",children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:e.title}),(0,r.jsx)(p.Z,{name:"info",size:"small",className:"text-muted-foreground"})]})}),(0,r.jsx)(L._v,{children:(0,r.jsx)("p",{children:e.description})})]}),(0,r.jsx)(er.C,{variant:"ERROR"===e.level?"destructive":"warning",children:"ERROR"===e.level?"Error":"Warning"})]},e.name)),k.length>3&&(0,r.jsxs)("p",{className:"py-1.5 text-sm font-medium text-muted-foreground",children:["+ ",k.length-3," more"," ",x?"error":"warning",k.length-3>1?"s":"","..."]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsxs)(T.z,{variant:"secondary",size:"sm",onClick:()=>{var e,t,s;let r=null==c?void 0:null===(e=c.supabase_project_config)||void 0===e?void 0:e.supabase_project_id;r&&window.open("".concat("https://supabase.com/dashboard/project/".concat(r,"/advisors/security")).concat(x?"":"?preset=WARN&id="),"_blank"),a.ZP.capture("supabase_security_nudge_external_view",{project_id:d,error_count:(null==v?void 0:null===(t=v.supabase)||void 0===t?void 0:t.errors)||0,warning_count:(null==v?void 0:null===(s=v.supabase)||void 0===s?void 0:s.warnings)||0})},className:"gap-1.5",children:["View in Supabase",(0,r.jsx)(p.Z,{name:"arrow_outward",size:"small"})]}),(0,r.jsx)(ea.b,{showTooltip:!!y,tooltipContent:y,children:(0,r.jsx)(T.z,{variant:"affirmative",size:"sm",onClick:_,disabled:j,loading:b,className:"gap-1.5",children:"Security Review"})})]})]})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(ea.b,{showTooltip:!!y,tooltipContent:y,children:(0,r.jsxs)(T.z,{onClick:_,size:"sm",variant:"affirmative",disabled:j,loading:b,className:"gap-1",children:["Review Now",(0,r.jsx)(en.L,{})]})}),(0,r.jsx)("button",{type:"button",className:"group flex h-7 w-7 items-center justify-center hover:bg-transparent",onClick:()=>{var e,t;m(!1),eo(),a.ZP.capture("supabase_security_nudge_dismissed",{project_id:d,error_count:(null==v?void 0:null===(e=v.supabase)||void 0===e?void 0:e.errors)||0,warning_count:(null==v?void 0:null===(t=v.supabase)||void 0===t?void 0:t.warnings)||0})},children:(0,r.jsx)(p.Z,{name:"close",size:"small",className:"text-muted-foreground"})})]})]})})};var ec=s(27132),eu=s(16054),em=function(){let e=navigator.userAgent.toLowerCase();return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e)},ep=s(6273),eh=s(60256);let ev=new ep.XMLParser({ignoreAttributes:!1,preserveOrder:!0,trimValues:!0}),eg=()=>{let[e,t]=(0,n.useState)([]),[s,r]=(0,n.useState)(!1),a=(0,n.useRef)(void 0),i=(0,n.useRef)(void 0),{userData:l}=(0,eh.SE)(),o=(0,R.$m)(),d=null==o?void 0:o.messageId,c=null==o?void 0:o.message,u=(0,n.useCallback)(e=>{let t="<lov-actions>",s=e.indexOf(t),r=e.indexOf("</lov-actions>",s);if(-1===s||-1===r)return[];let a=e.substring(s+t.length,r);try{let e=ev.parse(a),t=[];return Array.isArray(e)&&e.forEach(e=>{if(e["lov-suggestion"]){var s,r;let a=e["lov-suggestion"],n=null===(s=e[":@"])||void 0===s?void 0:s["@_message"],i=Array.isArray(a)?null===(r=a[0])||void 0===r?void 0:r["#text"]:null==a?void 0:a["#text"];n&&i&&t.push({title:i.trim(),message:n.trim()})}}),t}catch(e){return console.error("Error parsing lov-actions XML:",e),[]}},[]),m=(0,n.useMemo)(()=>c&&"aiMessage"===c.type?u(c.content):[],[c,u]),p=m.length>0;return(0,n.useEffect)(()=>{d&&d!==a.current&&(a.current=d,r(!1),i.current=void 0)},[d]),(0,n.useEffect)(()=>{let e=(null==l?void 0:l.suggestions_enabled)===!0;if(!e){r(!1);return}p&&c&&d&&d!==i.current&&c.persisted&&e&&(t(m),r(!0),i.current=d)},[p,d,c,m,null==l?void 0:l.suggestions_enabled]),{suggestions:e,isVisible:s,hideSuggestions:(0,n.useCallback)(()=>{r(!1)},[])}};var ex=s(63420),ef=s(6809),eb=s(57492),ej=s(24032);let ey=e=>{let{projectId:t}=e,{store:s}=(0,ej.WR)(),a=s(e=>e.message),[i,l]=(0,n.useState)([]),[o,d]=(0,n.useState)(!1),{openSettings:u}=(0,c.r)(),m=(0,ef.N)(),h=!!m;return((0,n.useEffect)(()=>{if(a){let e=(0,eb.s)(a);l(e),e.length>0&&d(!1)}else l([])},[a]),0===i.length||o)?null:(0,r.jsx)("div",{className:"relative flex w-full flex-col rounded-t-lg border border-b-0 border-orange-500/50 bg-orange-500/10",children:(0,r.jsxs)("div",{className:"flex items-start justify-between gap-2 py-2 pb-4 pl-3 pr-2",children:[(0,r.jsxs)("div",{className:"flex flex-1 items-start gap-2",children:[(0,r.jsx)(p.Z,{name:"info",className:"mt-0.5 text-base text-orange-500","aria-label":"Warning"}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Sensitive API key detected"}),(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:[h?"API keys detected. Ask Lovable to store these as secrets instead of pasting them in messages.":"API keys detected in your message. Connect Supabase first, then ask Lovable to store them securely instead.",(0,r.jsxs)("div",{className:"my-2",children:[!h&&(0,r.jsxs)(T.z,{variant:"outline",size:"sm",onClick:()=>{u("supabase")},children:[(0,r.jsx)(b.xR.Supabase,{className:"h-4 w-4"}),"Connect Supabase"]}),m&&(0,r.jsx)(T.z,{variant:"outline",size:"sm",asChild:!0,children:(0,r.jsxs)("a",{href:"https://supabase.com/dashboard/project/".concat(m.id,"/settings/functions"),target:"_blank",rel:"noreferrer",children:[(0,r.jsx)(p.Z,{name:"key",className:"h-4 w-4 text-xs"}),(0,r.jsx)("span",{className:"text-xs",children:"Manage Secrets"}),(0,r.jsx)(p.Z,{name:"arrow_outward",className:"h-4 w-4 text-xs text-muted-foreground"})]})}),(0,r.jsx)(T.z,{variant:"link",size:"sm",asChild:!0,children:(0,r.jsxs)("a",{href:"https://docs.lovable.dev/features/security",target:"_blank",rel:"noreferrer",children:[(0,r.jsx)(p.Z,{name:"help",className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Learn more about security"}),(0,r.jsx)(p.Z,{name:"arrow_outward",className:"h-4 w-4 text-muted-foreground"})]})})]})]})]})]}),(0,r.jsx)("button",{type:"button",className:"group flex h-7 w-7 items-center justify-center hover:bg-transparent",onClick:()=>{d(!0)},children:(0,r.jsx)(p.Z,{name:"close",className:"h-3 w-3 text-muted-foreground group-hover:opacity-50"})})]})})};var e_=s(72380),ew=s(71759),eN=s(32129),eE=s(30438),eC=s(59053),eS=s(79358),ek=s(47902);let eI=()=>{var e;let{userData:t}=(0,eh.SE)(),{dailyCreditLimit:s,dailyCreditsUsed:i,bonusCredits:l}=(0,eC.O)(),o=(0,ew.hO)(e=>e.projectWorkspace),[d,c]=(0,n.useState)(!0),u=(0,e_.v)(),m=(0,eE.c)(),h=null==t?void 0:null===(e=t.tips)||void 0===e?void 0:e.upgrade_dialog_dismissed_at,v=(null!=s?s:0)-(null!=i?i:0)+(null!=l?l:0);return((0,n.useEffect)(()=>{h&&!(0,ek.ZK)(h)&&c(!1)},[h]),m&&(null==o?void 0:o.plan)==="free"&&!(v>2)&&d)?(0,r.jsx)("div",{className:"relative flex w-full flex-col rounded-t-3xl border border-b-0 border-muted-border bg-background",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2 pb-6 pl-4 pr-2 pt-2",children:[(0,r.jsx)("div",{className:"flex items-center gap-1",children:(0,r.jsxs)("span",{className:"text-sm font-normal text-foreground",children:[(0,eS.H)(v)," free ",1===v?"credit":"credits"," ","remaining today"]})}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(eN.Z,{plan:null==o?void 0:o.plan,onClick:()=>{a.ZP.capture(g.VL.UPGRADE.BUTTON_CLICKED.CHAT,{context:g.VL.UPGRADE.CONTEXT.OUT_OF_CREDITS,remaining_credits:v})},children:"Upgrade Now"}),(0,r.jsx)("button",{type:"button",className:"group flex h-7 w-7 items-center justify-center hover:bg-transparent",onClick:()=>{u.mutate({upgrade_dialog_dismissed_at:new Date().toISOString()}),c(!1)},children:(0,r.jsx)(p.Z,{name:"close",size:"small",className:"text-muted-foreground"})})]})]})}):null};var eA=s(87751);let eP=e=>{let{suggestions:t,isVisible:s=!0}=e,{store:a}=(0,ej.WR)(),i=a(e=>e.setMessage),l=e=>{i(e.message)},[o,d]=(0,n.useState)(!0),[c,u]=(0,n.useState)(!1),m=(0,n.useRef)(null);return((0,n.useEffect)(()=>{let e=m.current;if(!e||!s){d(!0),u(!1);return}e.scrollLeft=0;let t=()=>{d(0===e.scrollLeft),u(e.scrollLeft+e.clientWidth>=e.scrollWidth-1)};return t(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[t,s]),s&&t.length)?(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"relative w-full rounded-t-lg bg-background py-2 pb-2",children:[(0,r.jsx)("div",{ref:m,className:"flex w-full flex-nowrap gap-2 overflow-x-auto px-3 pb-1 scrollbar-hide",children:t.map(e=>(0,r.jsx)(T.z,{className:"h-7 whitespace-nowrap rounded-lg bg-muted px-3 text-sm font-normal text-foreground hover:bg-muted/80 focus:outline-none",type:"button",onClick:()=>l(e),children:e.title},e.message))}),!c&&(0,r.jsx)("div",{className:"pointer-events-none absolute right-0 top-0 h-full w-24 bg-gradient-to-l from-background to-background/0"}),!o&&(0,r.jsx)("div",{className:"pointer-events-none absolute left-0 top-0 h-full w-24 bg-gradient-to-r from-background to-background/0"})]})}):null};var eR=s(21399),eM=s(44481),eT=s(50126),eD=s(29328);let eL=()=>{let e=(0,Q.v)(),t=(0,E.UC)(e=>e.isVisualEditingActive),{setIsVisualEditorPanelOpen:s,turnOffVisualEditing:n}=(0,E.S9)(),{startLiveMode:i}=(0,eD.My)(),{hasUnsavedChanges:l}=(0,ex.v)(),o=(0,eT.Sl)(e=>e.activeView),d=()=>{n(),a.LJ.capture("visual_editor_toggled",{state:!t,project_id:e})},c=()=>{s(!0),i(),a.LJ.capture("visual_editor_toggled",{state:t,project_id:e})},u=()=>{t?d():c()},m=t&&l,v="dev-mode"===o,{isMac:g}=(0,h.Z)(),f=m||v&&!t;return(0,eM.y1)("alt+s",e=>{e.preventDefault(),f||u()},{enableOnFormTags:!0},[f,u]),(0,r.jsxs)(L.u,{instant:m,children:[(0,r.jsx)(L.aJ,{className:"flex py-0",type:"button",asChild:!0,children:(0,r.jsxs)(T.z,{id:"visual-editor-toggle",type:"button",variant:"outline",size:"sm",onClick:u,disabled:f,className:(0,x.cn)("flex h-6 gap-1 rounded-full border py-0 pl-1.5 pr-2.5 font-normal text-muted-foreground hover:border-border hover:bg-transparent md:hover:bg-accent md:hover:text-muted-foreground",{"border-affirmative-primary bg-affirmative-primary text-affirmative-primary-foreground hover:border-affirmative-primary hover:bg-affirmative-primary hover:text-affirmative-primary-foreground md:hover:bg-affirmative-primary/90 md:hover:text-affirmative-primary-foreground":t}),children:[(0,r.jsx)(p.Z,{name:"visual_edits",size:"small"}),"Edit"]})}),(0,r.jsx)(L._v,{children:(0,r.jsx)("p",{children:v&&!t?"Exit code mode to use visual editor":m?"Save or discard to exit":"Select to edit (".concat(g?"⌥S":"Alt+S",")")})})]})},ez=e=>{let{chatPanelRef:t,children:s}=e,a=(0,d.z)(e=>e.showHistory);return(0,ec.Z)("md")?s:a?null:(0,r.jsx)(eZ,{chatPanelRef:t})},eO=e=>e.charAt(0).toUpperCase()+e.slice(1),eZ=(0,n.memo)(e=>{let{chatPanelRef:t}=e,s=(0,W.zq)(),o=(0,W.Zp)(),d=(0,W.aI)(),{isAgentModeDefault:c}=(0,i.v)(),{setSelectedImageUrl:u}=(0,R.mx)(),{hasUnsavedChanges:m}=(0,ex.v)(),p=(0,Q.v)(),h=(0,E.UC)(e=>e.isVisualEditingActive),{setChatMode:v}=(0,M.VK)(),{message:x,sendChatMessage:f,isSendingDisabled:b,AuthDialogComponent:w}=(0,eR.i)(),{dropzoneElement:N,openFileUpload:C,getInputProps:S}=(0,eu.j)({portalTargetRef:t}),k=h&&m,T=(0,E.UC)(e=>{var t;return null===(t=e.selectedElements)||void 0===t?void 0:t[0]}),D=em(),[z,O]=(0,n.useState)(!1),{suggestions:Z,isVisible:H,hideSuggestions:V}=eg(),K=(0,n.useCallback)(async()=>{if(V(),(0,eb.G)(x)){a.ZP.capture(g.SL.CHAT.API_KEY_DETECTED,{project_id:p}),O(!0);return}await f()},[p,f,x,V]);return(0,r.jsxs)("div",{className:"flex max-h-[calc(100%-37px)] shrink-0 flex-col overflow-visible",children:[(0,r.jsx)(eA.s,{isOpen:z,onDismiss:()=>O(!1),onConfirm:()=>{O(!1),f(),a.ZP.capture(g.SL.CHAT.API_KEY_WARNING_DISMISSED,{project_id:p})}}),d&&(0,r.jsx)(eP,{suggestions:Z,isVisible:H}),(0,r.jsx)("div",{className:"relative top-4 space-y-4",children:!D&&(0,r.jsxs)(r.Fragment,{children:[p&&(0,r.jsx)(ey,{projectId:p}),(0,r.jsx)(eI,{}),p&&(0,r.jsx)(ed,{projectId:p}),p&&s&&(0,r.jsx)(J,{projectId:p})]})}),(0,r.jsxs)(l.x,{className:"relative mr-2 md:mr-0",onSubmit:K,AuthDialogComponent:w,children:[(0,r.jsx)(_.T,{setSelectedImageUrl:u}),!h&&(0,r.jsx)(I,{}),(0,r.jsxs)(L.u,{children:[(0,r.jsx)(L.aJ,{asChild:!0,children:(0,r.jsx)("div",{children:(0,r.jsx)(A.E,{autoSize:!0,minHeight:40,className:"m-1 rounded-md p-0",disabled:k,forceShowPlaceholder:!1,placeholder:T?"Ask Lovable to modify ".concat(eO(T.elementType),"..."):"Ask Lovable...",enableSlashCommands:!1,isChatModeActive:!1,onEnableChatMode:()=>v(M.jE.CHAT_ONLY),onDisableChatMode:()=>v(c?M.jE.AGENT:M.jE.DEFAULT)})})}),(0,r.jsx)(L._v,{hidden:!h||!m,children:(0,r.jsx)("p",{children:"Save to continue"})})]}),(0,r.jsx)(P.yo,{}),(0,r.jsxs)(y.s,{children:[(0,r.jsx)("input",{id:"file-upload",className:"hidden",...S()}),N,(0,r.jsx)(j,{onFileUpload:C}),!D&&(0,r.jsx)(eL,{}),(0,r.jsxs)("div",{className:"ml-auto flex items-center gap-1",children:[p&&(0,r.jsx)(F,{projectId:p}),(0,r.jsxs)("div",{className:"ml-1 flex items-center gap-2",children:[(0,r.jsx)(U.r,{}),o&&p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(X.O,{projectId:p}),(0,r.jsx)(ee,{disabled:k,isSendingDisabled:b})]}):(0,r.jsx)(ee,{disabled:k,isSendingDisabled:b})]})]})]})]}),(0,r.jsx)("div",{className:"z-10 h-2 w-full bg-background"})]})});eZ.displayName="ChatInputV2NormalContent"},66431:function(e,t,s){"use strict";s.d(t,{A:function(){return p}});var r=s(57437),a=s(27648),n=s(2265),i=s(62869),l=s(78276),o=s(26110),d=s(57346),c=s(26237),u=s(79396),m=s(37675);let p=()=>{let e=(0,c.C)(),{mutate:t,isPending:s}=(0,u.I)({skipSafetyCheck:!0}),p=(0,m.bk)(e=>e.editIdToConfirmRestoreFor),{setEditIdToConfirmRestoreFor:h}=(0,m.Xr)(),{disabled:v,disabledReason:g}=(0,n.useMemo)(()=>s?{disabled:!0,disabledReason:"Restore is in progress"}:e?{disabled:!0,disabledReason:(0,r.jsx)("p",{className:"max-w-sm",children:"Cannot transfer project while there is an active operation in progress (e.g. chat or revert). Please wait for the operation to complete.,"})}:{disabled:!1,disabledReason:null},[e,s]);return(0,r.jsx)(o.Vq,{open:!!p,onOpenChange:e=>!e&&h(void 0),children:(0,r.jsxs)(o.cZ,{children:[(0,r.jsx)(o.fK,{children:(0,r.jsx)(o.$N,{children:"Can’t revert database changes"})}),(0,r.jsx)(o.Be,{children:"The database was modified since this version. Lovable can’t revert database changes automatically. You’ll need to update the database manually."}),(0,r.jsxs)(o.cN,{children:[(0,r.jsx)(i.z,{variant:"outline",children:(0,r.jsxs)(a.default,{href:"https://docs.lovable.dev/integrations/supabase",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 overflow-hidden text-ellipsis whitespace-nowrap",children:[(0,r.jsx)("span",{className:"truncate",children:"Learn more"}),(0,r.jsx)(d.Z,{name:"arrow_outward"})]})}),(0,r.jsx)(l.b,{showTooltip:v,tooltipContent:g,children:(0,r.jsx)(o.GG,{asChild:!0,children:(0,r.jsxs)(i.z,{variant:"affirmative",onClick:()=>t({edit:{id:p}}),disabled:v,children:["Proceed Anyway",s&&(0,r.jsx)(d.Z,{className:"ml-1 animate-spin",name:"progress_activity",size:"small"})]})})})]})]})})}},87418:function(e,t,s){"use strict";s.d(t,{W:function(){return a}});var r=s(2265);let a=e=>{let{listRef:t,containerRef:s}=e,[a,n]=(0,r.useState)(!1),[i,l]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),c=(0,r.useCallback)(()=>setTimeout(()=>{if(!t.current)return;let e=t.current.scrollSize-t.current.viewportSize-t.current.scrollOffset<84,s=t.current.scrollOffset<84,r=t.current.scrollSize>t.current.viewportSize;l(e),d(s),n(r)},0),[t]),u=(0,r.useCallback)(()=>{t.current&&t.current.scrollTo(t.current.scrollSize)},[t]);return(0,r.useEffect)(()=>{let e=s.current;if(!e)return;let t=new MutationObserver(c);t.observe(e,{childList:!0,subtree:!0});let r=new ResizeObserver(c);return r.observe(e),c(),()=>{t.disconnect(),r.disconnect()}},[s,c]),{isScrollable:a,isScrolledToEnd:i,isScrolledToStart:o,checkScrollPosition:c,scrollToEnd:u}}},21399:function(e,t,s){"use strict";s.d(t,{i:function(){return f}});var r=s(57437),a=s(2265),n=s(26438),i=s(52558),l=s(10867),o=s(90045),d=s(52055),c=s(84350),u=s(61160),m=s(24032),p=s(95033),h=s(29328),v=s(77113),g=s(50273),x=s(47902);let f=()=>{let{closeVisualEditsPanel:e}=(0,g.S9)(),{agentModeEnabled:t}=(0,n.v)(),{sendChatMessage:s,hasActiveLock:f}=(0,c.O)(),{clearEditorState:b,restoreEditorState:j}=(0,m.WR)(),y=(0,v.iZ)(e=>e.project),{authUser:_}=(0,i.Eu)(),[w,N]=(0,a.useState)(!1),[E,C]=(0,a.useState)(!1),[S,k]=(0,a.useState)(()=>(0,x.Y)()),I=(0,m.Eh)(e=>e.images);(0,m.Eh)(e=>e.setImages);let A=(0,m.Eh)(e=>e.message),P=(0,g.UC)(e=>e.selectedElements),{setSelectedElements:R}=(0,g.S9)(),M=(0,o.hT)(e=>e.chatMode),{setChatMode:T}=(0,o.VK)(),{startLiveMode:D}=(0,h.My)();(0,a.useEffect)(()=>{let e=setInterval(()=>{k((0,x.Y)())},1e3);return()=>clearInterval(e)},[]),(0,a.useEffect)(()=>{let e=()=>{k((0,x.Y)())};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[]);let L=(0,a.useMemo)(()=>I.some(e=>!e.uploaded),[I]),z=(0,a.useMemo)(()=>f||E||!y,[f,E,y]),O=(0,a.useMemo)(()=>z||0===A.length||_&&L||(0,u.L0)(A)||S.isRateLimited,[z,A,_,L,S.isRateLimited]),{isAgentModeDefault:Z}=(0,n.v)(),F=(0,a.useCallback)(async()=>{if(O)return;if(S.isRateLimited){console.warn("Cannot send message: rate limited");return}if(M===o.jE.CHAT_ONLY&&A.toLowerCase().includes("lov-action")&&T(Z?o.jE.AGENT:o.jE.DEFAULT),!_){N(!0);return}let r={selectedElements:P};C(!0),D();try{e(),await s({body:{id:(0,l.Fd)(),message:A,images:I.map(e=>({image_id:e.id,type:p.V.USER_UPLOAD})),selected_elements:P,optimisticImageUrls:I.map(e=>e.url),chat_only:M===o.jE.CHAT_ONLY,agent_mode:t?"enabled":"disabled"},options:{clear:()=>{b(),R([])},restore:()=>{j(),R(r.selectedElements)}}})}finally{C(!1)}},[O,S.isRateLimited,M,A,_,I,P,D,T,e,s,b,R,j,t]);return{message:A,sendChatMessage:F,isSendingDisabled:O,isLocked:z,isSubmitting:E,isRateLimited:S.isRateLimited,rateLimitSecondsRemaining:S.secondsRemaining,AuthDialogComponent:(0,r.jsx)(d.o,{open:w,onOpenChange:N})}}},96279:function(e,t,s){"use strict";s.d(t,{q:function(){return u}});var r=s(21770),a=s(2265),n=s(14438),i=s(49131),l=s(26237),o=s(3097),d=s(74746),c=s(92441);function u(e){let{projectId:t}=e,s=(0,i.SJ)(),u=(0,o.b)(),[m,p]=(0,a.useState)(void 0),{addStoppedMessageId:h,setLatestStreamedMessage:v,updateMessage:g}=(0,d.mx)(),x=(0,d.aK)(e=>e.sortedMessageIds),f=(0,d.aK)(e=>e.messages),b=(0,a.useMemo)(()=>null==x?void 0:x.findLast(e=>{var t;return(null===(t=f[e])||void 0===t?void 0:t.type)==="userMessage"}),[x,f]),j=(0,a.useMemo)(()=>null==x?void 0:x.findLast(e=>{var t;return(null===(t=f[e])||void 0===t?void 0:t.type)==="aiMessage"}),[x,f]),y=(0,l.C)(),_=(0,r.D)({mutationFn:async()=>{if(!t)throw Error("No projectId found");if(u){if(!("content"in u))throw Error("Invalid message type");v({...u,stopped:!0})}return s.post("/projects/".concat(t,"/chat/").concat(b,"/cancel"))},onMutate:()=>{let e=j&&f[j];if(e&&"aiMessage"===e.type){let t=e.content===c.u?"This message was cancelled.":e.content;g(j,{...e,content:t,status:"stopped",stopped:!0},!0)}},onSuccess:()=>{h(null==u?void 0:u.id),p(b),v(void 0)},onError:()=>{n.Am.error("Failed to stop message",{description:"Please try again"})}});return{showStopAction:b!==m&&y,mutation:_}}},36512:function(e,t,s){"use strict";s.d(t,{T:function(){return l},r:function(){return o}});var r=s(57437),a=s(2265),n=s(50273);let i=(0,a.createContext)({currentFile:null,states:{},openTabs:[],targetFileAndLineRange:null,setCurrentFile:()=>{},setStates:()=>{},setOpenTabs:()=>{},openFileAtLine:()=>{},openFileAtLineRange:()=>{},clearLineHighlight:()=>{}});function l(e){let{children:t}=e,[s,l]=(0,a.useState)(null),[o,d]=(0,a.useState)({}),[c,u]=(0,a.useState)([]),[m,p]=(0,a.useState)(null),h=(0,n.UC)(e=>e.selectedElements),v=(0,n.UC)(e=>e.isVisualEditingActive),g=(0,a.useCallback)((e,t)=>{let s=t||1;p({filePath:e,startLine:s,endLine:s}),u(t=>t.includes(e)?t:[...t,e]),l(e)},[]),x=(0,a.useCallback)((e,t,s)=>{p({filePath:e,startLine:t,endLine:s||t}),u(t=>t.includes(e)?t:[...t,e]),l(e)},[]),f=(0,a.useCallback)(()=>{p(null)},[]);(0,a.useEffect)(()=>{v||0!==h.length||f()},[v,h,f]);let b=(0,a.useMemo)(()=>({currentFile:s,setCurrentFile:l,states:o,setStates:d,openTabs:c,setOpenTabs:u,targetFileAndLineRange:m,openFileAtLine:g,openFileAtLineRange:x,clearLineHighlight:f}),[s,o,c,m,g,x,f]);return(0,r.jsx)(i.Provider,{value:b,children:t})}let o=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useCodeEditor must be used within a CodeEditorProvider");return e}},91576:function(e,t,s){"use strict";s.d(t,{UL:function(){return p},hw:function(){return h},t6:function(){return g},v7:function(){return v}});var r,a=s(57437),n=s(52089),i=s(61062),l=s(72384),o=s(94508),d=s(78079),c=s(10867);(r||(r={})).AI_FIX="AI Fix";let{AI_FIX:u}=r;i.N.NO_CODE_CHANGE,i.N.CODE_DIFF,i.N.FILE_EDITED_WITHOUT_PERMISSION,i.N.EXCLUDED_FILE_EDITED,i.N.DEPENDENCY_INSTALL,i.N.IMMEDIATE_RUNTIME,i.N.RUNTIME,i.N.BUILD,i.N.HTTP_CLIENT_ERROR,i.N.HTTP_SERVER_ERROR,i.N.SUPABASE_EDGE_FUNCTION_ERROR,i.N.CORS_ERROR,i.N.DEPLOY_SUPABASE_FUNCTIONS,i.N.SUPABASE_SQL_ERROR,i.N.SEARCH_REPLACE_FAILED,i.N.SEARCH_REPLACE_MISSING_FILE,i.N.CHANGED_MISSING_FILE,i.N.RENAME_FAILED,i.N.DELETION_FAILED;let m=e=>{let t=(0,n.H$)(e),s=t.length>1?e=>"# Error number ".concat(e+1,":\n#################\n\n"):()=>"",r=t.map((e,t)=>"".concat(s(t)).concat(e.error_message,"\n").concat(e.meta_data?"\n"+JSON.stringify(e.meta_data,null,2):"")).join("\n\n").replace(/\x1B\[[0-9;]*[JKmsu]/g,"");return r.length>2e4?r.slice(0,2e4)+"... (truncated)":r},p=e=>{let{errors:t,roundedTop:s=!0}=e;return(0,a.jsx)("div",{className:s?"mt-4":"",children:(0,a.jsx)("pre",{className:(0,o.cn)("w-full rounded-xl border-[3px] border-warning bg-background p-3 text-sm text-foreground",s?"mt-2 rounded-t-md":""),children:(0,a.jsx)("code",{className:"block w-full overflow-x-auto overflow-y-auto whitespace-pre-wrap",children:m(t)})})})},h=e=>{let{projectId:t,errors:s}=e,{mutate:r,isPending:a}=(0,d.mo)({projectId:t});return{onClick:()=>{r({body:{id:(0,c.Fd)(),message:"For the code present, I get the error below.\n\nPlease think step-by-step in order to resolve it.\n```\n".concat(m(s),"\n```\n"),mode:l.S.INSTANT,contains_error:!0,error_ids:s.map(e=>e.id)},projectId:t})},isPending:a}},v={[i.N.BUILD]:"Build unsuccessful",[i.N.CODE_DIFF]:"Changes couldn't be applied",[i.N.DEPLOY_SUPABASE_FUNCTIONS]:"Couldn't deploy Supabase functions",[i.N.DEPENDENCY_INSTALL]:"Couldn't install dependency",[i.N.FILE_EDITED_WITHOUT_PERMISSION]:"Tried editing file without permission",[i.N.EXCLUDED_FILE_EDITED]:"Unwanted changes",[i.N.IMMEDIATE_RUNTIME]:"Oops, it looks like our AI had a bit of a hiccup and broke the app",[i.N.NO_CODE_CHANGE]:"Changes already applied",[i.N.RUNTIME]:"The app encountered an error",[i.N.HTTP_CLIENT_ERROR]:"The app encountered an error",[i.N.HTTP_SERVER_ERROR]:"The app encountered an error",[i.N.SUPABASE_EDGE_FUNCTION_ERROR]:"The app encountered an error",[i.N.CORS_ERROR]:"The app encountered an error",[i.N.SUPABASE_SQL_ERROR]:"An error occurred while applying the migration",[i.N.SEARCH_REPLACE_FAILED]:"Failed search-replace",[i.N.SEARCH_REPLACE_MISSING_FILE]:"Search-replace on missing file",[i.N.CHANGED_MISSING_FILE]:"Tried deleting or renaming non-existent file",[i.N.RENAME_FAILED]:"Failed to rename file",[i.N.DELETION_FAILED]:"Failed to delete file"},g={[i.N.BUILD]:!0,[i.N.CODE_DIFF]:!0,[i.N.SUPABASE_EDGE_FUNCTION_ERROR]:!0,[i.N.DEPENDENCY_INSTALL]:!0,[i.N.DEPLOY_SUPABASE_FUNCTIONS]:!0,[i.N.HTTP_CLIENT_ERROR]:!0,[i.N.HTTP_SERVER_ERROR]:!0,[i.N.CORS_ERROR]:!0,[i.N.FILE_EDITED_WITHOUT_PERMISSION]:!0,[i.N.EXCLUDED_FILE_EDITED]:!0,[i.N.IMMEDIATE_RUNTIME]:!0,[i.N.NO_CODE_CHANGE]:!0,[i.N.RUNTIME]:!0,[i.N.SUPABASE_SQL_ERROR]:!0,[i.N.SEARCH_REPLACE_FAILED]:!0,[i.N.SEARCH_REPLACE_MISSING_FILE]:!0,[i.N.CHANGED_MISSING_FILE]:!0,[i.N.RENAME_FAILED]:!0,[i.N.DELETION_FAILED]:!0}},86843:function(e,t,s){"use strict";s.d(t,{p:function(){return D}});var r=s(57437),a=s(2265),n=s(14438),i=s(85460),l=s(57346),o=s(74746),d=s(77113),c=s(87418),u=s(65810),m=s(50618),p=s(62869),h=s(36461),v=s(76906),g=s(94508),x=s(66491),f=s(67003),b=s(68640),j=s(50126);let y=(0,a.memo)(e=>{var t;let{messageId:s,edit:n,isRevertMessage:i,isUnderDaySection:c}=e,{commit_sha:u}=null!=n?n:{},{setActiveEditId:y}=(0,j.pE)(),_=(0,j.Sl)(e=>e.activeEditId),w=(0,o.aK)(e=>e.edits),N=_?w[_]:null,E=(0,d.iZ)(e=>e.project),{setActiveMessageId:C,setShowConsole:S,setConsolePreviewContent:k,exitConsole:I}=(0,j.pE)(),A=(0,j.Sl)(e=>e.consoleContentType),{toggleBookmark:P}=(0,h.g)((null==E?void 0:E.id)||""),R=(0,a.useMemo)(()=>{if(u&&E)return(0,v.t)({projectId:null==E?void 0:E.id,sha:u})},[u,E]),M=(0,b.Y)({editId:null==n?void 0:n.id,commitSha:null!==(t=null==n?void 0:n.commit_sha)&&void 0!==t?t:void 0}),T=n&&(null==N?void 0:N.id)===(null==n?void 0:n.id)&&"snapshot-preview"===A||M&&!N&&!A,D=(0,a.useMemo)(()=>{if(!(null==n?void 0:n.created_at))return null;let e=new Date(1e3*n.created_at.seconds);return c?{absolute:(0,x.WU)(e,"h:mm a"),relative:(0,x.WU)(e,"h:mm a")}:function(e){let t=!(0,f.X)(e),s="MMM d";return t&&(s+=", yyyy"),s+=", h:mm a",{absolute:(0,x.WU)(e,s),relative:(0,x.WU)(e,s)}}(e)},[n,c]),L=(0,a.useCallback)(e=>{var t;if(e.altKey){window.open(R,"_blank");return}if(T||M){I();return}S("snapshot-preview"),C(s),k(R),y(null!==(t=null==n?void 0:n.id)&&void 0!==t?t:void 0)},[n,I,T,M,s,R,y,C,k,S]),z=(0,a.useCallback)(e=>{e.stopPropagation(),(null==n?void 0:n.id)&&P(n.id,!!n.bookmarked)},[n,P]),{commit_message:O}=null!=n?n:{};return(0,r.jsxs)("div",{className:"flex h-11 min-w-0 items-center gap-1 md:h-10 md:px-3",children:[i?(0,r.jsx)(l.Z,{name:"restart_alt",className:"mb-px text-muted-foreground",size:"small"}):(0,r.jsx)(m.Z,{onClick:z,isBookmarked:!!n.bookmarked&&(null==n?void 0:n.bookmarked),className:(0,g.cn)(!n.bookmarked&&"md:opacity-0 md:group-hover:opacity-100")}),(0,r.jsx)(p.z,{onClick:L,disabled:!n,className:(0,g.cn)("group flex h-10 w-full cursor-pointer items-center gap-2 rounded-lg px-2.5 text-left text-base font-medium transition-colors duration-150 ease-in-out md:h-9 md:text-sm","min-w-0 bg-background text-foreground hover:bg-muted-hover",{"bg-affirmative text-affirmative-foreground hover:bg-affirmative/80":T&&!i}),children:(0,r.jsxs)("div",{className:"flex w-full min-w-0 items-center justify-between gap-2 overflow-hidden",children:[(0,r.jsx)("div",{className:"flex min-w-0 items-center gap-x-2 gap-y-1 font-normal",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-base text-muted-foreground md:text-sm",children:"Restored"}),(0,r.jsx)("div",{className:"min-w-0 gap-1 truncate rounded-sm border border-muted-border bg-background px-2 py-px",children:O})]}):(0,r.jsx)("span",{className:"items-center gap-1 truncate",children:O})}),(0,r.jsx)("span",{className:(0,g.cn)("text-sm font-normal text-muted-foreground md:text-xs",T&&!i&&"text-affirmative-foreground"),children:D&&(0,r.jsx)(r.Fragment,{children:D.absolute})})]})})]})});y.displayName="HistoryCardContent";let _=e=>{let{messageId:t,isUnderDaySection:s=!1}=e,a=(0,o.aK)(e=>e.messages[t]),n=(0,o.tV)((null==a?void 0:a.type)==="aiMessage"||(null==a?void 0:a.type)==="manualEdit"?null==a?void 0:a.editId:void 0),i=(0,o.uO)((null==a?void 0:a.type)==="userCommit"||(null==a?void 0:a.type)==="revertSuccess"?null==a?void 0:a.shortCommitHash:void 0);if(!a||!["aiMessage","manualEdit","userCommit","revertSuccess"].includes(a.type))return null;let l="userCommit"===a.type||"revertSuccess"===a.type?i:n;return l?(0,r.jsx)("div",{className:"group flex flex-col","data-message-id":a.id,"data-message-edit-id":(0,u.Y)(a),children:(0,r.jsx)(y,{messageId:a.id,edit:l,isRevertMessage:"revertSuccess"===a.type,isUnderDaySection:s})}):null};var w=s(56942),N=s(65696),E=s(70817),C=s(3442),S=s(95775);let k=e=>{let{message:t,edits:s,latestPublishedTimestamp:r}=e,a=s[t.editId];return r&&a?a.created_at.toDate()>r:!r&&!!a},I=e=>{let{message:t,latestPublishedTimestamp:s}=e;return s&&t.createdAt?t.createdAt>s:!s&&!!t.createdAt},A=e=>{let{message:t,edits:s,latestPublishedTimestamp:r}=e;return"revertSuccess"===t.type?k({message:t,edits:s,latestPublishedTimestamp:r}):I({message:t,latestPublishedTimestamp:r})},P=e=>{let{messageIds:t,messages:s}=e,r=new Map;return t.forEach(e=>{let t=s[e];if(!(null==t?void 0:t.createdAt))return;let a=(0,x.WU)(t.createdAt,"yyyy-MM-dd");r.has(a)||r.set(a,[]),r.get(a).push(e)}),r},R=e=>{let{messagesByDate:t}=e,s=(0,w.b)(new Date),r=(0,N.z)(s,{weekStartsOn:1}),a=e=>(0,E.z)(e)?"Today":(0,C.g)(e)?"Yesterday":(0,S._)(e,{start:r,end:s})?(0,x.WU)(e,"EEEE"):(0,x.WU)(e,"MMMM d");return Array.from(t.entries()).sort((e,t)=>{let[s]=e,[r]=t;return r.localeCompare(s)}).map(e=>{let[t,s]=e;return{label:a(new Date(t)),messageIds:s}})},M=e=>{let{messageIds:t,messages:s}=e;return R({messagesByDate:P({messageIds:t,messages:s})})},T=e=>{let{messageIds:t,getEditByShortCommitHash:s,latestPublishedTimestamp:r}=e,a=(0,o.aK)(e=>e.edits),n=(0,o.aK)(e=>e.messages),i=[],l=[],d=[],c=e=>["manualEdit","aiMessage","revertSuccess","userCommit"].includes(e),u=e=>{if("userCommit"===e.type||"revertSuccess"===e.type){let t=s(e.shortCommitHash);return!!(null==t?void 0:t.bookmarked)}if("editId"in e&&e.editId){let t=a[e.editId];return!!(null==t?void 0:t.bookmarked)}return!1};return t.forEach(e=>{let t=n[e];if(c(t.type)&&("manualEdit"!==t.type&&"aiMessage"!==t.type||t.editId)){if(u(t)&&"revertSuccess"!==t.type&&i.push(e),A({message:t,edits:a,latestPublishedTimestamp:r})){l.push(e);return}(null==t?void 0:t.createdAt)&&d.push(e)}}),{unpublishedMessageIds:l,bookmarkedMessageIds:i,groupedDailyMessageIds:M({messageIds:d,messages:n}),hasBookmarkedMessages:i.length>0,hasUnpublishedMessages:l.length>0,hasDailyMessages:d.length>0,splitMessageCount:i.length+l.length+d.length}},D=(0,a.memo)(()=>{var e,t;let s=(0,a.useRef)(null),u=(0,a.useRef)(null),m=(0,d.iZ)(e=>e.project),{snapshot:p,loadEarlierEdits:h}=(0,o.mx)(),v=(0,o.aK)(e=>{let t=e.messages;return Object.keys(t).sort((e,s)=>{var r,a,n,i;return((null===(a=t[e])||void 0===a?void 0:null===(r=a.createdAt)||void 0===r?void 0:r.getTime())||0)-((null===(i=t[s])||void 0===i?void 0:null===(n=i.createdAt)||void 0===n?void 0:n.getTime())||0)})}),g=(0,o.aK)(e=>e.edits),x=(0,o.aK)(e=>"loading"===e.loadingEditsStatus),f=(0,o.aK)(e=>e.hasOlderEdits),b=(0,o.aK)(e=>e.canLoadMoreEdits),j=(0,o.uO)(null!==(t=null==m?void 0:m.latest_commit_sha)&&void 0!==t?t:void 0),{isScrolledToEnd:y,checkScrollPosition:w}=(0,c.W)({listRef:u,containerRef:s}),N=(0,a.useMemo)(()=>[...v].reverse(),[v]);(0,a.useEffect)(()=>{y&&f&&b&&h().catch(()=>{n.Am.error("Failed to load earlier edits")})},[y,f,b,h]);let{unpublishedMessageIds:E,groupedDailyMessageIds:C,bookmarkedMessageIds:S,hasBookmarkedMessages:k,hasUnpublishedMessages:I,hasDailyMessages:A,splitMessageCount:P}=T({messageIds:N,latestPublishedTimestamp:(0,a.useMemo)(()=>{var e;let t=null==m?void 0:null===(e=m.published_deployment)||void 0===e?void 0:e.commit_sha;if(!t)return null;let s=Object.values(g).find(e=>e.commit_sha===t);return s?s.created_at.toDate():null},[null==m?void 0:null===(e=m.published_deployment)||void 0===e?void 0:e.commit_sha,g]),getEditByShortCommitHash:p.getEditByShortCommitHash}),R=(0,a.useRef)(void 0);return((0,a.useEffect)(()=>{if(u.current&&P>0&&void 0!==R.current&&R.current<P){let e=u.current.scrollOffset;u.current.scrollTo(e)}R.current=P},[P]),j&&(k||I||A))?(0,r.jsxs)("div",{ref:s,className:"flex min-h-0 flex-1 overflow-y-scroll",children:[(0,r.jsxs)(i.dM,{overscan:5,ref:u,onScroll:()=>{w()},children:[k&&(0,r.jsx)(L,{title:"Bookmarked",children:S.map(e=>(0,r.jsx)(_,{messageId:e},e))}),I&&(0,r.jsx)(L,{title:"Unpublished",children:E.map(e=>(0,r.jsx)(_,{messageId:e},e))}),A&&C.map(e=>{let{label:t,messageIds:s}=e;return(0,r.jsx)(L,{title:t,children:s.map(e=>(0,r.jsx)(_,{messageId:e,isUnderDaySection:!0},e))},t)})]}),x&&(0,r.jsx)("div",{className:"flex items-center justify-center gap-2 text-sm",children:(0,r.jsx)(l.Z,{className:"animate-spin",name:"progress_activity",size:"small"})})]}):null});D.displayName="HistoryPanel";let L=e=>{let{title:t,subtitle:s,children:a}=e;return(0,r.jsxs)("div",{className:"mb-4 mt-2 flex flex-col",children:[(0,r.jsxs)("p",{className:"mb-1 text-lg font-medium md:pl-3 md:text-base",children:[t,s&&(0,r.jsx)("span",{className:"ml-1 text-sm font-normal text-muted-foreground",children:s})]}),a]})}},58292:function(e,t,s){"use strict";s.d(t,{N:function(){return c}});var r=s(92850),a=s(2265),n=s(49360),i=s(78079),l=s(26237),o=s(21288),d=s(33187);let c=e=>{let{projectId:t,setIsOpen:s,setShowPublishConfirmDialog:c,shouldFetchSecurityWarnings:u,supabaseProjectId:m}=e,p=(0,l.C)(),{data:h,isLoading:v,isError:g}=(0,r.a)(d.W.securityWarnings({projectId:t,enabled:!!t&&!!m&&u})),x=(0,a.useMemo)(()=>{if(g)return{supabase:{errors:0,warnings:0,success:!1}};if(h){var e,t,s,r,a,n;return{supabase:{errors:null!==(r=null===(e=h.supabase)||void 0===e?void 0:e.errors)&&void 0!==r?r:0,warnings:null!==(a=null===(t=h.supabase)||void 0===t?void 0:t.warnings)&&void 0!==a?a:0,success:!0,details:null!==(n=null===(s=h.supabase)||void 0===s?void 0:s.details)&&void 0!==n?n:[]}}}return null},[h,g]),f=(0,i.mo)({projectId:t,onSuccess:()=>{null==s||s(!1)}}),b=f.isPending,j=p||b,y=x&&x.supabase.errors+x.supabase.warnings>0,_=x&&x.supabase.errors>0;return{securityWarnings:x,isLoadingWarnings:v,isSendingSecurityReview:b,isSecurityReviewDisabled:j,securityReviewDisabledReason:p?"Wait for Lovable to finish working":null,handleReviewIssuesInDialog:()=>{if(c(!1),m){let e=x&&0===x.supabase.errors?"?preset=WARN&id=":"";window.open("".concat("https://supabase.com/dashboard/project/".concat(m,"/advisors/security")).concat(e),"_blank")}},handleSecurityReview:()=>{if(!t){o.logging.error("project id is missing, can't start security review");return}j||f.mutate({body:{message:"Please perform a comprehensive security review of my project.",id:(0,n.Z)(),security_review:!0,chat_only:!0}})},hasSupabaseErrors:_,hasSecurityIssues:y}}},63858:function(e,t,s){"use strict";s.d(t,{A:function(){return r},g:function(){return a}});let r={'pre[class*="language-"]':{color:"#c9d1d9",background:"var(--muted)",fontSize:"13px",fontFamily:'var(--font-roboto-mono), "Roboto Mono", Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',lineHeight:"1.5",padding:"1em",overflow:"auto"},'code[class*="language-"]':{color:"#c9d1d9",fontSize:"13px",fontFamily:'var(--font-roboto-mono), "Roboto Mono", Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',lineHeight:"1.5"},comment:{color:"#8b949e"},boolean:{color:"#ff7b72"},number:{color:"#79c0ff"},constant:{color:"#79c0ff"},operator:{color:"#7ee787"},keyword:{color:"oklch(0.833 0.145 321.434)"},function:{color:"#d2a8ff"},variable:{color:"#c9d1d9"},"class-name":{color:"#ffa657"},"type-name":{color:"#ffa657"},"attr-name":{color:"#79c0ff"},string:{color:"#a5d6ff"},tag:{color:"#7ee787"},punctuation:{color:"#7ee787"},selector:{color:"#7ee787"},namespace:{color:"#c9d1d9"},regex:{color:"#ff7b72"},escape:{color:"#a5d6ff"},"::selection":{background:"#2d333b"}},a={'pre[class*="language-"]':{color:"#24292e",background:"var(--background)",fontSize:"13px",fontFamily:'var(--font-roboto-mono), "Roboto Mono", Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',lineHeight:"1.5",padding:"1em",overflow:"auto"},'code[class*="language-"]':{color:"#24292e",fontSize:"13px",fontFamily:'var(--font-roboto-mono), "Roboto Mono", Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',lineHeight:"1.5"},comment:{color:"#6e7781"},boolean:{color:"#cf222e"},number:{color:"#0550ae"},constant:{color:"#0550ae"},operator:{color:"#116329"},keyword:{color:"#3479E5"},function:{color:"#8250df"},"class-name":{color:"#953800"},"attr-name":{color:"#0550ae"},string:{color:"#0a3069"},tag:{color:"#116329"},punctuation:{color:"#116329"},"::selection":{background:"#C7E4FF"}}},62809:function(e,t,s){"use strict";s.d(t,{C:function(){return n}});var r=s(69367),a=s(2265);function n(e){let[t,s]=(0,a.useState)(0),[n,i]=(0,a.useState)(0),[l,o]=(0,a.useState)(e);return(0,a.useLayoutEffect)(()=>{l!==e&&(o(e),i(t))},[e,l,t]),(0,a.useEffect)(()=>{let t=e.split("").length-n,a=(0,r.j)(n,e.split("").length,{duration:Math.max(.1,Math.min(5,t/140)),bounce:0,onUpdate(e){s(Math.floor(e))}});return()=>a.stop()},[n,e]),e.split("").slice(0,t).join("")}},6809:function(e,t,s){"use strict";s.d(t,{N:function(){return i}});var r=s(75403),a=s(72253),n=s(77113);function i(){var e,t;let s=(0,n.iZ)(e=>e.project),i=null==s?void 0:s.supabase_project_config,l=(0,a.S)({workspaceId:null!==(t=null==s?void 0:s.workspace_id)&&void 0!==t?t:""}),o=(0,r.Z)(l,i),d=null===(e=l.supabaseOrganizations)||void 0===e?void 0:e.flatMap(e=>e.projects||[]);return!o&&d&&(null==i?void 0:i.supabase_project_id)&&d.find(e=>e.id===i.supabase_project_id)||null}},3097:function(e,t,s){"use strict";s.d(t,{U:function(){return d},b:function(){return o}});var r=s(5978),a=s(2265),n=s(78099),i=s(74746);let l=e=>{if(e.created_at&&!(e.created_at instanceof r.EK)){let{seconds:t,nanoseconds:s}=e.created_at;return{...e,created_at:new r.EK(t,s)}}return e},o=()=>{let e=(0,i.aK)(e=>e.latestStreamedMessage);return e?l(e):null},d=e=>{let{projectId:t,messageId:s}=e,[i,l]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!t||!s)return;let e=(0,r.JU)(n.db,"projects",t,"trajectory",s);return(0,r.cf)(e,e=>{e.exists()?l(e.data()):l(null)})},[t,s]),i}},79396:function(e,t,s){"use strict";s.d(t,{I:function(){return p}});var r=s(21770),a=s(14438),n=s(65666),i=s(49131),l=s(21288),o=s(50126),d=s(37675),c=s(5978),u=s(2265),m=s(78099);let p=e=>{let{setIsSomeRevertMutationPending:t}=(0,d.Xr)(),s=(0,i.SJ)(),p=(0,n.D)(),{setActiveEditId:h}=(0,o.pE)(),{isRevertSafe:v}=function(e){let{projectId:t}=e,s=(0,u.useCallback)(async e=>{let{targetEditId:s}=e,r=await (0,c.QT)((0,c.JU)(m.db,"projects",t,"edits",s));if(!r.exists())return l.logging.warn("invalid_edit_id_for_supabase_revert_check",{editId:s}),!0;let a=r.data();return(await (0,c.PL)((0,c.IO)((0,c.hJ)(m.db,"projects",t,"trajectory"),(0,c.ar)("created_at",">",a.created_at),(0,c.ar)("sql_run_state","in",["running","succeeded"]),(0,c.Xo)("created_at","desc"),(0,c.b9)(1)))).empty},[t]);return{isRevertSafe:(0,u.useCallback)(e=>{let{targetEditId:t}=e;return s({targetEditId:t})},[s])}}({projectId:p}),{setEditIdToConfirmRestoreFor:g}=(0,d.Xr)(),x=async t=>{let{edit:r,dry_run:a,via_undo:n}=t,i=r.id;if(r.revert_target_edit_id&&(i=r.revert_target_edit_id),!(null==e?void 0:e.skipSafetyCheck)&&!await v({targetEditId:i}))return null;let l={edit_id:i,dry_run:a,via_undo:n};return s.post("/projects/".concat(p,"/revert-to-edit"),l)};return(0,r.D)({mutationFn:x,onMutate:()=>{t(!0)},onSuccess:(t,s)=>{var r;if(!t){g(s.edit.revert_target_edit_id||s.edit.id);return}if(!s.via_undo){let e=t.commit_message;void 0===e&&t.tags&&(e=t.tags.summary);let s=e?"Restored to earlier version: ".concat(e):"Restored to earlier version";a.Am.success("Success",{description:s})}null==e||null===(r=e.onSuccess)||void 0===r||r.call(e),h(t.id)},onError:e=>{var t;l.logging.error("could_not_revert_to_earlier_version",{error:e}),a.Am.error("Could not revert to earlier version",{description:null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.detail})},onSettled:()=>{t(!1)}})}},72380:function(e,t,s){"use strict";s.d(t,{v:function(){return l}});var r=s(21770),a=s(60256),n=s(64040),i=s(49131);let l=()=>{let{userData:e}=(0,a.SE)();return(0,r.D)({mutationFn:async t=>(0,i.SJ)().put("/user/".concat(e.id),{tips:t}),onError:e=>{(0,n.Eo)(e)}})}},68640:function(e,t,s){"use strict";s.d(t,{Y:function(){return n}});var r=s(74746),a=s(77113);let n=e=>{var t;let s=(0,a.iZ)(e=>e.project),n=(0,r.uO)(null!==(t=null==s?void 0:s.latest_commit_sha)&&void 0!==t?t:void 0);return e.commitSha===(null==s?void 0:s.latest_commit_sha)||(null==n?void 0:n.type)=="revert"&&n.revert_target_edit_id==e.editId}},60254:function(e,t,s){"use strict";s.d(t,{A7:function(){return m},TO:function(){return c},ag:function(){return u}});var r=s(57437),a=s(2265),n=s(59625),i=s(14884);let l=e=>({files:{},pendingChanges:{},isLoading:!1,isSyncing:!1,lastSyncTimestamp:void 0,syncError:void 0,uploads:[],projectId:e,searchQuery:"",expandedSearchFiles:new Set,sidebarTab:"files"}),o=e=>(0,n.Ue)()((0,i.n)((t,s)=>({...l(e),setFile:(e,s)=>t(t=>({files:{...t.files,[e]:s}})),removeFile:e=>t(t=>{let{[e]:s,...r}=t.files;return{files:r}}),updateFileContent:(e,s)=>t(t=>({files:{...t.files,[e]:s}})),setSyncing:e=>t({isSyncing:e,lastSyncTimestamp:e?void 0:Date.now()}),setSyncError:e=>t({syncError:e,isSyncing:!1}),setLoading:e=>t({isLoading:e}),addPendingChange:e=>{let{path:s,content:r}=e;return t(e=>({pendingChanges:{...e.pendingChanges,[s]:r}}))},removePendingChange:e=>t(t=>{let{[e]:s,...r}=t.pendingChanges;return{pendingChanges:r}}),clearPendingChanges:()=>t({pendingChanges:{}}),hasUnsavedChanges:()=>{let{pendingChanges:e}=s();return Object.keys(e).length>0},reset:()=>t({...l(s().projectId)}),addUpload:e=>t(t=>({uploads:[...t.uploads,e]})),clearUploads:()=>t({uploads:[]}),setSearchQuery:e=>t({searchQuery:e}),setExpandedSearchFiles:e=>t({expandedSearchFiles:e}),setSidebarTab:e=>t({sidebarTab:e})}))),d=(0,a.createContext)(null),c=e=>{let{children:t,projectId:s}=e,n=(0,a.useRef)(o(s)),i=(0,a.useCallback)(()=>n.current.getState().pendingChanges,[]),l=(0,a.useCallback)(()=>n.current.getState().files,[]),c={store:n.current,snapshot:{getPendingChanges:i,getFiles:l}};return(0,r.jsx)(d.Provider,{value:c,children:t})};function u(){let e=(0,a.useContext)(d);if(!e)throw Error("useCodeEditorContext must be used within a CodeEditorProvider");return e}function m(e){let{store:t}=u();return t(e)}},25658:function(e,t,s){"use strict";s.d(t,{VF:function(){return d},f6:function(){return o},z:function(){return c}});var r=s(57437),a=s(2265),n=s(59625);let i=()=>(0,n.Ue)(()=>({showHistory:!1})),l=(0,a.createContext)(null),o=e=>{let{children:t}=e,s=(0,a.useRef)(i()),n={store:s.current,setShowHistory:e=>{let t=s.current,r=t.getState(),a="function"==typeof e?e(r.showHistory):e;t.setState({showHistory:a})}};return(0,r.jsx)(l.Provider,{value:n,children:t})};function d(){let e=(0,a.useContext)(l);if(!e)throw Error("useHistoryContext must be used within a HistoryProvider");return e}function c(e){let{store:t}=d();return t(e)}},63420:function(e,t,s){"use strict";s.d(t,{P:function(){return v},v:function(){return g}});var r=s(57437),a=s(46214),n=s(2265),i=s(64040),l=s(49131),o=s(32582),d=s(26034),c=s(21288),u=s(60254),m=s(29328),p=s(77113);let h=(0,n.createContext)(null);function v(e){let{children:t}=e,{refreshPreview:s,startLiveMode:v}=(0,m.My)(),g=(0,u.A7)(e=>e.setFile),x=(0,u.A7)(e=>e.pendingChanges),f=(0,u.A7)(e=>e.reset),b=(0,u.A7)(e=>e.clearPendingChanges),j=(0,u.A7)(e=>e.addPendingChange),y=(0,n.useRef)(null),_=(0,p.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.id}),w=(0,u.A7)(e=>e.files),N=(0,n.useMemo)(()=>Object.entries(w),[w]),E=(0,u.A7)(e=>e.uploads),[C,S]=(0,n.useState)(!1),[k,I]=(0,n.useState)(null),[A,P]=(0,n.useState)([]),[R,M]=(0,n.useState)([]),{snapshot:T}=(0,u.ag)(),D=(0,n.useCallback)(()=>{N&&P((0,o.x2)(N))},[N]);(0,n.useEffect)(()=>{D()},[D]);let[L,z]=(0,n.useState)(!1),O=(0,n.useCallback)(()=>{z(!0),v()},[v,z]),Z=(0,m.vE)();(0,n.useEffect)(()=>{if(!L||!Z)return;let e=new URL("/_sandbox/code/ws",Z);return y.current=new WebSocket(e),y.current.onmessage=e=>{try{let{type:t,data:s}=JSON.parse(e.data);if("init_code"===t)f(),S(!0),s.forEach(e=>{let[t,s]=e;g(t,s)});else if("file_update"===t){let e=T.getFiles();s.forEach(t=>{let[s,r]=t;e[s]!==r&&g(s,r)})}}catch(e){c.logging.error("Error processing WebSocket message",{project_id:_,error:e})}},y.current.onclose=e=>{e.wasClean||c.logging.error("Code WebSocket closed prematurely",{project_id:_,event:e})},y.current.onerror=e=>{c.logging.error("Code WebSocket error",{project_id:_,error:e})},()=>{var e;null===(e=y.current)||void 0===e||e.close(),y.current=null}},[Z,_,f,g,L,T]);let F=(0,n.useCallback)(async function(e){let{commitMessage:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a.ZP.capture("visual_edits:sync_started");let s=Object.entries(e);if(!_)throw Error("No project id");if(0===s.length)throw Error("No changes to sync");try{let e=(0,l.SJ)(),r=await Promise.all(E.map(e=>(0,d.Sv)({dir_name:e.dir_name,file_name:e.id}).then(t=>({download_url:t.url,file_id:e.file_name})))),a=await e.post("/projects/".concat(_,"/edit-code"),{changes:s.map(e=>{let[t,s]=e;return{path:t,content:s}}),uploads:r,commit_message:t||null});if("error"in a&&a.error)throw Error("Failed to sync code");b()}catch(e){(0,i.Eo)(e),a.ZP.capture("visual_edits:sync_failed",{error:e instanceof Error?e.message:"Unknown error",changes:null==s?void 0:s.map(e=>{let[t,s]=e;return[t,s.length]}),project_id:_})}},[_,E,b]),U=Object.keys(x).length>0;return(0,r.jsx)(h.Provider,{value:{syncCode:F,ast:A,code:N,generateAst:D,refreshPreview:s,startLiveMode:O,history:R,setHistory:M,currentClassName:k,setCurrentClassName:I,addPendingChange:j,hasUnsavedChanges:U,hasInitialCode:C},children:t})}function g(){let e=(0,n.useContext)(h);if(!e)throw Error("useSandboxCode must be used within a SandboxCodeProvider");return{code:e.code,syncCode:e.syncCode,ast:e.ast,generateAst:e.generateAst,refreshPreview:e.refreshPreview,enableServer:e.startLiveMode,history:e.history,setHistory:e.setHistory,currentClassName:e.currentClassName,setCurrentClassName:e.setCurrentClassName,addPendingChange:e.addPendingChange,hasUnsavedChanges:e.hasUnsavedChanges,hasInitialCode:e.hasInitialCode}}},50273:function(e,t,s){"use strict";s.d(t,{NE:function(){return d},S9:function(){return c},UC:function(){return u}});var r=s(57437),a=s(2265),n=s(59625),i=s(14884);let l=()=>(0,n.Ue)()((0,i.n)(()=>({selectedElements:[],isVisualEditingActive:!1,isPickAndEditActive:!1,customPromptValue:"",isSaving:!1,activeEditContent:null,floatingInputState:{isVisible:!1,position:null},visualEditsPanelState:{isOpen:!1,position:null},lastPanelPosition:null}))),o=(0,a.createContext)(null),d=e=>{let{children:t}=e,s=(0,a.useRef)(l()),n={store:s.current,setSelectedElements:e=>{s.current.setState(t=>{t.selectedElements=e})},removeSelectedElement:e=>{s.current.setState(t=>{t.selectedElements=t.selectedElements.filter(t=>t.filePath!==e.filePath||t.lineNumber!==e.lineNumber)})},turnOffVisualEditing:()=>{s.current.setState(e=>{e.isVisualEditingActive=!1,e.isPickAndEditActive=!1,e.selectedElements=[],e.isSaving=!1,e.visualEditsPanelState={isOpen:!1,position:null},e.floatingInputState={isVisible:!1,position:null}})},setIsVisualEditorPanelOpen:e=>{let t=s.current;"function"==typeof e?t.setState(t=>{t.isVisualEditingActive=e(t.isVisualEditingActive)}):t.setState(t=>{t.isVisualEditingActive=e})},setIsPickAndEditActive:e=>{let t=s.current;"function"==typeof e?t.setState(t=>{t.isPickAndEditActive=e(t.isPickAndEditActive)}):t.setState(t=>{t.isPickAndEditActive=e})},showFloatingInput:e=>{s.current.setState(t=>{t.floatingInputState={isVisible:!0,position:e}})},showVisualEditsPanel:e=>{s.current.setState(t=>{t.visualEditsPanelState={isOpen:!0,position:e},t.lastPanelPosition=e})},closeVisualEditsPanel:()=>{s.current.setState(e=>{e.visualEditsPanelState={isOpen:!1,position:null},e.customPromptValue="",e.selectedElements=[]})},hideVisualEditsPanel:()=>{s.current.setState(e=>{e.visualEditsPanelState.isOpen&&(e.lastPanelPosition=e.visualEditsPanelState.position),e.visualEditsPanelState={isOpen:!1,position:null}})},setCustomPromptValue:e=>{s.current.setState(t=>{t.customPromptValue=e})},setIsSaving:e=>{s.current.setState(t=>{t.isSaving=e})},setActiveEditContent:e=>{s.current.setState(t=>{t.activeEditContent=e})}};return(0,r.jsx)(o.Provider,{value:n,children:t})};function c(){let e=(0,a.useContext)(o);if(!e)throw Error("useVisualEditorContext must be used within a VisualEditorProvider");return e}function u(e){let{store:t}=c();return t(e)}},49968:function(e,t,s){"use strict";s.d(t,{Ny:function(){return d},U1:function(){return n},fA:function(){return i},oo:function(){return o},pr:function(){return l}});var r=s(54257);let a=()=>"https://console.firebase.google.com/u/0/project/".concat(r.q.projectId,"/firestore/databases/-default-/data"),n=e=>"".concat(a(),"/~2Fprojects~2F").concat(e),i=e=>e?"".concat(a(),"/~2Fusers~2F").concat(e):"",l=(e,t)=>"".concat(n(e),"~2Ftrajectory~2F").concat(t),o=(e,t)=>"".concat(n(e),"~2Fedits~2F").concat(t),d=e=>"".concat(a(),"/~2Fworkspaces~2F").concat(e)},23590:function(e,t,s){"use strict";s.d(t,{G:function(){return n}});var r=s(67817),a=s(2043);let n=()=>{let{canEdit:e,isWorkspaceMember:t}=(0,a.t)(),s=(0,r.v)();return t&&e||s}},27410:function(e,t,s){"use strict";var r=s(57437);s(2265);var a=s(81103);t.Z=e=>{let{children:t,label:s,side:n="bottom"}=e;return(0,r.jsxs)(a.u,{children:[(0,r.jsx)(a.aJ,{asChild:!0,children:t}),(0,r.jsx)(a._v,{className:"z-[2001]",side:n,children:s})]})}},74928:function(e,t,s){"use strict";s.d(t,{w:function(){return n},z:function(){return a}});var r=s(962);let a=r.fC,n=r.wy;r.Fw},9144:function(e,t,s){"use strict";s.d(t,{L:function(){return n}});var r=s(57437),a=s(94508);let n=e=>{let{className:t,text:s="Free"}=e;return(0,r.jsxs)("span",{className:(0,a.cn)("align-baseline text-xs opacity-70",t),children:["(",s,")"]})}},35354:function(e,t,s){"use strict";var r=s(2265);t.Z=()=>{let[e,t]=(0,r.useState)("");return(0,r.useEffect)(()=>{t(a())},[]),{isMac:"mac"===e,isWindows:"windows"===e,isLinux:"linux"===e}};let a=()=>{let e=window.navigator.userAgentData,t=window.navigator.userAgent,s={iphone:/iphone/,ipad:/ipad|macintosh/,android:/android/},r={windows:/win/,mac:/macintosh/,linux:/linux/};if(t){let e=t.toLowerCase().replace(/^mozilla\/\d\.\d\W/,""),a=Object.keys(s).find(t=>s[t].test(e)&&window.navigator.maxTouchPoints>=1),n=Object.keys(r).find(t=>r[t].test(e));return a||n}return e?e.platform.toLowerCase():""}},52089:function(e,t,s){"use strict";s.d(t,{H$:function(){return v},hT:function(){return f},qV:function(){return g}});var r=s(21770),a=s(5978),n=s(2265),i=s(2208),l=s(29328),o=s(49131),d=s(78099),c=s(21288),u=s(61062),m=s(7163),p=s(98015);function h(e){var t,s,r;let a=e.meta_data?"|".concat(null===(t=e.meta_data)||void 0===t?void 0:t.colno,"|").concat(null===(s=e.meta_data)||void 0===s?void 0:s.lineno,"|").concat(null===(r=e.meta_data)||void 0===r?void 0:r.filename):"";return"".concat(e.error_message,"|").concat(e.type).concat(a)}function v(e){return e.filter((e,t,s)=>t===s.findIndex(t=>h(t)===h(e)))}function g(e){let{projectId:t,errorIds:s,setErrors:a}=e;return(0,r.D)({mutationFn:async()=>(a([]),(0,o.SJ)().patch("/projects/".concat(t,"/handle-errors"),{error_ids:s})),onError:e=>{c.logging.error("failed_to_submit_handled_errors",{error:e})}})}let x=e=>{e.sort((e,t)=>e.type===u.N.RUNTIME&&t.type!==u.N.RUNTIME?-1:t.created_at.seconds-e.created_at.seconds);let t={uniqueErrors:[],runtimeErrorMessages:new Set};return e.reduce((e,t)=>{if(t.type===u.N.IMMEDIATE_RUNTIME||t.type===u.N.RUNTIME){let s=t.error_message.replace(/\?v=[a-z0-9]{8}/,"?'");e.runtimeErrorMessages.has(s)||(e.runtimeErrorMessages.add(s),e.uniqueErrors.push(t))}else e.uniqueErrors.push(t);return e},t).uniqueErrors},f=e=>{let{projectId:t}=e,[s,r]=(0,n.useState)([]),u=(0,o.SJ)(),h=(0,l.vE)();(0,i.ZP)(h,{protocols:"vite-hmr",share:!0,onMessage:e=>{try{let r=JSON.parse(e.data);if((null==r?void 0:r.type)==="error"){var s;c.logging.info("build_error_from_devserver",{message:null==r?void 0:null===(s=r.err)||void 0===s?void 0:s.message});let e=m.p.safeParse(null==r?void 0:r.err);e.success?(0,p.e)(e.data,t,u):(c.logging.error("error_parsing_devserver_error",{error:e}),(0,p.e)(null==r?void 0:r.err,t,u))}}catch(e){c.logging.error("error_parsing_devserver_error",{error:e})}},onOpen:e=>{c.logging.debug("devserver_websocket_open")},onClose:e=>{c.logging.debug("devserver_websocket_close")},onError:e=>{c.logging.error("devserver_websocket_error",{event:e})},shouldReconnect:()=>!0,reconnectInterval:1e3});let v=g({projectId:t,errorIds:s.map(e=>e.id),setErrors:r});return(0,n.useEffect)(()=>{let e=function(e,t){let s=(0,a.hJ)(d.db,"projects/".concat(e,"/errors")),r=(0,a.IO)(s,(0,a.ar)("handled_at","==",null));return(0,a.cf)(r,e=>{e.empty?t([]):t(e.docs.map(e=>({...e.data(),id:e.id})))})}(t,r);return()=>e()},[t]),{errors:(0,n.useMemo)(()=>0===s.length?null:x(s),[s]),setErrors:r,handleErrorMutation:s.length>0?v:null}}},36461:function(e,t,s){"use strict";s.d(t,{g:function(){return p}});var r=s(21770),a=s(46214),n=s(2265),i=s(14438),l=s(74746),o=s(25658),d=s(85472),c=s(64040),u=s(49131),m=s(49284);let p=e=>{let{updateEdit:t}=(0,l.mx)(),{setShowHistory:s}=(0,o.VF)(),p=(0,r.D)({mutationFn:async t=>{let{editId:s,bookmarked:r,previousValue:a}=t;try{let t=(0,u.SJ)();return await t.put("/projects/".concat(e,"/bookmark/").concat(s),{bookmarked:r}),{editId:s,bookmarked:r}}catch(e){throw e}},onError:(e,s)=>{if(t(s.editId,{bookmarked:s.previousValue}),e instanceof d.H){let t=s.bookmarked?"bookmark":"unbookmark";i.Am.error("Failed to ".concat(t," edit"),{description:e.message||"Please try again"});return}(0,c.Eo)(e)},onSuccess:e=>{i.Am.success(e.bookmarked?"Bookmarked to history":"Bookmark removed from history",{action:{label:"View history",onClick:()=>s(!0)}})}});return{toggleBookmark:(0,n.useCallback)(function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!s;a.ZP.capture(r?m.SL.BOOKMARK.ADDED:m.SL.BOOKMARK.REMOVED),t(e,{bookmarked:r}),p.mutate({editId:e,bookmarked:r,previousValue:s})},[p,t]),isToggling:p.isPending}}},32582:function(e,t,s){"use strict";s.d(t,{EE:function(){return h},H2:function(){return u},R5:function(){return o},Rw:function(){return l},Xu:function(){return c},cB:function(){return m},x2:function(){return i},xA:function(){return v}});var r=s(97569),a=s(76624),n=s(98891);function i(e){let t=[];return e.map(e=>{let s,[a,n]=e;if(a.endsWith(".tsx")||a.endsWith(".ts")||a.endsWith(".jsx")||a.endsWith(".js")){try{s=(0,r.parse)(n,{sourceFilename:a,sourceType:"module",plugins:["jsx","typescript"],allowImportExportEverywhere:!0})}catch(e){return}t.push({filePath:a,ast:s})}}),t}function l(e,t){let s=e.children.find(e=>n.isJSXText(e));s?s.value=t:e.children.unshift(n.jsxText(t))}function o(e,t){Object.keys(t).forEach(s=>{e.openingElement.attributes=e.openingElement.attributes.filter(e=>{var t;return n.isJSXAttribute(e)&&(null===(t=e.name)||void 0===t?void 0:t.name)!==s}),e.openingElement.attributes.push(n.jsxAttribute(n.jsxIdentifier(s),n.stringLiteral(t[s])))})}let d=e=>n.isStringLiteral(e)?e.value:null;function c(e){let t=e.openingElement.attributes.find(e=>n.isJSXAttribute(e)&&"className"===e.name.name);return void 0===t?"":(null==t?void 0:t.value)?d(t.value):null}let u=(e,t)=>{let s=t.find(t=>t.filePath===e.filePath);if(!s)return!1;let r=!1;return(0,a.default)(s.ast,{JSXElement(t){var s;if((null===(s=t.node.loc)||void 0===s?void 0:s.start.line)===e.lineNumber&&n.isJSXElement(t.node)){let e=t.node.children;r=1===e.length&&n.isJSXText(e[0]),t.stop()}}}),r},m=(e,t,s)=>{let r=t.find(t=>t.filePath===e.filePath);if(!r)return!1;let i=!1;return(0,a.default)(r.ast,{JSXElement(t){var r;(null===(r=t.node.loc)||void 0===r?void 0:r.start.line)===e.lineNumber&&n.isJSXElement(t.node)&&(i=t.node.openingElement.attributes.some(e=>{var t;return n.isJSXAttribute(e)&&n.isStringLiteral(e.value)&&(null===(t=e.name)||void 0===t?void 0:t.name)===s}),t.stop())}}),i},p=(e,t,s)=>{let r=s.find(e=>e.filePath===t);if(!r)return null;let n=null;return(0,a.default)(r.ast,{JSXElement(t){var s;(null===(s=t.node.loc)||void 0===s?void 0:s.start.line)===e&&(n=t.node,t.stop())}}),n},h=(e,t)=>{let s=p(e.lineNumber,e.filePath,t);return s?c(s):null},v=(e,t)=>{let s=t.find(t=>t.filePath===e.filePath);if(!s)return null;let r=null,n=null;return((0,a.default)(s.ast,{JSXElement(t){var s;(null===(s=t.node.loc)||void 0===s?void 0:s.start.line)===e.lineNumber&&(r=t.node.loc.start.line,n=t.node.loc.end.line,t.stop())}}),null===r||null===n)?null:{startLine:r,endLine:n}}},5635:function(e,t,s){"use strict";s.d(t,{B:function(){return i},a:function(){return a}});let r={text:"format_size",img:"image",button:"crop_16_9",link:"link",div:"select"},a=e=>r[n(e)],n=e=>["p","span","h1","h2","h3","h4","h5","h6"].includes(e)?"text":"img"===e?"img":"button"===e?"button":"a"===e?"link":"div",i=e=>n(e.elementType)},55214:function(e){e.exports={cursor:"PromptBox_cursor__MuO9l",blink:"PromptBox_blink__F53p4",customProse:"PromptBox_customProse__C94Rw"}}}]);